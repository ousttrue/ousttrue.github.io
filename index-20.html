<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="ja">
<head>
<meta charset="utf-8">
<meta name="description" content="作業記録">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>三次元日誌 (過去の記事 20ページ目) | 三次元日誌</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="ja" href="rss.xml">
<link rel="canonical" href="https://ousttrue.github.io/index-20.html">
<link rel="prev" href="index-21.html" type="text/html">
<link rel="next" href="index-19.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">本文を読み飛ばす</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href=".">

            <span id="blog-title">三次元日誌</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav"></ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="books" class="nav-link">MemoBooks</a>
                </li>
<li class="nav-item">
<a href="archive.html" class="nav-link">Archives</a>
                </li>
<li class="nav-item">
<a href="categories/index.html" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="rss.xml" class="nav-link">RSS feed</a>
                </li>
<li class="nav-item">
<a href="about" class="nav-link">About</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
    
        

    
        
    <div class="postindex">
            <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/05/vcpkg/" class="u-url">vc向けのメタビルドツールvcpkgを発見</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2017/05/vcpkg/" rel="bookmark">
            <time class="published dt-published" datetime="2017-05-04T00:00:00+09:00" itemprop="datePublished" title="2017-05-04 00:00">2017-05-04 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>uwp向けのlibpngのビルドのエラーを修正する過程でvcpkgを見つけた。
vc向けのメタビルドツールの予感。</p>
<p>cloneして</p>
<blockquote>
<p>git clone https://github.com/Microsoft/vcpkg.git</p>
</blockquote>
<p>buildする</p>
<blockquote>
<p>cd vcpkg
vcpkg&gt; ./bootstrap.bat</p>
</blockquote>
<p>UWP版のpackageインストール
vcpkg&gt; ./vcpkg install libpng:x86-uwp</p>
<p>なるほど。
OpenCVのUWP版はあるかな・・・。
vcpkg&gt; ./vcpkg install opencv:x86-uwp</p>
<p>あった。
最新版のopencv-3.2.0もビルドできるやん。
一瞬にして作り始めていた、
https://github.com/ousttrue/bldproc/tree/master/procs
がオワコンになった。
検索してみたら日本語の紹介記事が一つあった。</p>
<p>【速報】Vcpkg: Windowsの公式C++ライブラリ管理ツール</p>
<p>desktopビルドできた</p>
<p>ffpmeg(msys2をダウンロードして使っていた。わかる)</p>
<p>uwpビルドできた</p>
<p>opencv
openssl</p>
<p>uwpビルドできなかった</p>
<p>cairo。途中でpeclのビルドに失敗する(pixmanはビルドできたのでオプション外せばいけそう)。
bullet3。ちょっと修正が要るか</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="github/uwpnativedllsample/" class="u-url">UwpNativeDllSample</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="github/uwpnativedllsample/" rel="bookmark">
            <time class="published dt-published" datetime="2017-05-02T17:18:57Z" itemprop="datePublished" title="2017-05-02 17:18">2017-05-02 17:18</time><span class="updated"> (更新日時
                    <time class="dt-updated" datetime="2017-05-03T15:21:20Z" itemprop="dateUpdated" title="2017-05-03 15:21">2017-05-03 15:21</time>)</span>
            </a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p><a href="https://github.com/ousttrue/UwpNativeDllSample">https://github.com/ousttrue/UwpNativeDllSample</a></p>
<p>uwp sample project that using native dll</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/05/uwp_dll/" class="u-url">UWPでNativeDllを使う</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2017/05/uwp_dll/" rel="bookmark">
            <time class="published dt-published" datetime="2017-05-03T00:00:00+09:00" itemprop="datePublished" title="2017-05-03 00:00">2017-05-03 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>UWPでNativeのDLLを使うとどんな感じなのか試してみた。</p>
<p>https://github.com/ousttrue/UwpNativeDllSample</p>
<p>CMakeのCache機構のせいで挙動を勘違いした部分を書き直し。</p>
<p>自前でビルドしたlibpng.dllでpngを表示するサンプル。
デスクトップアプリとの違い</p>
<p>dllのロードパスがカレントディレクトリと環境変数PATHに記述された場所ではなく、projectのトップレベルのみ
デスクトップと公開されているAPIに差異がある
projectが違う。x86 vxprojとuwp32 vcxprojのdiffの抜粋。</p>
<blockquote>
<pre class="code literal-block"><span></span><span class="nt">&lt;ApplicationType&gt;</span>Windows Store<span class="nt">&lt;/ApplicationType&gt;</span>^M
<span class="nt">&lt;DefaultLanguage&gt;</span>en-US<span class="nt">&lt;/DefaultLanguage&gt;</span>^M
<span class="nt">&lt;ApplicationTypeRevision&gt;</span>10.0<span class="nt">&lt;/ApplicationTypeRevision&gt;</span>^M
<span class="nt">&lt;MinimumVisualStudioVersion&gt;</span>14.0<span class="nt">&lt;/MinimumVisualStudioVersion&gt;</span>^M
<span class="nt">&lt;AppContainerApplication&gt;</span>true<span class="nt">&lt;/AppContainerApplication&gt;</span>^M
</pre>

</blockquote>
<p>zlib-1.2.11を無修正でビルドできた。
libpng-1.6.29は_ExitProcessにリンクする段階でエラーになった</p>
<p>修正方法が書いてあった。</p>
<p>https://github.com/Microsoft/vcpkg/blob/master/docs/example-3-patch-libpng.md</p>
<p>UWP向けビルドオプション/zw
無くても動いた。UWP固有のAPIにアクセスするときもしくはC++/CXに必要？</p>
<p>https://msdn.microsoft.com/ja-jp/library/hh561383.aspx</p>
<p>cmakeでWindowsStore向けのprojectを生成する
Microsoft版のcmakeなら作れる。
VS2017にも含まれていて以下のパスにあった。
C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\CommonExtensions\Microsoft\CMake\CMake\bin\cmake.exe
本家のcmakeでもできるかもしれないが未確認。
プロジェクトを生成するときに以下のオプションを指定する。</p>
<p>-DCMAKE_SYSTEM_NAME=WindowsStore
-DCMAKE_SYSTEM_VERSION=10.0</p>
<p>これだけだとCMAKE_SYSTEM_PROCESSORが空になってlibpngではエラーになる。追加で下記のオプションも指定した。</p>
<p>-DCMAKE_SYSTEM_PROCESSOR=x86</p>
<p>ほかに/zwの指定など。</p>
<p>-DCMAKE_C_FLAGS=/ZW /EHsc /DWIN32=1
-DCMAKE_CXX_FLAGS=/ZW /EHsc /DWIN32=1</p>
<p>例
zlib-1.2.11/build&gt; cmake.exe .. -G Visual Studio 15 2017 -DCMAKE_SYSTEM_PROCESSOR=x86 -DCMAKE_SYSTEM_NAME=WindowsStore -DCMAKE_SYSTEM_VERSION=10.0 -DCMAKE_C_FLAGS=/ZW /EHsc /DWIN32=1 -DCMAKE_CXX_FLAGS=/ZW /EHsc /DWIN32=1 </p>
<p _dll='"DLL' _hresult="(HRESULT" _libpng16_="'libpng16'">C#からDllImport
Desktopの時と記述方法は同じ。dllの配置場所は上記の通りprojectに放り込むだけ。
デスクトップ向けにビルドしたdllは動くのか
動いた。
逆にUWP向けにビルドしたdllはデスクトップで動くのか
動かなかった。ソース互換はある程度あるがバイナリ互換は無い。</p>
<p>このエラーがデスクトップでuwpのdllを呼び出したとき固有のエラーメッセージぽい。
まとめ
CMakeの場合はプロジェクト生成オプションさえわかれば、 デスクトップとそれほど使い勝手は変わらない。この煩雑な手順を記録しておくべく自動ビルドツール作成中。</p>
<p>https://github.com/ousttrue/bldproc</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="github/bldproc/" class="u-url">bldproc</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="github/bldproc/" rel="bookmark">
            <time class="published dt-published" datetime="2017-04-26T00:14:58Z" itemprop="datePublished" title="2017-04-26 00:14">2017-04-26 00:14</time><span class="updated"> (更新日時
                    <time class="dt-updated" datetime="2017-05-03T08:05:35Z" itemprop="dateUpdated" title="2017-05-03 08:05">2017-05-03 08:05</time>)</span>
            </a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p><a href="https://github.com/ousttrue/bldproc">https://github.com/ousttrue/bldproc</a></p>
<p>auto build tool</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/04/mmdbrige_build/" class="u-url">MmdBridgeのビルドスクリプトを作った</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2017/04/mmdbrige_build/" rel="bookmark">
            <time class="published dt-published" datetime="2017-04-24T00:00:00+09:00" itemprop="datePublished" title="2017-04-24 00:00">2017-04-24 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>MmdBridgeのビルド手順をまとめたpythonスクリプトを作った。</p>
<p>https://github.com/ousttrue/mmdbridge</p>
<p>さくっとVisualStudio2015 64bit版をビルドできる。
WITH_VMD, WITH_PMXまで対応。
WITH_ALEMBICはいずれ。
Boost.Pythonをビルドするスクリプトも作ったのだけど、作業中に遭遇したpybuildがヘッダオンリーをと言っておりよさげだったので置き換えてみた。
Boost.Pythonの弱点のBoostを解凍するめんどくささ(Boostのファイル数は多すぎ)と、種類ごとにビルドしないといけない煩雑さから解放されるのでとてもよい。</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/04/boost_python/" class="u-url">Boost.Pythonのリンク周り</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2017/04/boost_python/" rel="bookmark">
            <time class="published dt-published" datetime="2017-04-22T00:00:00+09:00" itemprop="datePublished" title="2017-04-22 00:00">2017-04-22 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>mmdbridgeのビルドで必要になったBoost.Python周り。
どうやら、OpenEXR界隈では結構使われている様子。
AlembicとかUSDとか。
しかしWindows版のBoost.Pythonはリンク周りにはまり要素が多いので、記録しといた。</p>
<p>Pythonへのリンク
python_d.libにリンクする必要がない場合
Python自体のデバッグをするのでなければpython_dにリンクする必要はない。
python_dへのリンクの必要性は、リンクするライブラリをDebugで統一する必要の有無なのだけど、
pydを作っているときは必要ない。python.exeではなくpython_d.exeから実行して何もかもが、Debugを参照するようにするのはつらい。そうではなくて自分のアプリがPythonを内臓する場合は、python_dにリンクした方がよい。DebugとReleaseの混在によるエラーが出る可能性があるので。で、mmdbridgeは後者なのでpython_dをリンクすることに妥当性がある。
python_d.libへのリンクを防止する</p>
<p>https://stackoverflow.com/questions/16200997/why-doesnt-include-python-h-work</p>
<h2>ifdef _DEBUG</h2>
<p>#undef _DEBUG
  #include <python.h>
  #define _DEBUG</python.h></p>
<h2>else</h2>
<p>#include <python.h></python.h></p>
<h2>endif</h2>
<p>これが、常套手段になるようでpydの開発時には入れておくとよい。
Boost.Pythonがpython_dにリンクする</p>
<p>boost-1.64.0
python-3.5.3</p>
<p>debug版のboostをビルドしたのだが、よく見るとRelease版のpython35.dllの方がリンクされていた。がんばって、DEBUGマクロの定義等を調べたのだがなかなかわからなかった。どうやらどこかでundef _DEBUGされているらしいと当たりがついた。</p>
<p>boost/python/detail/wrap_python.hpp</p>
<h2>ifdef _DEBUG</h2>
<h2>ifndef BOOST_DEBUG_PYTHON</h2>
<h2>ifdef _MSC_VER</h2>
<pre class="code literal-block"><span></span>// VC8.0 will complain if system headers are #included both with
// and without _DEBUG defined, so we have to #include all the
// system headers used by pyconfig.h right here.
</pre>

<h2>include <stddef.h></stddef.h>
</h2>
<h2>include <stdarg.h></stdarg.h>
</h2>
<h2>include <stdio.h></stdio.h>
</h2>
<h2>include <stdlib.h></stdlib.h>
</h2>
<h2>include <assert.h></assert.h>
</h2>
<h2>include <errno.h></errno.h>
</h2>
<h2>include <ctype.h></ctype.h>
</h2>
<h2>include <wchar.h></wchar.h>
</h2>
<h2>include <basetsd.h></basetsd.h>
</h2>
<h2>include <io.h></io.h>
</h2>
<h2>include <limits.h></limits.h>
</h2>
<h2>include <float.h></float.h>
</h2>
<h2>include <string.h></string.h>
</h2>
<h2>include <math.h></math.h>
</h2>
<h2>include <time.h></time.h>
</h2>
<h2>endif</h2>
<h2>undef _DEBUG // Don't let Python force the debug library just because we're debugging.</h2>
<h2>define DEBUG_UNDEFINED_FROM_WRAP_PYTHON_H</h2>
<h2>endif</h2>
<h2>endif</h2>
<p>python_d.libにリンクするには
b2 --with-python --debug-configuration python-debugging=on</p>
<p>として
libboost_python3-vc140-mt-gyd-1_64
を作成する。gydのyがpython debugらしい。
Boost.Pythonへのリンク
boostはどうやってリンクするライブラリの名前を決めているのか</p>
<h2>pragma comment(lib,"wsock32.lib")</h2>
<p>どこかに#pragmaが記述されているはずだが。</p>
<p>https://stackoverflow.com/questions/16200997/why-doesnt-include-python-h-work
http://d.hatena.ne.jp/torutk/20121004/p1</p>
<p>autolinkらしい。自動的に有効になる。</p>
<p>http://www.boost.org/doc/libs/1_48_0/boost/config/auto_link.hpp</p>
<p>pragmaリンクの名前が一致しないんだけど</p>
<p>libboost_python3-vc140-mt-gd-1_64にリンクしたいのだがlibboost_python-vc140-mt-gd-1_64にリンクしようとする
boost_python3_vc140-mt-gd-1_64にリンクしたいのいだがlibboost_python-vc140-mt-gd-1_64にリンクしようとする</p>
<p>BOOST_ALL_NO_LIB</p>
<p>を定義してautolinkを阻止して自分でリンクする。
python3はどうやって決まるのか
むしろboost_python3がBOOST_LIB_NAMEから決まる。
BOOST_LIB_NAMEは、boost/python/detail/config.hppで下記の記述がある。
boost-1.61.0</p>
<h2>define BOOST_LIB_NAME boost_python</h2>
<p>boost_python3.dllとboost_python.dllは両方Python3にリンクされとった
なんだってー。つまり、boostは複数のPythonに対するビルド結果を共存させることは考慮されていないということだった。なるほど
ReleaseビルドとDebugビルドは同じReleaseのdllにリンクするべき
Debug版であっても、boost_python.dllも同じRelease版にリンクされる。
AutoLinkに逆らわない方がよい。
CMakeのFIND_PACKAGE(BOOST)によるBoost_LIBRARIESは使わない方がよいかもしれない。デバッグの方にリンクされてはまりうる。ていうか、はまった。
結論として、AutoLink邪魔だーからAutoLinkに従えとなった。
pybindを使おう
ヘッダオンリーなので。リンク無いし。</p>
<p>https://github.com/pybind/pybind11</p>
<p>既存のBoost.Pythonを使ったコードでも、pybindはBoost.Pythonと似たAPIになっているので簡単に置き換えられる。</p>
<p>pybind11でC++の関数をpythonから使う</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/04/mmdbridge/" class="u-url">MmdBridgeをビルドしてみる</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2017/04/mmdbridge/" rel="bookmark">
            <time class="published dt-published" datetime="2017-04-21T00:00:00+09:00" itemprop="datePublished" title="2017-04-21 00:00">2017-04-21 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>MmdBridgeがよさげなのでビルドしてみる。</p>
<p>最初はプロジェクトと同じPython-3.4 + VS2010でがんばったのだが、 Windows10(64bit)でVS2010(64bit)環境を作るのが困難であることがわかった。ちょっと違うがPython-3.5 + VS2015でやってみる。
Python3.5のビルド(不要)
Debug版でもBoost.PythonがRelease版のPython.dllにリンクするとわかった。
普通のインストーラーでインストールするとデバッグ版が手に入らぬ。せっかくなので自前ビルド。</p>
<p>Windows上でPython3.5をビルドする
Boost.PythonのデバッグビルドがリンクするPython.dll</p>
<p>Boost.Python
手元のboost-1.61.0を使う。
$HOME/user-config.jam
using python
     : 3.5.3
     : D:\usr\src\Python-3.5.3\PCBuild\python # cmd-or-prefix
     : D:\usr\src\Python-3.5.3\include
     : D:\usr\src\Python-3.5.3\PCBuild\amd64
     ;</p>
<p>memo: Jamroot.jam
boost_1_61_0&gt; bootstrap.bat
boost_1_61_0&gt; b2 -j2 --with-python3 address-model=64 toolset=msvc-14.0 threading=multi variant=debug,release link=static runtime-link=static,shared --stagedir=stage/x86_64 include=D:\usr\src\Python-3.5.3\PC </p>
<p>include=D:\usr\src\Python-3.5.3\PCはpyconfig.hの場所。user-config.jamに2個目のincludeパスを記述する方法がわからなかったのでコマンドライン投入。
DXSDK_Jun10のインストール
d3dx9のあるDirectXはダウンロードしてインストールする必要がある。 April 2006を使っているそうなのだけどネット上に見つからなかったので手に入ったバージョンを使った。ビルド時にエラーが出るので下記の記事に沿ってd3dx9core.hを修正する。</p>
<p>https://gist.github.com/t-mat/1540248</p>
<p>VS2015
premake5でVS2015向けにプロジェクトを作ってビルドしたところkンパイルエラーになった。VS2015固有の問題のようなのでコードを修正。</p>
<p>VS 2015 で std::codecvt_utf8 がリンクできない場合の対処法
src/umbase/UMStringUtil.h</p>
<p>動作確認する</p>
<p>Mmdを展開する
mmdBridgeのd3d9.dllとd3dx9_43.dllをMmdディレクトリにコピーする(ビルド結果)
mmdBridgeのpythonスクリプトをMmdディレクトリにコピーする(mmdbridge/Release/Win32フォルダにある)
python.dllをMmdディレクトリにコピーする。もしくはパスを通す(普通にインストールしたPython3でよい)
Mmdディレクトリにoutディレクトリを作成する</p>
<p>以上で、mmdbridge_vmd.pyの動作を確認できた。</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/04/build_python3/" class="u-url">Windows上でPython3.5をビルドする</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2017/04/build_python3/" rel="bookmark">
            <time class="published dt-published" datetime="2017-04-20T00:00:00+09:00" itemprop="datePublished" title="2017-04-20 00:00">2017-04-20 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>VisualStudio2015でPython3.5(64bit Debug)をビルドする。</p>
<p>ソースをダウンロードして解凍した。
Python-3.5.3
build.batを実行する</p>
<blockquote>
<p>cd Python-3.5.3/PCbuild
Python-3.5.3/PCbuild&gt; build.bat -p x64 -c Debug</p>
</blockquote>
<p>pythoncore.vcxproj -&gt; Python-3.5.3\PCBuild\amd64\python35_d.dll</p>
<p>できあがり。</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="github/mmdutility/" class="u-url">MmdUtility</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="github/mmdutility/" rel="bookmark">
            <time class="published dt-published" datetime="2017-04-18T17:45:16Z" itemprop="datePublished" title="2017-04-18 17:45">2017-04-18 17:45</time><span class="updated"> (更新日時
                    <time class="dt-updated" datetime="2017-04-21T02:57:18Z" itemprop="dateUpdated" title="2017-04-21 02:57">2017-04-21 02:57</time>)</span>
            </a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p><a href="https://github.com/ousttrue/MmdUtility">https://github.com/ousttrue/MmdUtility</a></p>
<p>reconstructed pymeshio</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2017/04/pymeshio/" class="u-url">pymeshio再構築計画</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2017/04/pymeshio/" rel="bookmark">
            <time class="published dt-published" datetime="2017-04-18T00:00:00+09:00" itemprop="datePublished" title="2017-04-18 00:00">2017-04-18 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>はじめてのBlenderアドオン開発を読んでいる。pymeshioを更新してBlenderの作法にちゃんと適合させようというわけである。</p>
<p>最近、BlenderのAddOn管理ツールBlender-Add-on-Managerというのを見つけて、どういう動作をしているのか気になった。自作のpymeshioは出てくるのか見てみると出てこなかった。bl_infoの中のコメントの書き方が悪かったらしい。出てくるように直してインストールしてみた。今度はBlenderが発見してくれない。これは、Blenderの検索パスのくせのせいで.がパスに含まれていると出てこないということだった。そもそも、%USERPROFILE%/AppData/Roaming/Blender Foundation/Blender/2.78/scripts/addonsというようなパスにインストールする仕組みになっていることを知らなかったという。
で、ツール経由でインストールしてみたのはいいのだがpymeshioは動かないな。
Blender非依存のpythonライブラリ部分をコピーしなおす必要がある。
むしろ、そっちの方が本体でBlenderはおまけだったという経緯があるのであるが、前からpymeshioのblenderプラグインのメンテナンス性の悪さはこのフォルダ構成が一因であった。この際addonsに直接cloneして動くような構成にする方がいいなぁ。新しいAddOnを再構築するか。
pymeshioはblenderから切り離して開発を継続する。pymeshioと新しいAddOnの共通部分の同期は手動コピペにするｗ
計画</p>
<p>https://github.com/ousttrue/MmdUtility</p>
<p>[x] 0.1
Blender-Add-on-Managerからインストールして動作するように構成する
[x] 0.2
bl.pyを除去する。確かbl.pyはblender2.4と2.6のギャップを埋めて、2.6初期のAPIの不安さを隠蔽するために作った。もはや無用の長物なので取り除く
[x] 0.3
物理の扱いを変える。</p>
<p>http://mrsoramame.jpn.org/archives/138
https://github.com/12funkeys/rigid_bodys_gen</p>
<p>pymeshioを作ったときはBlenderの物理がよくわかっていなかった。
[ ] 1.0
VMD対応</p>
</div>
                </div>
            </article>
</div>
    
        <ul class="pager postindexpager clearfix">
<li class="previous"><a href="index-21.html" rel="prev">新しい記事</a></li>
            <li class="next"><a href="index-19.html" rel="next">過去の記事</a></li>
        </ul>
<!--End of body content--><footer id="footer">
            Contents © 2021         <a href="mailto:ousttrue@gmail.com">ousttrue</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
            
        </footer>
</div>
</div>


        <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
