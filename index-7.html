<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="ja">
<head>
<meta charset="utf-8">
<meta name="description" content="作業記録">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>三次元日誌 (過去の記事 7ページ目) | 三次元日誌</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="ja" href="rss.xml">
<link rel="canonical" href="https://ousttrue.github.io/index-7.html">
<link rel="prev" href="index-8.html" type="text/html">
<link rel="next" href="index-6.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">本文を読み飛ばす</a>

<!-- Header and menu bar -->
<div class="container">
      <header class="blog-header py-3"><div class="row nbb-header align-items-center">
          <div class="col-md-3 col-xs-2 col-sm-2" style="width: auto;">
            <button class="navbar-toggler navbar-light bg-light nbb-navbar-toggler" type="button" data-toggle="collapse" data-target=".bs-nav-collapsible" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse bs-nav-collapsible bootblog4-search-form-holder">
                
            </div>
        </div>
          <div class="col-md-6 col-xs-10 col-sm-10 bootblog4-brand" style="width: auto;">
            <a class="navbar-brand blog-header-logo text-dark" href=".">

            <span id="blog-title">三次元日誌</span>
        </a>
          </div>
            <div class="col-md-3 justify-content-end align-items-center bs-nav-collapsible collapse flex-collapse bootblog4-right-nav">
            <nav class="navbar navbar-light bg-white"><ul class="navbar-nav bootblog4-right-nav"></ul></nav>
</div>
    </div>
</header><nav class="navbar navbar-expand-md navbar-light bg-white static-top"><div class="collapse navbar-collapse bs-nav-collapsible" id="bs-navbar">
            <ul class="navbar-nav nav-fill d-flex w-100">
<li class="nav-item">
<a href="books" class="nav-link">MemoBooks</a>
                </li>
<li class="nav-item">
<a href="archive.html" class="nav-link">Archives</a>
                </li>
<li class="nav-item">
<a href="categories/index.html" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="rss.xml" class="nav-link">RSS feed</a>
                </li>
<li class="nav-item">
<a href="about" class="nav-link">About</a>

                
            </li>
</ul>
</div>
<!-- /.navbar-collapse -->
</nav>
</div>

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
    
        

    
        
    <div class="postindex">
            <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="github/refrange/" class="u-url">refrange</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="github/refrange/" rel="bookmark">
            <time class="published dt-published" datetime="2014-02-13T13:49:11Z" itemprop="datePublished" title="2014-02-13 13:49">2014-02-13 13:49</time><span class="updated"> (更新日時
                    <time class="dt-updated" datetime="2014-08-28T02:10:21Z" itemprop="dateUpdated" title="2014-08-28 02:10">2014-08-28 02:10</time>)</span>
            </a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p><a href="https://github.com/ousttrue/refrange">https://github.com/ousttrue/refrange</a></p>
<p>Reimplment msgpack</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="github/vimfiles/" class="u-url">vimfiles</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="github/vimfiles/" rel="bookmark">
            <time class="published dt-published" datetime="2013-12-08T07:04:20Z" itemprop="datePublished" title="2013-12-08 07:04">2013-12-08 07:04</time><span class="updated"> (更新日時
                    <time class="dt-updated" datetime="2014-01-21T05:44:43Z" itemprop="dateUpdated" title="2014-01-21 05:44">2014-01-21 05:44</time>)</span>
            </a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p><a href="https://github.com/ousttrue/vimfiles">https://github.com/ousttrue/vimfiles</a></p>
<p>admin vim plugins</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2013/12/08/cmake/" class="u-url">cmakeを使ってみる(Windowsかつコマンドラインで)</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2013/12/08/cmake/" rel="bookmark">
            <time class="published dt-published" datetime="2013-12-08T00:00:00+09:00" itemprop="datePublished" title="2013-12-08 00:00">2013-12-08 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>cmakeを使ってみる(Windowsかつコマンドラインで)
ArUcoを使おうとしたら、msvcpdのvc10版を要求されてvc12でデバッグビルドが動かなかった。
最新版のOpenCV-2.4.7をゲットしてきたところvc10とvc11は含まれて居るのだが、vc12ビルドは含まれていなかった(vc2013は早すぎたかw)。
仕方ないので自前ビルドすることにした。
ということでcmakeの使い方を調べてみる。
ついでに、cmakeでビルドしたライブラリを特定のディレクトリを基準にインストールする方法を調べてみる。
練習にzlibをビルドしてインストールしてみる
以下のようなディレクトリ構成で運用してみることを目標に作業開始。
local_vc12
 + bin # dll置き場
 + include # dllを使うのに必要なheader置き場
 + lib # dllのimportライブラリ置き場</p>
<p>外部依存の無い適当なライブラリで練習してみようということでzlibを選定。
さっそくcmakeを使ってみようと思ったら、zlib-1.2.8にはCmakeLists.txtが含まれとるで。
C:\src&gt; cd zlib-1.2.8
C:\src\zlib-1.2.8&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\zlib-1.2.8&gt; msbuild INSTALL.vcxproj
C:\src\zlib-1.2.8&gt; msbuild INSTALL.vcxproj /p:Configuration=Release</p>
<p>以上で下記のようになった。
C:/local_vc12
C:/local_vc12/bin
C:/local_vc12/bin/zlib.dll
C:/local_vc12/bin/zlibd.dll
C:/local_vc12/include
C:/local_vc12/include/zconf.h
C:/local_vc12/include/zlib.h
C:/local_vc12/lib
C:/local_vc12/lib/zlib.lib
C:/local_vc12/lib/zlibd.lib
C:/local_vc12/lib/zlibstatic.lib
C:/local_vc12/lib/zlibstaticd.lib
C:/local_vc12/share
C:/local_vc12/share/man
C:/local_vc12/share/man/man3
C:/local_vc12/share/man/man3/zlib.3
C:/local_vc12/share/pkgconfig
C:/local_vc12/share/pkgconfig/zlib.pc</p>
<p>素晴らしい。
OpenCV-2.4.7でやってみる
C:\src&gt; cd opencv-2.4.7
C:\src\opencv-2.4.7&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\opencv-2.4.7&gt; msbuild ALL_BUILD.vcxproj</p>
<p>失敗する。</p>
<p>https://github.com/SpecLad/opencv/commit/7973594a01228107dcb9d2d1f10eb64498b91aac
http://stackoverflow.com/questions/17409956/cannot-compile-opencv-2-4-5-with-vs-2013-rtm</p>
<p>あとIlmxxxでmin, maxのエラーが出るので”#include
<algorithm>“する。std::min,
maxはalgorithmに入っとる。ALL_BUILDが成功したらINSTALLする。
C:\src\opencv-2.4.7&gt; msbuild INSTALL.vcxproj</algorithm></p>
<p>これで”local_vc12”にopencvも入った。
cmakeはいままで敬遠していたのだがライブラリのinstallまで面倒見てくれるのはいいですな。
同じく敬遠していた自前dllを使う開発が捗りそうな感じだ。
ArUcoをビルド
cmakeを使ったアプリ(ライブラリを使う方)のビルド。
C:\src&gt; cd aruco-1.2.4
C:\src\aruco-1.2.4&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .</p>
<p>ここでエラーが出る。
OpenCVが正式ビルドと違うディレクトリにインストールされたために検知に失敗する。
“C:/local_vc12/OpenCVConfig.cmake”を直接修正した。
get_filename_component(OpenCV_CONFIG_PATH "${CMAKE_CURRENT_LIST_FILE}" PATH CACHE)</p>
<h2>if(OpenCV_RUNTIME AND OpenCV_ARCH)</h2>
<h2>if(OpenCV_STATIC AND EXISTS "${OpenCV_CONFIG_PATH}/${OpenCV_ARCH}/${OpenCV_RUNTIME}/staticlib/OpenCVConfig.cmake")</h2>
<h2>if(OpenCV_CUDA AND EXISTS "${OpenCV_CONFIG_PATH}/gpu/${OpenCV_ARCH}/${OpenCV_RUNTIME}/staticlib/OpenCVConfig.cmake")</h2>
<h2>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/gpu/${OpenCV_ARCH}/${OpenCV_RUNTIME}/staticlib")</h2>
<h2>else()</h2>
<h2>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/${OpenCV_ARCH}/${OpenCV_RUNTIME}/staticlib")</h2>
<h2>endif()</h2>
<h2>elseif(EXISTS "${OpenCV_CONFIG_PATH}/${OpenCV_ARCH}/${OpenCV_RUNTIME}/lib/OpenCVConfig.cmake")</h2>
<h2>if(OpenCV_CUDA AND EXISTS "${OpenCV_CONFIG_PATH}/gpu/${OpenCV_ARCH}/${OpenCV_RUNTIME}/lib/OpenCVConfig.cmake")</h2>
<h2>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/gpu/${OpenCV_ARCH}/${OpenCV_RUNTIME}/lib")</h2>
<h2>else()</h2>
<h2>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/${OpenCV_ARCH}/${OpenCV_RUNTIME}/lib")</h2>
<h2>endif()</h2>
<h2>endif()</h2>
<h2>endif()</h2>
<p>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/lib")</p>
<p>これでビルドできた。
C:\src\aruco-1.2.4&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\opencv-2.4.7&gt; msbuild ALL_BUILD.vcxproj</p>
<p>しかし、OpenGLを使ったサンプルがビルドされぬ。
どうやらglutが見つからないらいしい。せっかくなのでFreeGlutを入れてみますか。
FreeGlut
http://freeglut.sourceforge.net/
C:\src\freeglut-2.8.1&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
CMake Error: The source directory "C:/src/freeglut-2.8.1" does not appear to contain CMakeLists.txt.
Specify --help for usage, or press the help button on the CMake GUI.</p>
<p>CMakeLists.txtが無い。作ってみる。
project (freeglut)</p>
<p>file(GLOB SOURCES "src/*.c")
ADD_LIBRARY(freeglut SHARED ${SOURCES})</p>
<p>include_directories(include)</p>
<p>ADD_DEFINITIONS(-DFREEGLUT_EXPORTS)
ADD_DEFINITIONS(-D_USRDLL)
ADD_DEFINITIONS(-D_WINDOWS)
ADD_DEFINITIONS(-DWIN32)</p>
<p>C:\src\freeglut-2.8.1&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\opencv-2.4.7&gt; msbuild ALL_BUILD.vcxproj</p>
<p>ビルドできた。INSTALL.vcxprojが見当たらないのでCMakeLists.txtに追記する必要がありそう。
インストールに関する追記。</p>
<h2>dll</h2>
<p>INSTALL(TARGETS freeglut RUNTIME
    DESTINATION bin)</p>
<h2>lib</h2>
<p>INSTALL(TARGETS freeglut ARCHIVE
    DESTINATION lib)</p>
<h2>headers</h2>
<p>INSTALL(DIRECTORY include/
    DESTINATION include
    PATTERN "Makefile.*" EXCLUDE
)</p>
<p>インストールしてみる。
C:\src\freeglut-2.8.1&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\opencv-2.4.7&gt; msbuild INSTALL.vcxproj</p>
<p>-- Install configuration: "Debug"
 -- Installing: C:/local_vc12/bin/freeglut.dll
 -- Installing: C:/local_vc12/lib/freeglut.lib
 -- Installing: C:/local_vc12/include
 -- Installing: C:/local_vc12/include/GL
 -- Up-to-date: C:/local_vc12/include/GL/freeglut.h
 -- Up-to-date: C:/local_vc12/include/GL/freeglut_ext.h
 -- Up-to-date: C:/local_vc12/include/GL/freeglut_std.h
 -- Up-to-date: C:/local_vc12/include/GL/glut.h</p>
<p>インストール成功。
再度ArUco
C:\src\freeglut-2.8.1&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
 -- FOUND OPENGL=YES    LIBS=opengl32;glu32;C:/local_vc12/lib/freeglut.lib</p>
<p>glutが発見されたようだ。
どうやらcmakeはCMAKE_INSTALL_PREFIXにライブラリを探しに行くようですな。
C:\src\opencv-2.4.7&gt; msbuild ALL_BUILD.vcxproj</p>
<p>gl.hの前に”#include <windows.h>“してやってビルドできた。
Debug版の後ろに”d”をつける
FreeGlutのCmakeLists.txtにzlibの”CmakeLists.txt”から頂いてきた。
set(CMAKE_DEBUG_POSTFIX "d")</windows.h></p>
<p>記述順の影響があるようで前の方(ADD_LIBRARYより前？)に書く必要があるっぽい。
Debug版の後ろに”d”がついたライブラリを使う</p>
<p>http://stackoverflow.com/questions/2209929/linking-different-libraries-for-debug-and-release-builds-in-cmake-on-windows
http://stackoverflow.com/questions/5497348/debug-and-release-library-linking-with-cmake-visual-studio</p>
<p>こういう書き方でできた。
set (OPENGL_LIBS  general ${OPENGL_gl_LIBRARY} ${OPENGL_glu_LIBRARY} optimized ${GLUT_glut_LIBRARY} debug ${GLUT_glut_DEBUG_LIBRARY})</p>
<p>CMAKE_DEBUG_POSTFIXに関連は使われる方と使う方の双方で合わせる必要があるので変更する場合は自分で両方の面倒を見なければならない。
一応、cmakeのひととおりの使い方が分かってきた。
vcがmsbuildを使うようになってビルドが制御可能になっている感じ。
makeの各ターゲットに対するmsbuildの実行方法は以下の通り。
"target", "make", "msbuild"
"build", "make all", "msbuild ALL_BUILD.vcxproj /t:Build"
"release build", "?", "msbuild ALL_BUILD.vcxproj /t:Build /p:Configuration=Release"
"debug build", "?", "msbuild ALL_BUILD.vcxproj /t:Build /p:Configuration=Debug"
"clean", "make clean", "msbuild ALL_BUILD.vcxproj /t:Clean"
"install", "make install", "msbuild INSTALL.vcxproj"</p>
<p>ちょっといろいろビルドしてみる。</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2013/12/08/use_cmake/" class="u-url">cmakeを使ってみる(Windowsかつコマンドラインで)</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2013/12/08/use_cmake/" rel="bookmark">
            <time class="published dt-published" datetime="2013-12-08T00:00:00+09:00" itemprop="datePublished" title="2013-12-08 00:00">2013-12-08 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>ArUcoを使おうとしたら、msvcpdのvc10版を要求されてvc12でデバッグビルドが動かなかった。</p>
<p>最新版のOpenCV-2.4.7をゲットしてきたところvc10とvc11は含まれて居るのだが、vc12ビルドは含まれていなかった(vc2013は早すぎたかw)。
仕方ないので自前ビルドすることにした。
ということでcmakeの使い方を調べてみる。
ついでに、cmakeでビルドしたライブラリを特定のディレクトリを基準にインストールする方法を調べてみる。
練習にzlibをビルドしてインストールしてみる
以下のようなディレクトリ構成で運用してみることを目標に作業開始。
local_vc12
 + bin # dll置き場
 + include # dllを使うのに必要なheader置き場
 + lib # dllのimportライブラリ置き場</p>
<p>外部依存の無い適当なライブラリで練習してみようということでzlibを選定。
さっそくcmakeを使ってみようと思ったら、zlib-1.2.8にはCmakeLists.txtが含まれとるで。
C:\src&gt; cd zlib-1.2.8
C:\src\zlib-1.2.8&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\zlib-1.2.8&gt; msbuild INSTALL.vcxproj
C:\src\zlib-1.2.8&gt; msbuild INSTALL.vcxproj /p:Configuration=Release</p>
<p>以上で下記のようになった。
C:/local_vc12
C:/local_vc12/bin
C:/local_vc12/bin/zlib.dll
C:/local_vc12/bin/zlibd.dll
C:/local_vc12/include
C:/local_vc12/include/zconf.h
C:/local_vc12/include/zlib.h
C:/local_vc12/lib
C:/local_vc12/lib/zlib.lib
C:/local_vc12/lib/zlibd.lib
C:/local_vc12/lib/zlibstatic.lib
C:/local_vc12/lib/zlibstaticd.lib
C:/local_vc12/share
C:/local_vc12/share/man
C:/local_vc12/share/man/man3
C:/local_vc12/share/man/man3/zlib.3
C:/local_vc12/share/pkgconfig
C:/local_vc12/share/pkgconfig/zlib.pc</p>
<p>素晴らしい。
OpenCV-2.4.7でやってみる
C:\src&gt; cd opencv-2.4.7
C:\src\opencv-2.4.7&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\opencv-2.4.7&gt; msbuild ALL_BUILD.vcxproj</p>
<p>失敗する。</p>
<p>https://github.com/SpecLad/opencv/commit/7973594a01228107dcb9d2d1f10eb64498b91aac
http://stackoverflow.com/questions/17409956/cannot-compile-opencv-2-4-5-with-vs-2013-rtm</p>
<p>あとIlmxxxでmin, maxのエラーが出るので”#include
<algorithm>“する。std::min,
maxはalgorithmに入っとる。ALL_BUILDが成功したらINSTALLする。
C:\src\opencv-2.4.7&gt; msbuild INSTALL.vcxproj</algorithm></p>
<p>これで”local_vc12”にopencvも入った。
cmakeはいままで敬遠していたのだがライブラリのinstallまで面倒見てくれるのはいいですな。
同じく敬遠していた自前dllを使う開発が捗りそうな感じだ。
ArUcoをビルド
cmakeを使ったアプリ(ライブラリを使う方)のビルド。
C:\src&gt; cd aruco-1.2.4
C:\src\aruco-1.2.4&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .</p>
<p>ここでエラーが出る。
OpenCVが正式ビルドと違うディレクトリにインストールされたために検知に失敗する。
“C:/local_vc12/OpenCVConfig.cmake”を直接修正した。
get_filename_component(OpenCV_CONFIG_PATH "${CMAKE_CURRENT_LIST_FILE}" PATH CACHE)</p>
<h2>if(OpenCV_RUNTIME AND OpenCV_ARCH)</h2>
<h2>if(OpenCV_STATIC AND EXISTS "${OpenCV_CONFIG_PATH}/${OpenCV_ARCH}/${OpenCV_RUNTIME}/staticlib/OpenCVConfig.cmake")</h2>
<h2>if(OpenCV_CUDA AND EXISTS "${OpenCV_CONFIG_PATH}/gpu/${OpenCV_ARCH}/${OpenCV_RUNTIME}/staticlib/OpenCVConfig.cmake")</h2>
<h2>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/gpu/${OpenCV_ARCH}/${OpenCV_RUNTIME}/staticlib")</h2>
<h2>else()</h2>
<h2>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/${OpenCV_ARCH}/${OpenCV_RUNTIME}/staticlib")</h2>
<h2>endif()</h2>
<h2>elseif(EXISTS "${OpenCV_CONFIG_PATH}/${OpenCV_ARCH}/${OpenCV_RUNTIME}/lib/OpenCVConfig.cmake")</h2>
<h2>if(OpenCV_CUDA AND EXISTS "${OpenCV_CONFIG_PATH}/gpu/${OpenCV_ARCH}/${OpenCV_RUNTIME}/lib/OpenCVConfig.cmake")</h2>
<h2>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/gpu/${OpenCV_ARCH}/${OpenCV_RUNTIME}/lib")</h2>
<h2>else()</h2>
<h2>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/${OpenCV_ARCH}/${OpenCV_RUNTIME}/lib")</h2>
<h2>endif()</h2>
<h2>endif()</h2>
<h2>endif()</h2>
<p>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/lib")</p>
<p>これでビルドできた。
C:\src\aruco-1.2.4&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\opencv-2.4.7&gt; msbuild ALL_BUILD.vcxproj</p>
<p>しかし、OpenGLを使ったサンプルがビルドされぬ。
どうやらglutが見つからないらいしい。せっかくなのでFreeGlutを入れてみますか。
FreeGlut
http://freeglut.sourceforge.net/
C:\src\freeglut-2.8.1&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
CMake Error: The source directory "C:/src/freeglut-2.8.1" does not appear to contain CMakeLists.txt.
Specify --help for usage, or press the help button on the CMake GUI.</p>
<p>CMakeLists.txtが無い。作ってみる。
project (freeglut)</p>
<p>file(GLOB SOURCES "src/*.c")
ADD_LIBRARY(freeglut SHARED ${SOURCES})</p>
<p>include_directories(include)</p>
<p>ADD_DEFINITIONS(-DFREEGLUT_EXPORTS)
ADD_DEFINITIONS(-D_USRDLL)
ADD_DEFINITIONS(-D_WINDOWS)
ADD_DEFINITIONS(-DWIN32)</p>
<p>C:\src\freeglut-2.8.1&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\opencv-2.4.7&gt; msbuild ALL_BUILD.vcxproj</p>
<p>ビルドできた。INSTALL.vcxprojが見当たらないのでCMakeLists.txtに追記する必要がありそう。
インストールに関する追記。</p>
<h2>dll</h2>
<p>INSTALL(TARGETS freeglut RUNTIME
    DESTINATION bin)</p>
<h2>lib</h2>
<p>INSTALL(TARGETS freeglut ARCHIVE
    DESTINATION lib)</p>
<h2>headers</h2>
<p>INSTALL(DIRECTORY include/
    DESTINATION include
    PATTERN "Makefile.*" EXCLUDE
)</p>
<p>インストールしてみる。
C:\src\freeglut-2.8.1&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\opencv-2.4.7&gt; msbuild INSTALL.vcxproj</p>
<p>-- Install configuration: "Debug"
 -- Installing: C:/local_vc12/bin/freeglut.dll
 -- Installing: C:/local_vc12/lib/freeglut.lib
 -- Installing: C:/local_vc12/include
 -- Installing: C:/local_vc12/include/GL
 -- Up-to-date: C:/local_vc12/include/GL/freeglut.h
 -- Up-to-date: C:/local_vc12/include/GL/freeglut_ext.h
 -- Up-to-date: C:/local_vc12/include/GL/freeglut_std.h
 -- Up-to-date: C:/local_vc12/include/GL/glut.h</p>
<p>インストール成功。
再度ArUco
C:\src\freeglut-2.8.1&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
 -- FOUND OPENGL=YES    LIBS=opengl32;glu32;C:/local_vc12/lib/freeglut.lib</p>
<p>glutが発見されたようだ。
どうやらcmakeはCMAKE_INSTALL_PREFIXにライブラリを探しに行くようですな。
C:\src\opencv-2.4.7&gt; msbuild ALL_BUILD.vcxproj</p>
<p>gl.hの前に”#include <windows.h>“してやってビルドできた。
Debug版の後ろに”d”をつける
FreeGlutのCmakeLists.txtにzlibの”CmakeLists.txt”から頂いてきた。
set(CMAKE_DEBUG_POSTFIX "d")</windows.h></p>
<p>記述順の影響があるようで前の方(ADD_LIBRARYより前？)に書く必要があるっぽい。
Debug版の後ろに”d”がついたライブラリを使う</p>
<p>http://stackoverflow.com/questions/2209929/linking-different-libraries-for-debug-and-release-builds-in-cmake-on-windows
http://stackoverflow.com/questions/5497348/debug-and-release-library-linking-with-cmake-visual-studio</p>
<p>こういう書き方でできた。
set (OPENGL_LIBS  general ${OPENGL_gl_LIBRARY} ${OPENGL_glu_LIBRARY} optimized ${GLUT_glut_LIBRARY} debug ${GLUT_glut_DEBUG_LIBRARY})</p>
<p>CMAKE_DEBUG_POSTFIXに関連は使われる方と使う方の双方で合わせる必要があるので変更する場合は自分で両方の面倒を見なければならない。
一応、cmakeのひととおりの使い方が分かってきた。
vcがmsbuildを使うようになってビルドが制御可能になっている感じ。
makeの各ターゲットに対するmsbuildの実行方法は以下の通り。
"target", "make", "msbuild"
"build", "make all", "msbuild ALL_BUILD.vcxproj /t:Build"
"release build", "?", "msbuild ALL_BUILD.vcxproj /t:Build /p:Configuration=Release"
"debug build", "?", "msbuild ALL_BUILD.vcxproj /t:Build /p:Configuration=Debug"
"clean", "make clean", "msbuild ALL_BUILD.vcxproj /t:Clean"
"install", "make install", "msbuild INSTALL.vcxproj"</p>
<p>ちょっといろいろビルドしてみる。</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2013/12/01/sharpdx/" class="u-url">SharpDX事始め</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2013/12/01/sharpdx/" rel="bookmark">
            <time class="published dt-published" datetime="2013-12-01T00:00:00+09:00" itemprop="datePublished" title="2013-12-01 00:00">2013-12-01 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>SharpDX事始め
WPFとかDirectX11とかKinectあたりのAPIに慣れておきたいということで、
SharpDXの練習を始めた。
SharpDXのサンプルにDirect3D10/WPFHostというのがあるのだが、
Direct3D11版が無かったので練習がてら11で動くように改造してみた。
Direct3D10とDirect3D11の間の違いは少ないので変更箇所は少ないのだが、
ポイントがいくつかあるのでメモ。</p>
<p>Direct3D11でDeviceの一部の機能がDeviceContextに分けられた。DeviceからDeviceContextを取得するには、Device.ImmediateContextを使える。
Direct3D11でAPIからEffectが消滅した。SharpDXはこの機能をsharpdx_direct3d11_effects_x86.dllで提供しているのでこれを実行パスにコピーするべし。あとよくわからないが、CompileFromFileの第２引数には”fx_5_0”を指定するべし。”fx_4_0”だとエラーになる。適当にやってみたら動いたからよいものの謎。</p>
<p>とりあえずこれでWPF+DirectX11な開発を始められるで。
せっかくなので CodePlexにアップ。 https://wpfhost11.codeplex.com/
ちょっと、C#系のクンフーを高めて行こうかと。
追記</p>
<p>http://stackoverflow.com/questions/18912194/sharpdx-2-5-in-directx11-in-wpf</p>
<p>SharpDXElement使えだと？</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2013/11/28/pathogen_vim/" class="u-url">vim環境整備</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2013/11/28/pathogen_vim/" rel="bookmark">
            <time class="published dt-published" datetime="2013-11-28T00:00:00+09:00" itemprop="datePublished" title="2013-11-28 00:00">2013-11-28 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>vim環境整備
Windows8でコーディングができるようにvim回りを整備する。
コマンドライン環境としてPowerShellを採用してそこからvim(gvim)する方向性。
前の日記を整理して書き直し。
PowerShellを使えるようにしてvimとgitをインストールする
PowerShellを管理者権限で実行して以下のように実行する。
powershell&gt; Set-ExecutionPolicy RemoteSigned</p>
<p>パッケージ管理として Chocolatey
をインストール。dos窓で以下のように実行する。
dos&gt; @powershell -NoProfile -ExecutionPolicy unrestricted -Command "iex ((new-object net.webclient).DownloadString('https://chocolatey.org/install.ps1'))" &amp;&amp; SET PATH=%PATH%;%systemdrive%\chocolatey\bin</p>
<p>powershellの設定ファイル作成する。shellの.profileに相当するファイル。</p>
<p>C:/Users/<em>USER_NAME</em>/Documents/WindowsPowerShell/Microsoft.PowerShell_profile.ps1</p>
<p>とりあえずwhichコマンド的な関数を書いておく
function which([string] $command=$(throw "need command name")){
    $Env:Path.Split(";") | %{ ls $<em>  2&gt; $null } | ?{ $</em>.Name -match "^$command" } | % { $_.FullName }
} </p>
<p>改めてPowerShellを起動してchocolateyでvimをインストールする
powershell&gt; cinst vim</p>
<p>gitも入れる。
powershell&gt; cinst git</p>
<p>cinstの実行直後はいろいろPathが通っていなかったりして使えない場合があるのでその場合はpowershellを再起動。
vimを整備する
NerdTreeを入れようと思ったらpathogen.vim使えと書いてあったのでpathogen.vim入れる。
powershell&gt; cd $HOME
powershell&gt; mkdir vimfiles
powershell&gt; cd vimfiles
powershell&gt; mkdir autoload, bundle
powershell&gt; git init</p>
<p>pathogen.vim
を入れる。downloadしてvimfiles/autoload/pathogen.vimに保存する。
powershell&gt; git add .
powershell&gt; git commit -m init</p>
<p>とりあえずgitに登録した。
_vimrc
execute pathogen#infect()
syntax on
filetype plugin indent on</p>
<p>colorscheme darkblue</p>
<p>set hidden
set nobackup</p>
<p>_gvimrc
colorscheme desert</p>
<p>set iminsert=0
set imsearch=-1
set visualbell t_vb=</p>
<p>set columns=100
set lines=56</p>
<p>NerdTree
NerdTree をgit
submoduleとしてインストールする。
powershell&gt; cd vimfiles/bundle
powershell&gt; git submodule add https://github.com/scrooloose/nerdtree.git</p>
<p>以上でvim環境が始動した。
追記
WindowsだとNerdTreeの[m]キーのメニューにcopyが出ない問題があったがstackoverflowに
原因と解決方法が書いてあった。
http://stackoverflow.com/questions/11269926/nerdtree-copy-command-in-windows-7</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2013/11/27/vs2013/" class="u-url">VS2013 express editionを入れてみた</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2013/11/27/vs2013/" rel="bookmark">
            <time class="published dt-published" datetime="2013-11-27T00:00:00+09:00" itemprop="datePublished" title="2013-11-27 00:00">2013-11-27 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <p>VS2013 express editionを入れてみた
で、DirectX9のプロジェクトをビルドしようとしてみたのだが
D3DXが無くなっておる。
こいつは面倒くさいことになった・・・。
D3D9はあるのにD3DX9だけ無くなっているという。
D3D11対応を強いられている。</p>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2013/11/26/unity_mmd/" class="u-url">Unity開始</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2013/11/26/unity_mmd/" rel="bookmark">
            <time class="published dt-published" datetime="2013-11-26T00:00:00+09:00" itemprop="datePublished" title="2013-11-26 00:00">2013-11-26 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>仕事の都合もあって、Unityの学習を開始。</p>
<p>Unity開始
だいぶ前にオライリーのUnity本が出たころに少し触っただけなので初見とあまり変わらない。
今奥付、を見たら2011年9月とか書いてあった。
とりあえずUnity4.3をインストールして、
秀和システムの「見てわかるUnityゲーム制作超入門 (Game Developer Books)」
にさらっと目を通した。
これからソフトバンクの「Unityではじめるゲームづくり(DVD付)
(ゲープロシリーズ) 」 を読むところ。
MikuMikuDance for Unityではまった
で、mmdモデルでもさくっと出してみようとしたところはまったのでそれについてメモ。</p>
<p>コンパイラ エラー CS0241 既定のパラメータ指定子は使用できません</p>
<p>が出てしまうと言うもの。
調べたところ、パラメータの規定値は.Net4.0で導入されたものらしいのだが
.Net3.5でコンパイルしようとしているのが原因とわかった。
で、手動で.Net4を使うようにしたら治った。
参考</p>
<p>http://ufcpp.net/study/csharp/sp4_optional.html
http://vmem.jp/2012/02/16/monodevelop%E3%81%A7%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E3%81%AEtarget-framework%E3%82%92mono-net-4-0%E3%81%AB%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B/</p>
<p>ところが別のマシンでやってみたら何事もなくできてしまった。
道理でググっても同じはまりが出てこないわけだ。
古いMonoDevelopの設定が残っているとかあったのか。</p>
<p>２冊目の方を読み始めた。
適当にTerrain書いただけだがわりとそれっぽい感じに。</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2013/11/25/win8/" class="u-url">Windows8導入</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2013/11/25/win8/" rel="bookmark">
            <time class="published dt-published" datetime="2013-11-25T00:00:00+09:00" itemprop="datePublished" title="2013-11-25 00:00">2013-11-25 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>Windows8導入
なんとなく去年買ってきてきてLinuxで使っていたマシンに
SSDを買ってきてWindows8をインストールしてみた。
UEFIインストール
UEFIインストールしたほうが起動が早いらしいのでやってみた。</p>
<p>起動してdelボタンを押して設定画面に入る
その状態でインストールROMを挿入
起動メニューからUEFIの方のROMを選択
数秒間 ROMから起動するならなんか押せ と表示が出るのでその間にEnter
WindowsではなくASUSのロゴが出て起動すればUEFIモードでの起動に成功</p>
<p>あとはロムの指示に従ってインストールする
インストール後の環境
最近cygwinからPowerShellに移住しようとしているので、 cuiはPowerShellで。
まずは、PowerShellの権限変更。 PowerShellを管理者権限で起動して、</p>
<blockquote>
<p>Set-ExecutionPolicy RemoteSigned</p>
</blockquote>
<p>Chocolatey
PowerShell版のapt-get的なChocolateyをインストールする。
dos窓(powershellではない)を起動してサイトに書いてある通りにコピペ。
@powershell -NoProfile -ExecutionPolicy unrestricted -Command "iex ((new-object net.webclient).DownloadString('https://chocolatey.org/install.ps1'))" &amp;&amp; SET PATH=%PATH%;%systemdrive%\chocolatey\bin</p>
<p>putty
powershell&gt; cinst putty</p>
<p>vim
powershell&gt; cinst vim</p>
<p>~/_gvimrc
colorscheme desert</p>
<p>set iminsert=0
set imsearch=-1
set visualbell t_vb=</p>
<p>~/_vimrc
colorscheme darkblue</p>
<p>set hidden
set nobackup</p>
<p>git
powershell&gt; cinst git</p>
<p>PowerShellの起動スクリプトにパスを追加
powershell&gt; mkdir $HOME/Documents/WindowsPowerShell
powershell&gt; gvim $PROFILE</p>
<p>$env:PATH+=";C:\Program Files (x86)\Git\bin"</p>
<p>これでgit付属のssh等にPathが通る。 とりあえずEditorとGitが手に入った。
まだまだ色々とインストールせねばならんな。</p>
</div>
                </div>
            </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="posts/2013/10/29/waf/" class="u-url">pythonによるビルドスクリプトwafを使い始めた</a></h1>
                <div class="metadata">
                    <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                        ousttrue
                    </span></p>
            <p class="dateline">
            <a href="posts/2013/10/29/waf/" rel="bookmark">
            <time class="published dt-published" datetime="2013-10-29T00:00:00+09:00" itemprop="datePublished" title="2013-10-29 00:00">2013-10-29 00:00</time></a>
            </p>
                </div>
            </header><div class="e-content entry-content">
                    <div>
<p>pythonによるビルドスクリプトwafを使い始めた
pythonによるビルドシステムwafを使ってみた。
使ってみた感触ではvcとgcc両方でビルドするとかそういうのに向いていそうなので、要するにわしのニーズに合っているように思える。
https://code.google.com/p/waf/
前から気にはなっていたのだけれどどうにも取っ付きが悪くて使えるところまでたどりつけていなかったのだが、やっと最初の一歩を踏み出すことができたのでメモを残す。
早速実践から行く。
+hello/
  +hello.cpp</p>
<p>hello.cpp</p>
<h2>include <iostream></iostream>
</h2>
<p>int main(int argc, char **argv)
{
    std::cout &lt;&lt; "hello waf !" &lt;&lt; std::endl;
    return 0;
}</p>
<p>というプロジェクトを作ったとする。
https://code.google.com/p/waf/downloads/detail?name=waf-1.7.13
からwaf(python
scriptの圧縮されたもの)をダウンロードしてwscriptを記述する。
+hello/
  +hello.cpp
  +waf
  +wscript</p>
<p>wscriptは以下のようにする。
APPNAME='hello'
VERSION='1.0.0'</p>
<p>def configure(conf):
    conf.env['MSVC_TARGETS'] = ['x86']
    conf.load('msvc')
    conf.env.CXXFLAGS = ['/nologo', '/EHsc']</p>
<p>def build(bld):
    bld.program(
            source='hello.cpp', 
            target=APPNAME
            )</p>
<p>初回とwscriptのconfigureを修正する度にconfigureする。</p>
<blockquote>
<p>python waf configure 
Setting top to                           : C:\work_waf\hello
Setting out to                           : C:\work_waf\hello\build
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\Bin\amd64\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\Bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\Bin\x86_IA64\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\BIN\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\BIN\CL.exe
Checking for program CL                  : C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\CL.exe
Checking for program CL                  : c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\BIN\CL.exe
Checking for program LINK                : c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\BIN\LINK.exe
Checking for program LIB                 : c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\BIN\LIB.exe
Checking for program MT                  : C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin\MT.exe
Checking for program RC                  : C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin\RC.exe
'configure' finished successfully (6.219s)</p>
</blockquote>
<p>ビルドする。</p>
<blockquote>
<p>python waf build
Waf: Entering directory <code>C:\work\_waf\hello\build'
[1/2] cxx: hello.cpp -&gt; build\hello.cpp.1.o
hello.cpp
[2/2] cxxprogram: build\hello.cpp.1.o -&gt; build\hello.exe build\hello.exe.manifest
Waf: Leaving directory</code>C:\work_waf\hello\build'
'build' finished successfully (1.138s)</p>
</blockquote>
<p>実行してみる。</p>
<blockquote>
<p>.\build\hello.exe
hello waf !</p>
</blockquote>
<p>ということでvcでexeをビルドするスクリプトができた。
何もパスの設定をしなくてもvcのコンパイラを勝手に探してビルドできるのは意外だった。
とはいえ、これだけではwafの嬉しさは発揮されないのでこれからwscriptを拡張していく。
次回、debugとrelease, 32bitビルドと64bitビルドの管理について書く予定。</p>
</div>
                </div>
            </article>
</div>
    
        <ul class="pager postindexpager clearfix">
<li class="previous"><a href="index-8.html" rel="prev">新しい記事</a></li>
            <li class="next"><a href="index-6.html" rel="next">過去の記事</a></li>
        </ul>
<!--End of body content--><footer id="footer">
            Contents © 2021         <a href="mailto:ousttrue@gmail.com">ousttrue</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
            
        </footer>
</div>
</div>


        <script src="assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
