"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5640],{372:function(e,t,n){n.r(t),n.d(t,{default:function(){return u}});var l=n(1151),r=n(7294);function c(e){const t=Object.assign({h1:"h1",h2:"h2",p:"p",code:"code",h3:"h3",ul:"ul",li:"li",a:"a"},(0,l.ah)(),e.components);return r.createElement(r.Fragment,null,r.createElement(t.h1,null,"term周りの更新"),"\n",r.createElement(t.h2,null,"terminal emulator を選定・・・"),"\n",r.createElement(t.p,null,"主に3つの動作環境、",r.createElement(t.code,null,"Windows"),", ",r.createElement(t.code,null,"Windows wsl"),", ",r.createElement(t.code,null,"Ubuntu-20.04")," があってtoolや設定をある程度共通にしたいということで試行錯誤していた。\n他に ",r.createElement(t.code,null,"ssh経由"),", ",r.createElement(t.code,null,"Windows wslg")," もあるよ。"),"\n",r.createElement(t.h3,null,"wezterm"),"\n",r.createElement(t.p,null,r.createElement(t.code,null,"wezterm")," が有望であることがわかった"),"\n",r.createElement(t.p,null,"|                 | font fallback | multiplexer | emoji | nerdfnt | graphics escape      |\n|-----------------|---------------|-------------|-------|---------|----------------------|\n| wezterm windows | ✅            | ✅          | color | ✅      | conpty issue         |\n| wezterm wsl     | ✅            | ✅          | color | ✅      | conpty issue         |\n| wezterm ssh     | ✅            | ✅          | color | ✅      | sixel, kitty, iterm2 |\n| wezterm linux   | ✅            | ✅          | color | ✅      | sixel, kitty, iterm2 |"),"\n",r.createElement(t.p,null,"conpty を通すときに escape sequence が加工されるとかで、",r.createElement(t.code,null,"sixel"),", ",r.createElement(t.code,null,"kitty"),", ",r.createElement(t.code,null,"iterm2")," いずれのプロトコルもうまくうごかなかった。",r.createElement(t.code,null,"iterm2")," は絵はでるのだけど場所がずれるという惜しい挙動・・・。"),"\n",r.createElement(t.p,null,"https://github.com/wez/wezterm/issues/1236"),"\n",r.createElement(t.p,null,"SSH 経由で WSL することで対処する。"),"\n",r.createElement(t.h3,null,"wslg(xtermなど)"),"\n",r.createElement(t.p,null,r.createElement(t.code,null,"xterm")," は軽快できれいに表示できるので良かった。フォントのフォールバックができないぽいのが弱点。\n",r.createElement(t.code,null,"urxvt")," は、",r.createElement(t.code,null,"NerdFonts")," がうまくでなかった。\n",r.createElement(t.code,null,"st")," (simple term) もフォントまわりでつまづきだったかな。"),"\n",r.createElement(t.p,null,"|             | font fallback | multiplexer | emoji | nerdfnt | graphics escape |\n|-------------|---------------|-------------|-------|---------|-----------------|\n| xterm wslg  |               |             | mono  | ✅      | sixel           |\n| mlterm wslg | ✅            | mlterm-con  | color | ✅      | sixel           |"),"\n",r.createElement(t.p,null,"mlterm はフォント周りの設定が強力でよかった。\n文字セットごとにフォントを個別に指定できるので、フォントを合成せずともばらのままでよい。"),"\n",r.createElement(t.p,null,r.createElement(t.code,null,"mlterm-con")," という multiplexer があり sixel support があるらしい。\n自前ビルドが必要そう(apt には含まれていないぽい)。"),"\n",r.createElement(t.p,null,"wslgは、頻繁にキーボードが押しっぱなしになったり不安定なような・・・\nhttps://github.com/microsoft/wslg/issues/207\nなおっているけ、リリースに時間がかかりそう？"),"\n",r.createElement(t.h3,null,"libvte"),"\n",r.createElement(t.p,null,r.createElement(t.code,null,"libvte")," 系のterm。\n",r.createElement(t.code,null,"gnome-terminal"),", ",r.createElement(t.code,null,"xfce4-term")," など。"),"\n",r.createElement(t.h3,null,"gpu rendering"),"\n",r.createElement(t.p,null,"GPUレンダリングで ",r.createElement(t.code,null,"araclitty"),", ",r.createElement(t.code,null,"kitty")," そして ",r.createElement(t.code,null,"wezterm")," がある。\n",r.createElement(t.code,null,"wezterm")," が ",r.createElement(t.code,null,"Windows")," をサポートしていて、フォントのレンダリング、タブのサポートと総合的に良い。"),"\n",r.createElement(t.h3,null,"その他"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"tabby"),"\n",r.createElement(t.li,null,"RLogin"),"\n",r.createElement(t.li,null,"ConEmu"),"\n"),"\n",r.createElement(t.p,null,"など。"),"\n",r.createElement(t.h2,null,"要件"),"\n",r.createElement(t.h3,null,"日本語、中文、絵文字, NerdFonts を同時にいい感じに表示したい"),"\n",r.createElement(t.p,null,"となるとすべてを含むひとつのフォントより、主になるフォントを設定してそれにグリフが含まれなかったら、他のフォントにフォールバックする挙動をしてもらう方が便利。\nいくつかのフォントを試してみたのだけど、 ",r.createElement(t.code,null,"HackGenNerd Console")," が良かった。\nで、中文の足りない漢字を ",r.createElement(t.code,null,"更紗ゴシックフォント")," にフォールバックするという組み合わせ。\nがんばって完璧な合成フォントを自作すればいいのだけど、よくわからないので、 複数フォントのフォールバック機能が必要。"),"\n",r.createElement(t.p,null,"かつて w3m で表示が乱れることで苦労した ",r.createElement(t.code,null,"ambigous width")," 問題はあまり気にならなくなっていた。\nなんか、表示は２カラム使うが、データ上は1カラムと見なすような扱いになっていて、\n",r.createElement(t.code,null,"X")," につづいて ",r.createElement(t.code,null," ")," で隙間を開けることで正しく表示できるようだ。\nNerdFonts や 絵文字 はそのようになっている？"),"\n",r.createElement(t.h3,null,"エスケープシーケンスで画像を表示したい"),"\n",r.createElement(t.p,null,r.createElement(t.code,null,"sixel")," とか ",r.createElement(t.code,null,"kitty")," とか ",r.createElement(t.code,null,"iterm2")," による画像表示。"),"\n",r.createElement(t.p,null,"|                        | graphics            |\n|------------------------|---------------------|\n| Windows Native(conpty) |                     |\n| wsltty                 | sixel               |\n| xterm wslg             | sixel               |\n| wezterm linux          | sixel, kityt ,iterm2 |"),"\n",r.createElement(t.p,null,"という感じになった。",r.createElement(t.code,null,"wsltty")," は ",r.createElement(t.code,null,"conpty")," ではなくて ",r.createElement(t.code,null,"winpty")," なので例外的に ",r.createElement(t.code,null,"sixel")," が通過できるらしい。\n動く環境でも ",r.createElement(t.code,null,"tmux")," を挟むと動かなくなる。\n代わりに terminal emulator の方で multiplexer(タブ機能) する必要が発生。"),"\n",r.createElement(t.h2,null,"まとめ"),"\n",r.createElement(t.p,null,"総合力で wezterm が強い。"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"あまり頑張らなくてもフォントがうまく設定できる(cjk, NerdFonts, 絵文字)"),"\n",r.createElement(t.li,null,"multiplexer 機能あり"),"\n",r.createElement(t.li,null,"sixel, kitty, iterm2 プロトコルで画像を表示できる"),"\n",r.createElement(t.li,null,"Windows でも動く"),"\n"),"\n",r.createElement(t.h2,null,"参考"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,r.createElement(t.a,{href:"https://zenn.dev/yutakatay/articles/wezterm-intro"},"alacritty+tmuxもいいけど、weztermがすごい件")),"\n",r.createElement(t.li,null,r.createElement(t.a,{href:"https://wezfurlong.org/wezterm/"},"wezterm")),"\n",r.createElement(t.li,null,"https://sw.kovidgoyal.net/kitty/graphics-protocol/"),"\n",r.createElement(t.li,null,"OSC1337 https://iterm2.com/documentation-images.html"),"\n",r.createElement(t.li,null,r.createElement(t.a,{href:"https://unrealman.hatenablog.com/entry/tty-mintty-winpty"},"【Git for Windows】tty/mintty/winptyとは何なのか？【Gitbash】")),"\n"))}var m=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,l.ah)(),e.components);return t?r.createElement(t,e,r.createElement(c,e)):c(e)};n(8678);function a(e){let{data:t,children:n}=e;return r.createElement(r.Fragment,null,r.createElement("h1",null,t.mdx.frontmatter.title),r.createElement(l.Zo,null,n))}function u(e){return r.createElement(a,e,r.createElement(m,e))}},8678:function(e,t,n){n(7294)},1151:function(e,t,n){n.d(t,{Zo:function(){return a},ah:function(){return c}});var l=n(7294);const r=l.createContext({});function c(e){const t=l.useContext(r);return l.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}const m={};function a({components:e,children:t,disableParentContext:n}){let a;return a=n?"function"==typeof e?e({}):e||m:c(e),l.createElement(r.Provider,{value:a},t)}}}]);
//# sourceMappingURL=component---src-templates-post-template-js-content-file-path-home-runner-work-ousttrue-github-io-ousttrue-github-io-content-posts-2022-0331-term-md-bb846475d48619764c63.js.map