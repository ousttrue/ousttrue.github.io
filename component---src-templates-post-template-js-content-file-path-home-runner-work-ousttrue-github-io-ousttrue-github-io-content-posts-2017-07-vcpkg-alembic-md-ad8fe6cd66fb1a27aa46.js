"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2776],{1081:function(e,n,l){l.r(n),l.d(n,{default:function(){return m}});var c=l(1151),a=l(7294);function i(e){const n=Object.assign({p:"p",ul:"ul",li:"li",code:"code",pre:"pre"},(0,c.ah)(),e.components);return a.createElement(a.Fragment,null,a.createElement(n.p,null,"mmdbridgeのvcpkgを使ったビルド手順を作ったついでにAlembicのvcpkg向けパッケージを作ってみる。"),"\n",a.createElement(n.p,null,"情報収集"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"https://github.com/Microsoft/vcpkg/blob/master/docs/examples/packaging-zlib.md"),"\n"),"\n",a.createElement(n.p,null,"読んだ。"),"\n",a.createElement(n.p,null,a.createElement(n.code,null,"vcpkg create url")," で雛形が作れる。"),"\n",a.createElement(n.p,null,"実験"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},".\\vcpkg.exe create alembic https://github.com/alembic/alembic/archive/1.7.1.tar.gz\nCMake Error at scripts/ports.cmake:101 (message):\n  Portfile already exists: 'D:\\vcpkg\\ports\\alembic\\portfile.cmake'\n")),"\n",a.createElement(n.p,null,"すでにあるだと！？\n最近できたらしい。"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,"https://github.com/Microsoft/vcpkg/tree/master/ports/alembic"),"\n"),"\n",a.createElement(n.p,null,"しかし、hdf非対応みたいなので作ってみる。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},".\\vcpkg.exe create alembic-hdf https://github.com/alembic/alembic/archive/1.7.1.tar.gz\n\nVCPKG_DIR\n    ports\n        alembic-hdf\n            CONTROL\n            portfile.cmake\n")),"\n",a.createElement(n.p,null,"ができた。\n簡単なCONTROLから。\nこっちはパッケージ情報を決めるだけなのでさくっと。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"Source: alembic-hdf\nVersion: 1.7.1\nDescription: alembic with hdf5\nBuild-Depends: hdf5\n")),"\n",a.createElement(n.p,null,"本題のportfile.cmake。\nそのままだとエラーになるの。最低限以下が必要なようだ。\nアーカイブを展開パスの指定。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-cmake"},"set(SOURCE_PATH ${CURRENT_BUILDTREES_DIR}/src/1.7.1)\n\n# ↓ 修正する\n\nset(SOURCE_PATH ${CURRENT_BUILDTREES_DIR}/src/alembic-1.7.1)\n")),"\n",a.createElement(n.p,null,"実行してみる。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"> ./vcpkg install alembic-hdf:x64-windows\nThe following packages will be built and installed:\n    alembic-hdf:x64-windows\nBuilding package alembic-hdf:x64-windows...\n-- CURRENT_INSTALLED_DIR=D:/vcpkg/installed/x64-windows\n-- DOWNLOADS=D:/vcpkg/downloads\n-- CURRENT_PACKAGES_DIR=D:/vcpkg/packages/alembic-hdf_x64-windows\n-- CURRENT_BUILDTREES_DIR=D:/vcpkg/buildtrees/alembic-hdf\n-- CURRENT_PORT_DIR=D:/vcpkg/ports/alembic-hdf/.\n-- Using cached D:/vcpkg/downloads/1.7.1.tar.gz\n-- Testing integrity of cached file...\n-- Testing integrity of cached file... OK\n-- Extracting done\n-- Configuring x64-windows-rel\n-- Configuring x64-windows-rel done\n-- Configuring x64-windows-dbg\nPS D:\\vcpkg> .\\vcpkg.exe install alembic-hdf:x64-windows\nThe following packages will be built and installed:\n    alembic-hdf:x64-windows\nBuilding package alembic-hdf:x64-windows...\n-- CURRENT_INSTALLED_DIR=D:/vcpkg/installed/x64-windows\n-- DOWNLOADS=D:/vcpkg/downloads\n-- CURRENT_PACKAGES_DIR=D:/vcpkg/packages/alembic-hdf_x64-windows\n-- CURRENT_BUILDTREES_DIR=D:/vcpkg/buildtrees/alembic-hdf\n-- CURRENT_PORT_DIR=D:/vcpkg/ports/alembic-hdf/.\n-- Using cached D:/vcpkg/downloads/1.7.1.tar.gz\n-- Testing integrity of cached file...\n-- Testing integrity of cached file... OK\n-- Extracting done\n-- Configuring x64-windows-rel\n-- Configuring x64-windows-rel done\n-- Configuring x64-windows-dbg\n-- Configuring x64-windows-dbg done\n-- Package x64-windows-rel\n-- Package x64-windows-rel done\n-- Package x64-windows-dbg\n-- Package x64-windows-dbg done\n-- Performing post-build validation\nInclude files should not be duplicated into the /debug/include directory. If this cannot be disabled in the project cmake, use\n    file(REMOVE_RECURSE ${CURRENT_PACKAGES_DIR}/debug/include)\nThe /lib/cmake folder should be merged with /debug/lib/cmake and moved to /share/alembic-hdf/cmake.\nThe following cmake files were found outside /share/alembic-hdf. Please place cmake files in /share/alembic-hdf.\n\n    D:/vcpkg/packages/alembic-hdf_x64-windows/lib/cmake/Alembic/AlembicConfig.cmake\n    D:/vcpkg/packages/alembic-hdf_x64-windows/lib/cmake/Alembic/AlembicConfigVersion.cmake\n    D:/vcpkg/packages/alembic-hdf_x64-windows/lib/cmake/Alembic/AlembicTargets-release.cmake\n    D:/vcpkg/packages/alembic-hdf_x64-windows/lib/cmake/Alembic/AlembicTargets.cmake\n    D:/vcpkg/packages/alembic-hdf_x64-windows/debug/lib/cmake/Alembic/AlembicConfig.cmake\n    D:/vcpkg/packages/alembic-hdf_x64-windows/debug/lib/cmake/Alembic/AlembicConfigVersion.cmake\n    D:/vcpkg/packages/alembic-hdf_x64-windows/debug/lib/cmake/Alembic/AlembicTargets-debug.cmake\n    D:/vcpkg/packages/alembic-hdf_x64-windows/debug/lib/cmake/Alembic/AlembicTargets.cmake\n\nThe /debug/lib/cmake folder should be merged with /lib/cmake into /share/alembic-hdf\n\nThe following dlls were found in /lib or /debug/lib. Please move them to /bin or /debug/bin, respectively.\n\n    D:/vcpkg/packages/alembic-hdf_x64-windows/lib/Alembic.dll\n\n\nThe following dlls were found in /lib or /debug/lib. Please move them to /bin or /debug/bin, respectively.\n\n    D:/vcpkg/packages/alembic-hdf_x64-windows/debug/lib/Alembic.dll\n\nThe software license must be available at ${CURRENT_PACKAGES_DIR}/share/alembic-hdf/copyright\n\n    file(COPY ${CURRENT_BUILDTREES_DIR}/src/alembic-1.7.1/LICENSE.txt DESTINATION ${CURRENT_PACKAGES_DIR}/share/alembic-hdf)\n    file(RENAME ${CURRENT_PACKAGES_DIR}/share/alembic-hdf/LICENSE.txt ${CURRENT_PACKAGES_DIR}/share/alembic-hdf/copyright)\nThe following EXEs were found in /bin or /debug/bin. EXEs are not valid distribution targets.\n\n    D:/vcpkg/packages/alembic-hdf_x64-windows/bin/abcdiff.exe\n    D:/vcpkg/packages/alembic-hdf_x64-windows/bin/abcecho.exe\n    D:/vcpkg/packages/alembic-hdf_x64-windows/bin/abcechobounds.exe\n    D:/vcpkg/packages/alembic-hdf_x64-windows/bin/abcls.exe\n    D:/vcpkg/packages/alembic-hdf_x64-windows/bin/abcstitcher.exe\n    D:/vcpkg/packages/alembic-hdf_x64-windows/bin/abctree.exe\n\nThe following EXEs were found in /bin or /debug/bin. EXEs are not valid distribution targets.\n\n    D:/vcpkg/packages/alembic-hdf_x64-windows/debug/bin/abcdiff.exe\n    D:/vcpkg/packages/alembic-hdf_x64-windows/debug/bin/abcecho.exe\n    D:/vcpkg/packages/alembic-hdf_x64-windows/debug/bin/abcechobounds.exe\n    D:/vcpkg/packages/alembic-hdf_x64-windows/debug/bin/abcls.exe\n    D:/vcpkg/packages/alembic-hdf_x64-windows/debug/bin/abcstitcher.exe\n    D:/vcpkg/packages/alembic-hdf_x64-windows/debug/bin/abctree.exe\n\nFound 9 error(s). Please correct the portfile:\n    D:\\vcpkg\\ports\\alembic-hdf\\portfile.cmake\n-- Performing post-build validation done\nError: Building package alembic-hdf:x64-windows failed with: POST_BUILD_CHECKS_FAILED\nPlease ensure you're using the latest portfiles with `.\\vcpkg update`, then\nsubmit an issue at https://github.com/Microsoft/vcpkg/issues including:\n  Package: alembic-hdf:x64-windows\n  Vcpkg version: 0.0.81-144d3718c4197b101c7d61ee6a258200371fb1ab\n\nAdditionally, attach any relevant sections from the log files above.\n")),"\n",a.createElement(n.p,null,"という感じになった。\nエラーメッセージがすごく親切。\nあと、NINJAビルド速い。\nエラーにはなるがビルド結果は以下のように出力された。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"VCPKG_DIR/packages/alembic-hdf_x64-windows\n│  BUILD_INFO\n│\n├─bin\n│      abcdiff.exe\n│      abcecho.exe\n│      abcechobounds.exe\n│      abcls.exe\n│      abcstitcher.exe\n│      abctree.exe\n│\n├─debug\n│  ├─bin\n│  │      abcdiff.exe\n│  │      abcecho.exe\n│  │      abcechobounds.exe\n│  │      abcls.exe\n│  │      abcstitcher.exe\n│  │      abctree.exe\n│  │\n│  ├─include\n│  │  └─Alembic\n│  │      ├─Abc\n│  │      │      *.h\n│  │      │\n│  │      ├─AbcCollection\n│  │      │      *.h\n│  │      │\n│  │      ├─AbcCoreAbstract\n│  │      │      *.h\n│  │      │\n│  │      ├─AbcCoreFactory\n│  │      │      *.h\n│  │      │\n│  │      ├─AbcCoreLayer\n│  │      │      *.h\n│  │      │\n│  │      ├─AbcCoreOgawa\n│  │      │      *.h\n│  │      │\n│  │      ├─AbcGeom\n│  │      │      *.h\n│  │      │\n│  │      ├─AbcMaterial\n│  │      │      *.h\n│  │      │\n│  │      └─Util\n│  │              *.h\n│  │\n│  └─lib\n│      │  Alembic.dll\n│      │  Alembic.lib\n│      │\n│      └─cmake\n│          └─Alembic\n│                  AlembicConfig.cmake\n│                  AlembicConfigVersion.cmake\n│                  AlembicTargets-debug.cmake\n│                  AlembicTargets.cmake\n│\n├─include\n│  └─Alembic\n│      ├─Abc\n│      │      *.h\n│      │\n│      ├─AbcCollection\n│      │      *.h\n│      │\n│      ├─AbcCoreAbstract\n│      │      *.h\n│      │\n│      ├─AbcCoreFactory\n│      │      *.h\n│      │\n│      ├─AbcCoreLayer\n│      │      *.h\n│      │\n│      ├─AbcCoreOgawa\n│      │      *.h\n│      │\n│      ├─AbcGeom\n│      │      *.h\n│      │\n│      ├─AbcMaterial\n│      │      *.h\n│      │\n│      └─Util\n│              *.h\n│\n└─lib\n    │  Alembic.dll\n    │  Alembic.lib\n    │\n    └─cmake\n        └─Alembic\n                AlembicConfig.cmake\n                AlembicConfigVersion.cmake\n                AlembicTargets-release.cmake\n                AlembicTargets.cmake\n")),"\n",a.createElement(n.p,null,"ここから不要なものを削除したり、場所の違うものを移動したりすることで完成できそう。\nエラーメッセージに沿って修正してみる"),"\n",a.createElement(n.p,null,a.createElement(n.code,null,"debug/include")," 不要"),"\n",a.createElement(n.p,null,"エラーメッセージに含まれるとおりに。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-cmake"},'file(REMOVE_RECURSE ${CURRENT_PACKAGES_DIR}/debug/include)\n\nlib/cmake/Alembic/*.cmakeをshare/alembic-hdfに移動するべし\ndebug/lib/cmake/Alembicを統合するべし。\nvcpkg_fixup_cmake_targets(CONFIG_PATH "lib/cmake/Alembic")\n')),"\n",a.createElement(n.p,null,"ぽい。 ",a.createElement(n.code,null,"alembic/portfile.cmake")," を参考にした"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-cmake"},"lib/Alembic.dllをbin/Alembic.dllに移動せよ\ndebug/lib/Alembic.dllも。\nfile(RENAME ${CURRENT_PACKAGES_DIR}/lib/Alembic.dll ${CURRENT_PACKAGES_DIR}/bin/Alembic.dll)\nfile(RENAME ${CURRENT_PACKAGES_DIR}/debug/lib/Alembic.dll ${CURRENT_PACKAGES_DIR}/debug/bin/Alembic.dll)\n")),"\n",a.createElement(n.p,null,a.createElement(n.code,null,"alembic/portfile.cmake")," を参考にした"),"\n",a.createElement(n.p,null,"ライセンスファイルをコピーせよ\nエラーメッセージに含まれるとおりに。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-cmake"},"file(COPY ${CURRENT_BUILDTREES_DIR}/src/alembic-1.7.1/LICENSE.txt DESTINATION ${CURRENT_PACKAGES_DIR}/share/alembic-hdf)\nfile(RENAME ${CURRENT_PACKAGES_DIR}/share/alembic-hdf/LICENSE.txt ${CURRENT_PACKAGES_DIR}/share/alembic-hdf/copyright)\n")),"\n",a.createElement(n.p,null,"exeを削除せよ"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-cmake"},"file(GLOB EXE ${CURRENT_PACKAGES_DIR}/bin/*.exe)\nfile(GLOB DEBUG_EXE ${CURRENT_PACKAGES_DIR}/debug/bin/*.exe)\nfile(REMOVE ${EXE})\nfile(REMOVE ${DEBUG_EXE})\n")),"\n",a.createElement(n.p,null,"alembic/portfile.cmakeを参考にした\nおまけ: debug用にpdbをコピー\nalembic/portfile.cmakeを参考にした\nvcpkg_copy_pdbs()"),"\n",a.createElement(n.p,null,"vcpkg_install_cmakeより下を抜粋。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-cmake"},'vcpkg_install_cmake()\n\n# Remove debug/include\nfile(REMOVE_RECURSE ${CURRENT_PACKAGES_DIR}/debug/include)\n# fix *.cmake\nvcpkg_fixup_cmake_targets(CONFIG_PATH "lib/cmake/Alembic")\n# Rename dll\nfile(RENAME ${CURRENT_PACKAGES_DIR}/lib/Alembic.dll ${CURRENT_PACKAGES_DIR}/bin/Alembic.dll)\nfile(RENAME ${CURRENT_PACKAGES_DIR}/debug/lib/Alembic.dll ${CURRENT_PACKAGES_DIR}/debug/bin/Alembic.dll)\n# Handle copyright\nfile(COPY ${CURRENT_BUILDTREES_DIR}/src/alembic-1.7.1/LICENSE.txt DESTINATION ${CURRENT_PACKAGES_DIR}/share/alembic-hdf)\nfile(RENAME ${CURRENT_PACKAGES_DIR}/share/alembic-hdf/LICENSE.txt ${CURRENT_PACKAGES_DIR}/share/alembic-hdf/copyright)\n# Remove exe files\nfile(GLOB EXE ${CURRENT_PACKAGES_DIR}/bin/*.exe)\nfile(GLOB DEBUG_EXE ${CURRENT_PACKAGES_DIR}/debug/bin/*.exe)\nfile(REMOVE ${EXE})\nfile(REMOVE ${DEBUG_EXE})\n# Copy pdb\nvcpkg_copy_pdbs()\n')),"\n",a.createElement(n.p,null,"再度ビルド。"),"\n",a.createElement(n.p,null,a.createElement(n.code,null,"> vcpkg install alembic-hdf:x64-windows")),"\n",a.createElement(n.p,null,"うまくいった。\nUSE_HDF5を有効にする\nportfileの修正\nCONTROLに依存追加。\nBuild-Depends: ilmbase, hdf5"),"\n",a.createElement(n.p,null,"USE_HDF5を有効に。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-cmake"},"vcpkg_configure_cmake(\n    SOURCE_PATH ${SOURCE_PATH}\n    PREFER_NINJA # Disable this option if project cannot be built with Ninja\n    OPTIONS -DUSE_HDF5=ON\n    # OPTIONS_RELEASE -DOPTIMIZE=1\n    # OPTIONS_DEBUG -DDEBUGGABLE=1\n)\n")),"\n",a.createElement(n.p,null,"ビルドあんどエラー\nビルドしてみるがエラーになる。"),"\n",a.createElement(n.p,null,a.createElement(n.code,null,"VCPKG_DIR\\buildtrees\\alembic-hdf\\package-x64-windows-rel-out.log")," を見て原因を探る。"),"\n",a.createElement(n.p,null,"hdf5に対するlinkが無くて、hdf5関連のシンボルが見つからん。\nパッチ\nalembic-1.7.1/lib/Alembic/CMakeLists.txtを修正したいのでやり方を調べる。\nパッチの当て方"),"\n",a.createElement(n.p,null,"portfile.cmakeに記述する。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-cmake"},"vcpkg_extract_source_archiveよりあと、vcpkg_install_cmakeより前。\nvcpkg_apply_patches(\n    SOURCE_PATH ${SOURCE_PATH}\n    PATCHES ${CMAKE_CURRENT_LIST_DIR}/fix-hdf5link.patch\n)\n")),"\n",a.createElement(n.p,null,"パッチの作り方"),"\n",a.createElement(n.p,null,"https://github.com/Microsoft/vcpkg/blob/master/docs/examples/patching-libpng.md#patching-the-code-to-improve-compatibility"),"\n",a.createElement(n.p,null,"なるほど。\ngitを準備して・・・"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},'vcpkg> cd ./buildtrees/alembic-hdf/src/alembic-1.7.1/\nvcpkg/buildtrees/alembic-hdf/src/alembic-1.7.1> git init\nvcpkg/buildtrees/alembic-hdf/src/alembic-1.7.1> git add .\nvcpkg/buildtrees/alembic-hdf/src/alembic-1.7.1> git commit -m "temp"\n')),"\n",a.createElement(n.p,null,"修正\nalembic-1.7.1/lib/Alembic/CMakeLists.txtを修正。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-diff"},"> git diff\n--git a/lib/Alembic/CMakeLists.txt b/lib/Alembic/CMakeLists.txt\nindex 5028c91..1f81d50 100644\n--- a/lib/Alembic/CMakeLists.txt\n+++ b/lib/Alembic/CMakeLists.txt\n@@ -49,6 +49,12 @@ ADD_SUBDIRECTORY(AbcMaterial)\n ADD_SUBDIRECTORY(Ogawa)\n\n ADD_LIBRARY(Alembic ${LIB_TYPE} ${CXX_FILES})\n+IF (USE_HDF5)\n+    TARGET_LINK_LIBRARIES(Alembic\n+        ${HDF5_LIBRARIES}\n+        )\n+    ADD_DEFINITIONS(-DH5_BUILT_AS_DYNAMIC_LIB)\n+ENDIF()\n\n TARGET_INCLUDE_DIRECTORIES(Alembic\n     PUBLIC\n")),"\n",a.createElement(n.p,null,"gitでpatchを作成"),"\n",a.createElement(n.p,null,a.createElement(n.code,null,"> git diff | out-file -enc ascii ..\\..\\..\\..\\ports\\alembic-hdf\\fix-hdf5link.patch")),"\n",a.createElement(n.p,null,"ビルド"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"> .\\vcpkg.exe install alembic-hdf:x64-windows\nInstalling package alembic-hdf:x64-windows... done\n")),"\n",a.createElement(n.p,null,"VCPKG_DIR/installed/x64-windows/bin/Alembic.dllをdependencywalkerで見てみるとばっちりhdf5.dllへのリンクが含まれている。作業完了。\nはじめてで調べながらでもわりとさくさく作業が進んだ。エラーメッセージの出し方とか、フォルダの構成とかvcpkgなかなかレベルが高いな。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},"ports\nports/alembic-hdf/CONTROL\nSource: alembic-hdf\nVersion: 1.7.1\nDescription: alembic with hdf5\nBuild-Depends: ilmbase, hdf5\n")),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-ports/alembic-hdf/portfile.cmake"},'# Common Ambient Variables:\n#   CURRENT_BUILDTREES_DIR    = ${VCPKG_ROOT_DIR}\\buildtrees\\${PORT}\n#   CURRENT_PACKAGES_DIR      = ${VCPKG_ROOT_DIR}\\packages\\${PORT}_${TARGET_TRIPLET}\n#   CURRENT_PORT_DIR          = ${VCPKG_ROOT_DIR}\\ports\\${PORT}\n#   PORT                      = current port name (zlib, etc)\n#   TARGET_TRIPLET            = current triplet (x86-windows, x64-windows-static, etc)\n#   VCPKG_CRT_LINKAGE         = C runtime linkage type (static, dynamic)\n#   VCPKG_LIBRARY_LINKAGE     = target library linkage type (static, dynamic)\n#   VCPKG_ROOT_DIR            = <C:\\path\\to\\current\\vcpkg>\n#   VCPKG_TARGET_ARCHITECTURE = target architecture (x64, x86, arm)\n#\n\ninclude(vcpkg_common_functions)\nset(SOURCE_PATH ${CURRENT_BUILDTREES_DIR}/src/alembic-1.7.1)\nvcpkg_download_distfile(ARCHIVE\n    URLS "https://github.com/alembic/alembic/archive/1.7.1.tar.gz"\n    FILENAME "1.7.1.tar.gz"\n    SHA512 89e30b681a76eaf79b20ebeff62c495971b0eb64b28f249a14bbcf3bdb40df7eda93b0ede299dd5511bd4587a2cc2d4ebd851fb89bf999fdccc31fee3cffbba2\n)\nvcpkg_extract_source_archive(${ARCHIVE})\n\nvcpkg_apply_patches(\n    SOURCE_PATH ${SOURCE_PATH}\n    PATCHES ${CMAKE_CURRENT_LIST_DIR}/fix-hdf5link.patch\n)\n\nvcpkg_configure_cmake(\n    SOURCE_PATH ${SOURCE_PATH}\n    PREFER_NINJA # Disable this option if project cannot be built with Ninja\n    OPTIONS -DUSE_HDF5=ON\n    # OPTIONS_RELEASE -DOPTIMIZE=1\n    # OPTIONS_DEBUG -DDEBUGGABLE=1\n)\n\nvcpkg_install_cmake()\n\n# Remove debug/include\nfile(REMOVE_RECURSE ${CURRENT_PACKAGES_DIR}/debug/include)\n# fix *.cmake\nvcpkg_fixup_cmake_targets(CONFIG_PATH "lib/cmake/Alembic")\n# Rename dll\nfile(RENAME ${CURRENT_PACKAGES_DIR}/lib/Alembic.dll ${CURRENT_PACKAGES_DIR}/bin/Alembic.dll)\nfile(RENAME ${CURRENT_PACKAGES_DIR}/debug/lib/Alembic.dll ${CURRENT_PACKAGES_DIR}/debug/bin/Alembic.dll)\n# Handle copyright\nfile(COPY ${CURRENT_BUILDTREES_DIR}/src/alembic-1.7.1/LICENSE.txt DESTINATION ${CURRENT_PACKAGES_DIR}/share/alembic-hdf)\nfile(RENAME ${CURRENT_PACKAGES_DIR}/share/alembic-hdf/LICENSE.txt ${CURRENT_PACKAGES_DIR}/share/alembic-hdf/copyright)\n# Remove exe files\nfile(GLOB EXE ${CURRENT_PACKAGES_DIR}/bin/*.exe)\nfile(GLOB DEBUG_EXE ${CURRENT_PACKAGES_DIR}/debug/bin/*.exe)\nfile(REMOVE ${EXE})\nfile(REMOVE ${DEBUG_EXE})\n# Copy pdb\nvcpkg_copy_pdbs()\n')),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-ports/alembic-hdf/fix-hdf5link.patch"},"diff --git a/lib/Alembic/CMakeLists.txt b/lib/Alembic/CMakeLists.txt\nindex 5028c91..1f81d50 100644\n--- a/lib/Alembic/CMakeLists.txt\n+++ b/lib/Alembic/CMakeLists.txt\n@@ -49,6 +49,12 @@ ADD_SUBDIRECTORY(AbcMaterial)\n ADD_SUBDIRECTORY(Ogawa)\n \n ADD_LIBRARY(Alembic ${LIB_TYPE} ${CXX_FILES})\n+IF (USE_HDF5)\n+    TARGET_LINK_LIBRARIES(Alembic \n+        ${HDF5_LIBRARIES}\n+        )\n+    ADD_DEFINITIONS(-DH5_BUILT_AS_DYNAMIC_LIB)\n+ENDIF()\n \n TARGET_INCLUDE_DIRECTORIES(Alembic\n     PUBLIC\n")),"\n",a.createElement(n.p,null,"vcpkgにPR送った\n採用されたので上記の作業は必要なくなったのが、cmake-3.9.0の更新でFindHDF5が壊れるという事態が発生したので対応中…。"))}var t=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,c.ah)(),e.components);return n?a.createElement(n,e,a.createElement(i,e)):i(e)};l(8678);function b(e){let{data:n,children:l}=e;return a.createElement(a.Fragment,null,a.createElement("h1",null,n.mdx.frontmatter.title),a.createElement(c.Zo,null,l))}function m(e){return a.createElement(b,e,a.createElement(t,e))}},8678:function(e,n,l){l(7294)},1151:function(e,n,l){l.d(n,{Zo:function(){return b},ah:function(){return i}});var c=l(7294);const a=c.createContext({});function i(e){const n=c.useContext(a);return c.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const t={};function b({components:e,children:n,disableParentContext:l}){let b;return b=l?"function"==typeof e?e({}):e||t:i(e),c.createElement(a.Provider,{value:b},n)}}}]);
//# sourceMappingURL=component---src-templates-post-template-js-content-file-path-home-runner-work-ousttrue-github-io-ousttrue-github-io-content-posts-2017-07-vcpkg-alembic-md-ad8fe6cd66fb1a27aa46.js.map