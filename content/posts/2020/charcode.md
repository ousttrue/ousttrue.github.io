---
title: "文字コード"
date: 2020-08-05T00:01:54+09:00
draft: true
tags: ["w3m"]
---

w3m 改造にあたって、 `libwc` に対処したい。
w3m は、 `iconv` とかに頼らずに自前の文字コード変換システムを持っているのだ。
もともと、`libwc` のソースは別フォルダに分かれているのだけど、
boehm-GC を使う `Str` と分かち難く絡み合っているので、これを分解して扱いやすくしたい。
あと、 設定とか状態をグローバル変数で持っている部分があるようなので、
再入可能にするべくここらにも手を入れたい。

コードを眺めていたら、

```c
struct wc_wchar_t
{
    CodedCharacterSet ccs;
    uint32_t code;
};
```

というのを発見。
