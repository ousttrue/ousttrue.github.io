"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1257],{6289:function(e,n,t){t.r(n),t.d(n,{default:function(){return u}});var a=t(1151),l=t(7294);function i(e){const n=Object.assign({p:"p",a:"a"},(0,a.ah)(),e.components);return l.createElement(l.Fragment,null,l.createElement(n.p,null,"DirectShow後継の動画・音声フレームワーク。"),"\n",l.createElement(n.p,null,"sampleのありか"),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation"},"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation")),"\n",l.createElement(n.p,null,"Win7Samplesに気付かず・・・\nはじめの一歩\nここから始めるのがよい。"),"\n",l.createElement(n.p,null,"Audio/Video Playback"),"\n",l.createElement(n.p,null,"How to Play Media Files with Media Foundation"),"\n",l.createElement(n.p,null,"Media Session Playback Example。ソースあり"),"\n",l.createElement(n.p,null,"MediaSessionPlaybackExampleで動画を開くとこんな感じのTopologyになる。\n動画(MediaSource)---\x3evideo-> EVR(MediaSink)\n|\n+->audio-> SAR(MediaSink)"),"\n",l.createElement(n.p,null,"MediaSourceとMediaSinkを作ってつなぐのがMediaFoundationの基本概念。\nCMakeでビルドできるように取りまとめた。"),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://github.com/ousttrue/MediaFoundationSample/tree/master/MediaSessionPlaybackExample"},"https://github.com/ousttrue/MediaFoundationSample/tree/master/MediaSessionPlaybackExample")),"\n",l.createElement(n.p,null,"構成\nDirectShowとは違う感じのところがある。"),"\n",l.createElement(n.p,null,"IMFMediaSourceがストレージとDemuxerを内包している\nなので途中で枝分かれするというよりも、IMFMediaStream -> IMFTransform -> IMFStreamSinkというラインが複数ある感じになる。"),"\n",l.createElement(n.p,null,"+---------------+\n|IMFMediaSource |\n+---------------+\n|+-------------+|\n||IMFByteStream||\n|+-------------+|                                          VideoRenderer\n|  |  |Read     |                                          +------------+\n|  |  v         |     (compressed) decoder (uncompressed)  |IMFMediaSink|\n|  | +--------------+ IMFSample +------------+ IMFSample +-------------+|\n|  | |IMFMediaStream|----------\x3e|IMFTransform|----------\x3e|IMFStreamSink|+\n|  v +--------------+           +------------+           +-------------+\n| +--------------+              +------------+           +-------------+\n| |IMFMediaStream|-------------\x3e|IMFTransform|----------\x3e|IMFStreamSink|+\n| +--------------+  IMFSample   +------------+ IMFSample +-------------+|\n+---------------+   (compressed)           (uncompressed)  |IMFMediaSink|\n+------------+\nAudioRendrer"),"\n",l.createElement(n.p,null,"TopoEdit"),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation/topoedit"},"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation/topoedit"),"\n",l.createElement(n.a,{href:"http://blogs.microsoft.co.il/pavely/2011/03/11/introduction-to-topoedit/"},"http://blogs.microsoft.co.il/pavely/2011/03/11/introduction-to-topoedit/")),"\n",l.createElement(n.p,null,"いろんなAPI\nMediaSource(入力)とMediaSink(出力)を駆動する高レベルのAPIが複数ある。\n[Obsolete]古のPlayer"),"\n",l.createElement(n.p,null,"IMFPMediaPlayer"),"\n",l.createElement(n.p,null,"Important  Deprecated. This API may be removed from future releases of Windows. Applications should use the Media Session for playback."),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://github.com/Microsoft/Windows-classic-samples/blob/master/Samples/Win7Samples/multimedia/mediafoundation/SimplePlay"},"https://github.com/Microsoft/Windows-classic-samples/blob/master/Samples/Win7Samples/multimedia/mediafoundation/SimplePlay"),"\n",l.createElement(n.a,{href:"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation/MFPlayer2"},"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation/MFPlayer2")),"\n",l.createElement(n.p,null,"[Desktop]再生向けのSession\nPlayer向けのAPI。UWPには無い。"),"\n",l.createElement(n.p,null,"Media Session\n",l.createElement(n.a,{href:"http://blog.firefly-vj.net/2009/06/01/mediafoundation-play-with-mediasession.html"},"http://blog.firefly-vj.net/2009/06/01/mediafoundation-play-with-mediasession.html"),"\nMedia Foundationの再生サンプルの状態管理をMSMで行う"),"\n",l.createElement(n.p,null,"Topology"),"\n",l.createElement(n.p,null,"Topologies"),"\n",l.createElement(n.p,null,"変換向けのReader\nClockが必要ない用途に向いている。\n各フレームを最速で処理したい場合や、MediaSourceがWebCamである場合など。"),"\n",l.createElement(n.p,null,"Source Reader\nUsing the Source Reader to Process Media Data\nThe Source Reader does not support reverse playback, even if the media source does.\nMediaFoundationでID3D11Texture2Dに動画のフレームを読み込む 覚書β\nMediaFoundation — 動画の読み込み"),"\n",l.createElement(n.p,null,"[Desktop][UWP]WinRTのEngine\nWindows.Mediaのバックエンド？。UWPとDesktopの両方で使える。"),"\n",l.createElement(n.p,null,"Supported Microsoft Media Foundation APIs for Windows Phone 8\nWalkthrough: Using Microsoft Media Foundation for Windows Phone 8"),"\n",l.createElement(n.p,null,"using a MediaElement control is a much quicker and easier way\nYou also must use MF if you want to use video as a texture on 3-D geometry"),"\n",l.createElement(n.p,null,"DXVAが簡単にできる。むしろUWPではDXVAしかない様子。情報少ないけど。"),"\n",l.createElement(n.p,null,"Media engine native C++ video playback sample"),"\n",l.createElement(n.p,null,"MediaSource"),"\n",l.createElement(n.p,null,"Media Sources"),"\n",l.createElement(n.p,null,"Writing a Custom Media Source\nCase Study: MPEG-1 Media Source"),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation/mpeg1source"},"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation/mpeg1source"),"\n",l.createElement(n.a,{href:"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation/wavsource"},"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation/wavsource")),"\n",l.createElement(n.p,null,"Source Resolver"),"\n",l.createElement(n.p,null,"Using the Source Resolver"),"\n",l.createElement(n.p,null,"URL"),"\n",l.createElement(n.p,null,"IMFSourceResolver::CreateObjectFromURL"),"\n",l.createElement(n.p,null,"ByteStream"),"\n",l.createElement(n.p,null,"IMFSourceResolver::CreateObjectFromByteStream"),"\n",l.createElement(n.p,null,"ByteStreamを自作する\nMP3 File Source"),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://msdn.microsoft.com/en-us/library/windows/desktop/ff685299(v=vs.85).aspx"},"https://msdn.microsoft.com/en-us/library/windows/desktop/ff685299(v=vs.85).aspx")),"\n",l.createElement(n.p,null,"MPEG-4 File Source"),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://msdn.microsoft.com/en-us/library/windows/desktop/dd757766(v=vs.85).aspx"},"https://msdn.microsoft.com/en-us/library/windows/desktop/dd757766(v=vs.85).aspx")),"\n",l.createElement(n.p,null,"MediaSink"),"\n",l.createElement(n.p,null,"Media Sinks"),"\n",l.createElement(n.p,null,"EVR"),"\n",l.createElement(n.p,null,"Enhanced Video Renderer\nMediaSink\nHWNDを渡してWindowに描画させることが出来る。\nPresenterを自作して描画をカスタマイズできる。\nD3D9 ?\nEVR カスタムプレゼンタを実装する"),"\n",l.createElement(n.p,null,"SAR"),"\n",l.createElement(n.p,null,"Streaming Audio Renderer"),"\n",l.createElement(n.p,null,"AudioSink自作"),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation/wavsink"},"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/Win7Samples/multimedia/mediafoundation/wavsink")),"\n",l.createElement(n.p,null,"VideoSink自作"),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/DX11VideoRenderer"},"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/DX11VideoRenderer")),"\n",l.createElement(n.p,null,"Playbackに対応した自前描画を作るには。"),"\n",l.createElement(n.p,null,"MediaSinkを自作する\nMediaSinkでDXVAを使う"),"\n",l.createElement(n.p,null,"SampleGrabberSink"),"\n",l.createElement(n.p,null,"MFCreateSampleGrabberSinkActivate"),"\n",l.createElement(n.p,null,"MediaTransform"),"\n",l.createElement(n.p,null,"Media Foundation Transforms"),"\n",l.createElement(n.p,null,"About MFTs"),"\n",l.createElement(n.p,null,"Comparison of MFTs and DMOs"),"\n",l.createElement(n.p,null,"H.264"),"\n",l.createElement(n.p,null,"H.264 Video Decoder"),"\n",l.createElement(n.p,null,"DXVA\nDirectX Video Acceleration。"),"\n",l.createElement(n.p,null,"About DXVA 2.0\nAdding a Decoder to a Topology"),"\n",l.createElement(n.p,null,"MR_VIDEO_ACCELERATION_SERVICE\nD3d9"),"\n",l.createElement(n.p,null,"Supporting DXVA 2.0 in Media Foundation\nDXVA Video Processing\nIDirect3DDeviceManager9"),"\n",l.createElement(n.p,null,"D3D11"),"\n",l.createElement(n.p,null,l.createElement(n.a,{href:"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/DX11VideoRenderer"},"https://github.com/Microsoft/Windows-classic-samples/tree/master/Samples/DX11VideoRenderer"),"\nSupporting Direct3D 11 Video Decoding in Media Foundation\nIMFDXGIDeviceManager"),"\n",l.createElement(n.p,null,"Sample & Buffer\nSampleの中にBufferが入っている。"),"\n",l.createElement(n.p,null,"Media Samples"),"\n",l.createElement(n.p,null,"Video Samples"),"\n",l.createElement(n.p,null,"Media Buffers\n",l.createElement(n.a,{href:"https://github.com/loskutov/VideoCapture/blob/master/src/DesktopDuplicationSampleProvider.cpp"},"https://github.com/loskutov/VideoCapture/blob/master/src/DesktopDuplicationSampleProvider.cpp")),"\n",l.createElement(n.p,null,"MediaType"),"\n",l.createElement(n.p,null,"Media Types"),"\n",l.createElement(n.p,null,"Presentation Clock"),"\n",l.createElement(n.p,null,"Presentation Clock"),"\n",l.createElement(n.p,null,"Media Event"),"\n",l.createElement(n.p,null,"Media Event Generators"),"\n",l.createElement(n.p,null,"linkするライブラリ\n関数はドキュメントでわかるが定数はどれに入っているかわからない。\nわりと総当たりで試すはめになる。"),"\n",l.createElement(n.p,null,"mf.lib\nmfplat.lib\nmfuuid.lib\nstrmiids.lib\nwmcodecdspuuid.lib"),"\n",l.createElement(n.p,null,"参考"),"\n",l.createElement(n.p,null,"Media Foundation Programming Guide"))}var r=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?l.createElement(n,e,l.createElement(i,e)):i(e)},o=t(8678),s=t(1883),m=t(8838);const c={code:e=>{let{children:n,className:t}=e;return t?l.createElement(m.Z,{className:t},n):l.createElement("code",null,n)}};function p(e){let{data:n,children:t}=e;const i=n.mdx.frontmatter;return l.createElement(o.Z,null,l.createElement("h1",null,i.title),l.createElement("div",{className:"tags-index"},i.tags&&i.tags.length>0&&i.tags.map((e=>l.createElement(s.rU,{to:"/tags/"+e+"/",itemProp:"url"},l.createElement("button",null,e))))),l.createElement(a.Zo,{components:c},t))}function u(e){return l.createElement(p,e,l.createElement(r,e))}}}]);
//# sourceMappingURL=component---src-templates-post-template-js-content-file-path-home-runner-work-ousttrue-github-io-ousttrue-github-io-content-posts-2017-08-media-foundation-md-8faac9693d8ccf361c22.js.map