<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>三次元日誌 (sphinxについての記事)</title><link>https://ousttrue.github.io/</link><description></description><atom:link href="https://ousttrue.github.io/categories/sphinx.xml" rel="self" type="application/rss+xml"></atom:link><language>ja</language><copyright>Contents © 2022 &lt;a href="mailto:ousttrue@gmail.com"&gt;ousttrue&lt;/a&gt; </copyright><lastBuildDate>Sat, 14 May 2022 17:17:08 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>SSGをABlogに変更</title><link>https://ousttrue.github.io/posts/2021/winter/ablog/</link><dc:creator>ousttrue</dc:creator><description>&lt;h2&gt;ABlog にシステムを変更&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://getnikola.com/"&gt;nikola&lt;/a&gt; は使いこなせなくて短命に終わってしまった。
&lt;a href="https://pydoit.org/"&gt;doit&lt;/a&gt; は面白いと思うのだが。&lt;/p&gt;
&lt;p&gt;ということで、 &lt;code&gt;sphinx&lt;/code&gt; プラグインの &lt;a href="https://ablog.readthedocs.io/en/latest/"&gt;ABlog&lt;/a&gt; です。&lt;/p&gt;
&lt;h3&gt;はまり1: Sphinx のキャッシュ&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;python -m sphinx content build&lt;/code&gt; にデバッガをアタッチして試行錯誤するのだけど、
キャッシュされて処理されなかった。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;python -m sphinx content build -E -v&lt;/code&gt; とする。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;-E: 全処理(キャッシュを使わない)&lt;/li&gt;
&lt;li&gt;-v: 詳細メッセージ&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;はまり2: ablog が timezone の有無で日付の比較に失敗する&lt;/h3&gt;
&lt;pre class="code literal-block"&gt;can't compare offset-naive and offset-aware datetimes
&lt;/pre&gt;
&lt;p&gt;これは、既存記事の &lt;code&gt;frontmatter&lt;/code&gt; の日付に &lt;code&gt;timezone&lt;/code&gt; が付いていると
日付の比較に失敗する。&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="c1"&gt;# site-packages/ablog/blog.py:382&lt;/span&gt;
&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tzinfo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;と対処した。&lt;/p&gt;
&lt;h3&gt;はまり3: myst-parser の toml frontmatter 対応&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;myst-parser&lt;/code&gt; が &lt;code&gt;---&lt;/code&gt; による &lt;code&gt;yaml&lt;/code&gt; 形式の &lt;code&gt;frontmatter&lt;/code&gt; にしか対応していない様子。
&lt;a href="https://gohugo.io/content-management/front-matter/"&gt;hugo の frontmatter&lt;/a&gt; にある &lt;code&gt;toml&lt;/code&gt; 様式に対応するべく改造したい。&lt;/p&gt;
&lt;h4&gt;切り出し&lt;/h4&gt;
&lt;p&gt;どこで処理しているのか探索が難航した。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;site-packages/mdit_py_plugins/front_matter/index.py&lt;/code&gt;
で処理している。&lt;/p&gt;
&lt;h4&gt;Parse&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;site-packages/myst_parser/docutils_renderer.py&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;render_front_matter&lt;/code&gt; で切り出した文字列を &lt;code&gt;yaml&lt;/code&gt; でパースしている。
&lt;code&gt;except&lt;/code&gt; 節で &lt;code&gt;toml&lt;/code&gt; にリトライさせたら動いた。&lt;/p&gt;
&lt;h3&gt;モンキーパッチ&lt;/h3&gt;
&lt;p&gt;とりあえず &lt;code&gt;conf.py&lt;/code&gt; にて直接修正する。&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/ousttrue/ousttrue.github.io/blob/ablog/content/patch.py"&gt;https://github.com/ousttrue/ousttrue.github.io/blob/ablog/content/patch.py&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;後で PR 送ったりできるかな。&lt;/p&gt;
&lt;h3&gt;ABlog は何をしているのか&lt;/h3&gt;
&lt;h4&gt;toctree無しのpost記事&lt;/h4&gt;
&lt;p&gt;特定の条件で、記事をブログ記事と見做して &lt;code&gt;toctree&lt;/code&gt; 無しで辿れるようにする。
記事は、日付やタグでグループ化してくれる。&lt;/p&gt;
&lt;p&gt;&lt;a href="https://ablog.readthedocs.io/en/latest/manual/posting-and-listing/#posting-with-page-front-matter"&gt;https://ablog.readthedocs.io/en/latest/manual/posting-and-listing/#posting-with-page-front-matter&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;パス指定。&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="n"&gt;blog_post_pattern&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"posts/**/*.md"&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;条件。&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="c1"&gt;# .venv/lib/python3.9/site-packages/ablog/post.py&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s2"&gt;"blogpost"&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;metadata&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;docname&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;matched_blog_posts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;frontmatter&lt;/code&gt; 等から最低限、日付の情報がとれないとトップページから辿る方法が無い状態になる。&lt;/p&gt;
&lt;p&gt;あと &lt;code&gt;sphinx&lt;/code&gt; なのでトップレベルの表題が本文側に必要かも。
&lt;code&gt;frontmatter&lt;/code&gt; の &lt;code&gt;title&lt;/code&gt; を反映できると便利そう。&lt;/p&gt;
&lt;h4&gt;event: 'doctree-read'&lt;/h4&gt;
&lt;p&gt;doctree から &lt;code&gt;PostNode&lt;/code&gt; を集める。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;alog/post#process_posts(app, doctree)&lt;/code&gt;&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;process_posts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;doctree&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;post_nodes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;doctree&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;traverse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PostNode&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;post_nodes&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;# PostNode が必要&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt;

    &lt;span class="c1"&gt;# 省略&lt;/span&gt;

    &lt;span class="n"&gt;postinfo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s2"&gt;"docname"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;docname&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;"section"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;section_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;"order"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;order&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;"update"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;update_dates&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
        &lt;span class="s2"&gt;"title"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;"excerpt"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;excerpt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;"tags"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"tags"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="s2"&gt;"author"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"author"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="s2"&gt;"category"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"category"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="s2"&gt;"location"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"location"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="s2"&gt;"language"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"language"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="s2"&gt;"redirect"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"redirect"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="s2"&gt;"nocomments"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"nocomments"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="s2"&gt;"image"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"image"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="s2"&gt;"exclude"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;node&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"exclude"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="s2"&gt;"doctree"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;section_copy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;docname&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ablog_posts&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ablog_posts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;docname&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;env&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ablog_posts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;docname&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;postinfo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CheckFrontMatter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SphinxTransform&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_transform&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;CheckFrontMatter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;    
&lt;/pre&gt;
&lt;h4&gt;追加のページ生成&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;ablog/templates&lt;/code&gt; に格納されている。&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="c1"&gt;# -- ABlog Sidebars -------------------------------------------------------&lt;/span&gt;

&lt;span class="c1"&gt;# There are seven sidebars you can include in your HTML output.&lt;/span&gt;
&lt;span class="c1"&gt;# postcard.html provides information regarding the current post.&lt;/span&gt;
&lt;span class="c1"&gt;# recentposts.html lists most recent five posts. Others provide&lt;/span&gt;
&lt;span class="c1"&gt;# a link to a archive pages generated for each tag, category, and year.&lt;/span&gt;
&lt;span class="c1"&gt;# In addition, there are authors.html, languages.html, and locations.html&lt;/span&gt;
&lt;span class="c1"&gt;# sidebars that link to author and location archive pages.&lt;/span&gt;
&lt;span class="n"&gt;html_sidebars&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;'**'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="s1"&gt;'about.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;'postcard.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;'navigation.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;'recentposts.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;'tagcloud.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;'categories.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;'archives.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;'searchbox.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;],&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;これらに対して追加のページ生成を行っている。
&lt;code&gt;genindex.html&lt;/code&gt; などのように。&lt;/p&gt;
&lt;h3&gt;ToDo&lt;/h3&gt;
&lt;h4&gt;✅ タグが変&lt;/h4&gt;
&lt;p&gt;toml 由来の tag の処理に失敗している。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;["python", "ssg", "sphinx"]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;が、&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;["python"&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;"ssg"&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;"sphinx"]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;になっちゃってる。&lt;/p&gt;
&lt;p&gt;https://github.com/sunpy/ablog/pull/119&lt;/p&gt;
&lt;p&gt;送ってみた。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;v0.10.22&lt;/code&gt; で修正。👍&lt;/p&gt;
&lt;h4&gt;✅ 日付のフォーマット&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;conf.py&lt;/code&gt;&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="n"&gt;post_date_format&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;'%Y/%m/&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;
&lt;span class="n"&gt;post_date_format_short&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;'%Y/%m'&lt;/span&gt;
&lt;/pre&gt;
&lt;h4&gt;✅ 記事のURL&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://zenn.dev/attakei/articles/sphinx-make-dirhtml"&gt;https://zenn.dev/attakei/articles/sphinx-make-dirhtml&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;✅ 記事タイトルは最初の見出しではなく、frontmatter の title にしたい&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;MystParser&lt;/code&gt; を改造した。
わりと Sphinx わかってきた。
&lt;code&gt;python&lt;/code&gt; でデバッガがアタッチできるとなんでもできる(慣れ)。&lt;/p&gt;
&lt;h4&gt;[ ] tagの表記振れ&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;c++&lt;/code&gt; と &lt;code&gt;C++&lt;/code&gt;、&lt;code&gt;c#&lt;/code&gt; と &lt;code&gt;csharp&lt;/code&gt; などをたばねる。&lt;/p&gt;
&lt;h3&gt;参考&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://water2litter.net/pisco/doc/ablog.html"&gt;Sphinxでブログをしてみよう&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description><category>python</category><category>sphinx</category><category>ssg</category><guid>https://ousttrue.github.io/posts/2021/winter/ablog/</guid><pubDate>Sun, 19 Dec 2021 15:00:00 GMT</pubDate></item><item><title>sphinx + MyST よいのでは</title><link>https://ousttrue.github.io/posts/2021/fall/sphinx_myst/</link><dc:creator>ousttrue</dc:creator><description>&lt;p&gt;Gizmo を作る過程で GeometryShader からやりなおしていたら、記憶が飛んでいたので
忘れてもいいように記録しておくことにした。&lt;/p&gt;
&lt;p&gt;旧 &lt;code&gt;MinTriangle&lt;/code&gt; リポジトリを作り直し。&lt;/p&gt;
&lt;p&gt;&lt;a href="http://ousttrue.github.io/d3d11_samples/"&gt;http://ousttrue.github.io/d3d11_samples/&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;MyST なかなかよい&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;reStructuredText&lt;/code&gt; わりと苦手なので &lt;code&gt;sphinx&lt;/code&gt; でも Markdown を使いたい派なのだが、
&lt;a href="https://myst-parser.readthedocs.io/en/latest/index.html"&gt;MyST&lt;/a&gt; なる Sphinx 向け markdown 拡張ができていた。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://qiita.com/Tachy_Pochy/items/53866eea43d0ad93ea1d"&gt;Sphinx で使える Markdown 方言 'MyST'&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;sphinx directive の指定の仕方がシンプルで下のような感じ。markdown のシンタックスハイライトやフォーマッターに乗れるのでよい。&lt;/p&gt;
&lt;pre&gt;
```{image} ./basic_pipeline.jpg
:width: 320px
:height: 320px

&lt;pre class="code literal-block"&gt;```{toctree}
basic/create_window
basic/create_device
basic/create_swapchain
basic/render_target
basic/compile_shader
basic/basic_pipeline
&lt;/pre&gt;

&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;sphinx-autobuild&lt;/code&gt; と github-actions による &lt;code&gt;gh-pages&lt;/code&gt; デプロイを仕込んだらかなりよくなった。&lt;/p&gt;
&lt;h2&gt;memo&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/wpilibsuite/sphinxext-remoteliteralinclude"&gt;https://github.com/wpilibsuite/sphinxext-remoteliteralinclude&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;git の revision と path 指定して include できないかしら。
サンプルコードにちょこちょこっと解説を書きたいのだが、サンプルコードが進化する場合に &lt;code&gt;literalinclude&lt;/code&gt; だと場所がずれるのだ。&lt;/p&gt;</description><category>sphinx</category><category>ssg</category><guid>https://ousttrue.github.io/posts/2021/fall/sphinx_myst/</guid><pubDate>Fri, 10 Sep 2021 15:00:00 GMT</pubDate></item></channel></rss>