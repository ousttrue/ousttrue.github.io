<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>三次元日誌 (clangについての記事)</title><link>https://ousttrue.github.io/</link><description></description><atom:link href="https://ousttrue.github.io/categories/clang.xml" rel="self" type="application/rss+xml"></atom:link><language>ja</language><copyright>Contents © 2022 &lt;a href="mailto:ousttrue@gmail.com"&gt;ousttrue&lt;/a&gt; </copyright><lastBuildDate>Sat, 24 Sep 2022 18:10:56 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>pythonモジュール clang で C++ ヘッダーを変換する</title><link>https://ousttrue.github.io/posts/2019/python_clang/</link><dc:creator>ousttrue</dc:creator><description>&lt;p&gt;&lt;code&gt;d3d11.h&lt;/code&gt; を &lt;code&gt;d3d11.d&lt;/code&gt; に変換したいのでやる。&lt;/p&gt;
&lt;p&gt;以前、少し手を出したときの記事。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://qiita.com/ousttrue/items/a4291fc996a063841bd7"&gt;D言語でD3D11してみる&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://qiita.com/ousttrue/items/26b399a691b5610d2678"&gt;D言語でComPtr&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;この時は手作業で &lt;code&gt;d3d11.h&lt;/code&gt; をD言語向けに編集していたのだけど、
プログラムで自動変換します。&lt;/p&gt;
&lt;h3&gt;環境整備&lt;/h3&gt;
&lt;p&gt;Windows10(64bit)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;llvmインストール(32bit)&lt;/li&gt;
&lt;li&gt;python36-32&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pip install clang&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;TranslationUnit&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;typedef&lt;/li&gt;
&lt;li&gt;enum&lt;/li&gt;
&lt;li&gt;struct/union&lt;/li&gt;
&lt;li&gt;function&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;プリプロセッサー情報を得る&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;include&lt;/li&gt;
&lt;li&gt;define&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ComのIIDを得る&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;unexposed&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;D向けに出力&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;extern &lt;code&gt;Windows&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;public import&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;amp;&lt;/code&gt; を &lt;code&gt;*&lt;/code&gt; に置換&lt;/li&gt;
&lt;li&gt;interfaceに対するポインタの &lt;code&gt;*&lt;/code&gt;をひとつ減らす&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;あとは愚直に粛々と前に進める&lt;/p&gt;
&lt;h3&gt;python clang は強力&lt;/h3&gt;
&lt;p&gt;こいつがあると、C/C++のヘッダから各言語向けのバインディングを作成するなどの作業を半自動化できて便利。
例えば、&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/ousttrue/UnityCairo"&gt;https://github.com/ousttrue/UnityCairo&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;元々、&lt;/p&gt;
&lt;p&gt;&lt;a href="http://andrestraks.github.io/BulletSharp/"&gt;http://andrestraks.github.io/BulletSharp/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;が clang で bullet のヘッダーを変換しているぽかったので、そこから調べた。&lt;/p&gt;
&lt;h3&gt;できたもの&lt;/h3&gt;
&lt;p&gt;なんとなく動くものができた。&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/ousttrue/pycpptool"&gt;https://github.com/ousttrue/pycpptool&lt;/a&gt;&lt;/p&gt;</description><category>clang</category><category>com</category><category>cpp</category><category>dlang</category><category>python</category><guid>https://ousttrue.github.io/posts/2019/python_clang/</guid><pubDate>Wed, 17 Apr 2019 22:10:34 GMT</pubDate></item></channel></rss>