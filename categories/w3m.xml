<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>ä¸‰æ¬¡å…ƒæ—¥èªŒ (w3mã«ã¤ã„ã¦ã®è¨˜äº‹)</title><link>https://ousttrue.github.io/</link><description></description><atom:link href="https://ousttrue.github.io/categories/w3m.xml" rel="self" type="application/rss+xml"></atom:link><language>ja</language><copyright>Contents Â© 2022 &lt;a href="mailto:ousttrue@gmail.com"&gt;ousttrue&lt;/a&gt; </copyright><lastBuildDate>Sat, 14 May 2022 17:22:20 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>w3mæ”¹é€ </title><link>https://ousttrue.github.io/posts/2020/w3m-mod/</link><dc:creator>ousttrue</dc:creator><description>&lt;p&gt;ä»¥å‰ã«ã‚‚ä½•åº¦ã‹ã‚„ã£ãŸã“ã¨ãŒã‚ã‚‹ã®ã ã‘ã©ç«‹ã¡æ¶ˆãˆã«ãªã£ã¦ã„ãŸã€ &lt;a href="http://w3m.sourceforge.net/index.ja.html"&gt;w3m&lt;/a&gt; ã®æ”¹é€ ã‚’è©¦ã¿ã¦ã„ã‚‹ã€‚
w3m ã¯ã‚ã‚Šã¨å¥½ããªãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ©ã‚¦ã‚¶ãªã®ã ãŒã€ 2011 å¹´ãã‚‰ã„ã® 0.5.3 ã§é–‹ç™ºãŒçµ‚äº†ã—ã¦ã„ã‚‹æ§˜å­ã€‚&lt;/p&gt;
&lt;p&gt;https://github.com/ousttrue/w3m&lt;/p&gt;
&lt;p&gt;ã¾ãšã¯ &lt;code&gt;C++&lt;/code&gt; åŒ–ã—ã¦ã‹ã‚‰ã€HTMLå‡¦ç†ãªã©ã‚’å†å…¥å¯èƒ½ã«ã—ã¦ã‚¿ãƒ–ã”ã¨ã«ã‚¹ãƒ¬ãƒƒãƒ‰ç‹¬ç«‹ã™ã‚‹æ–¹å‘ã‚’ç›®æŒ‡ã™ã€‚
åŒæ™‚ã«ã€ &lt;code&gt;boehm-GC&lt;/code&gt; ã‚’å°‘ã—ãšã¤ &lt;code&gt;STL&lt;/code&gt; ã®ã‚³ãƒ³ãƒ†ãƒŠã‚„ &lt;code&gt;std::string&lt;/code&gt; ã«ç½®ãæ›ãˆã‚‹ã€‚
ã©ã†ã‚‚ã€&lt;code&gt;c++&lt;/code&gt; ã¨ &lt;code&gt;boehm-GC&lt;/code&gt; ã®å…±å­˜ã™ã‚‹ã®ã«æŠ€ãŒã„ã‚‹ã‚‰ã—ãã€é©å½“ã«ç½®ãæ›ãˆã¦ã„ãã¨ãƒ¡ãƒ¢ãƒªç ´å£Šã§æ­»ã¬ã€‚&lt;code&gt;boehm-GC&lt;/code&gt; ã‚’ã™ã¹ã¦ç½®ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã€‚&lt;code&gt;C++&lt;/code&gt; ã‚¯ãƒ©ã‚¹ã®ãƒ¡ãƒ³ãƒãƒ¼ã« &lt;code&gt;GC&lt;/code&gt; ãŒè¦ã‚‹ã€&lt;code&gt;GC struct&lt;/code&gt; ã®ãƒ¡ãƒ³ãƒãƒ¼ã« &lt;code&gt;C++&lt;/code&gt; ã‚¯ãƒ©ã‚¹ãŒå±…ã‚‹ã®ä¸¡æ–¹ã«å•é¡ŒãŒã‚ã‚‹ã£ã½ã„ã€‚ä¸€å¿œã€ &lt;code&gt;gc_cleanup&lt;/code&gt; ã‚’ç¶™æ‰¿ã—ãŸã‚Šã—ã¦ã„ã‚‹ã®ã ã‘ã©ã€ã‚„ã‚Šæ–¹ãŒã¾ãšã„ã½ã„ã€‚&lt;/p&gt;
&lt;p&gt;æ”¹é€ ã«ã‚ãŸã£ã¦ãªã‚‹ã¹ãæ©Ÿèƒ½ã‚’ç¶­æŒã—ã‚ˆã†ã¨ã—ã¦ã„ãŸã®ã ã‘ã©ã€ã‚ã‚‹ç¨‹åº¦ã‚ã‚Šãã£ã¦æ©Ÿèƒ½ã‚’è½ã¨ã•ãªã„ã¨æ‰‹ã«è² ãˆãªã„ã¨ã“ã‚ãŒã‚ã‚‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;http + https ä»¥å¤–ã®é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯è½ã¨ã™ã€‚NNTP ã¨ã‹ Gopher ä½¿ã£ãŸã“ã¨ãªã„ã—ãªãƒ¼ã€FTPã‚‚ã„ã£ãŸã‚“è½ã¨ã™&lt;/li&gt;
&lt;li&gt;backend, dump, halfload ç­‰ã®å‡ºåŠ›ã«ä»‹å…¥ã™ã‚‹æ©Ÿèƒ½ã¯è½ã¨ã™ã€‚ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚€ã®ãŒå¤§å¤‰&lt;/li&gt;
&lt;li&gt;M17N, COLOR, IMAGE, MENU ã¯æ®‹ã™&lt;/li&gt;
&lt;li&gt;Mouse ã¯å¾®å¦™ã€‚å‰Šã£ã¦ã‚‚ã‚ˆã„ã‹ã‚‚&lt;/li&gt;
&lt;li&gt;GetText ã‚‚å‰Šã‚‹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é‡ã‚’æ¸›ã‚‰ã™ã€‚æ€ã£ãŸã‚ˆã‚Šã‚³ãƒ¼ãƒ‰ãŒå¤šã‹ã£ãŸã®ã ã€‚&lt;/p&gt;
&lt;h2&gt;ä¸‹æº–å‚™&lt;/h2&gt;
&lt;h3&gt;msys2 ã§ã¨ã‚Šã‚ãˆãšãƒ“ãƒ«ãƒ‰&lt;/h3&gt;
&lt;p&gt;WSL Ubuntu ã ã¨ãƒ“ãƒ«ãƒ‰ã§ããªã‹ã£ãŸã€‚
ã—ã‹ã—ã€msys2 ãªã‚‰ã‚ã‚Šã¨ç°¡å˜ã«ãƒ“ãƒ«ãƒ‰ã§ãã‚‹ã“ã¨ã‚’ç™ºè¦‹ã€‚&lt;/p&gt;
&lt;pre class="code literal-block"&gt;$ pacman -S make gcc libgc-devel openssl-devel ncurses-devel
$ x86_64-pc-msys-gcc --version
x86_64-pc-msys-gcc &lt;span class="o"&gt;(&lt;/span&gt;GCC&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="m"&gt;9&lt;/span&gt;.3.0
Copyright &lt;span class="o"&gt;(&lt;/span&gt;C&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="m"&gt;2019&lt;/span&gt; Free Software Foundation, Inc.
This is free software&lt;span class="p"&gt;;&lt;/span&gt; see the &lt;span class="nb"&gt;source&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; copying conditions.  There is NO
warranty&lt;span class="p"&gt;;&lt;/span&gt; not even &lt;span class="k"&gt;for&lt;/span&gt; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
$ ./configure
&lt;/pre&gt;
&lt;p&gt;ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ç’°å¢ƒã®æ–¹ãŒæ˜”ã¨å¤‰ã‚ã£ã¦ã—ã¾ã£ã¦ãƒ“ãƒ«ãƒ‰ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ­£æ–¹æ³•ğŸ‘‡&lt;/p&gt;
&lt;p&gt;&lt;a href="https://qiita.com/imkitchen/items/02a9df7baaaf434fee66"&gt;[CentOS7] emacs24ã«emacs-w3mã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;#ifdef&lt;/code&gt; ã®èª¿æ•´&lt;/p&gt;
&lt;pre class="code literal-block"&gt;// config.h
//#define USE_BINMODE_STREAM 1
//#define USE_EGD
&lt;/pre&gt;
&lt;pre class="code literal-block"&gt;$ make
$ ./w3m www.google.com // å‹•ã„ãŸ
&lt;/pre&gt;
&lt;h3&gt;WSL ã§ GC ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹å•é¡Œ&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;boehm-GC&lt;/code&gt; ãŒãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã“ã¨ã§ã€ &lt;code&gt;make&lt;/code&gt; ä¸­ã®ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ &lt;code&gt;mktable&lt;/code&gt; ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã®ãŒåŸå› ã§ãƒ“ãƒ«ãƒ‰ã‚¹ãƒ†ãƒƒãƒ—ãŒé€”ä¸­ã§æ­¢ã¾ã‚‹ã®ãŒåŸå› ã ã£ãŸã€‚ãªã®ã§ã€ãŸã¨ãˆãƒ“ãƒ«ãƒ‰æ¸ˆã¿ã® &lt;code&gt;w3m&lt;/code&gt; ã‚’ &lt;code&gt;apt get&lt;/code&gt; ã—ã¦ã‚‚ã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚‚åŒã˜åŸå› ã§ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã€‚&lt;/p&gt;
&lt;p&gt;ã‚¨ãƒ©ãƒ¼ã€‚&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="n"&gt;Wrong&lt;/span&gt; &lt;span class="n"&gt;__data_start&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;_end&lt;/span&gt; &lt;span class="n"&gt;pair&lt;/span&gt;
&lt;span class="n"&gt;fish&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'./build/w3m'&lt;/span&gt; &lt;span class="n"&gt;terminated&lt;/span&gt; &lt;span class="n"&gt;by&lt;/span&gt; &lt;span class="k"&gt;signal&lt;/span&gt; &lt;span class="n"&gt;SIGABRT&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Abort&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;https://hitkey.nekokan.dyndns.info/diary2004.php#D200424&lt;/p&gt;
&lt;p&gt;ã«ã‚ˆã‚‹ã¨ã€stack size ã®åˆ¶é™ãŒåŸå› ã‚‰ã—ã„ã€‚&lt;/p&gt;
&lt;pre class="code literal-block"&gt;$ &lt;span class="nb"&gt;ulimit&lt;/span&gt; -s
&lt;span class="m"&gt;8192&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;WSL ã§ã“ã‚Œã‚’å¤‰ãˆã‚‹ã«ã¯ãƒ»ãƒ»ãƒ»ã€‚&lt;/p&gt;
&lt;p&gt;https://github.com/microsoft/WSL/issues/633&lt;/p&gt;
&lt;p&gt;ç„¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;WSL2&lt;/code&gt; ãªã‚‰ã§ãã‚‹ï¼Ÿ&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&amp;gt; wsl -l -v
  NAME            STATE           VERSION
* Ubuntu-20.04    Running         2
&lt;/pre&gt;
&lt;p&gt;ã‚„ã£ã¦ã¿ã‚‹ã€‚&lt;/p&gt;
&lt;pre class="code literal-block"&gt;$ &lt;span class="nb"&gt;ulimit&lt;/span&gt; -s unlimited
&amp;gt; &lt;span class="nb"&gt;ulimit&lt;/span&gt; -s
unlimited
&lt;/pre&gt;
&lt;p&gt;ã§ããŸã€‚&lt;/p&gt;
&lt;pre class="code literal-block"&gt;$ w3m
Wrong __data_start/_end pair
&lt;/pre&gt;
&lt;p&gt;ã†ãƒ¼ã‚€ã€‚&lt;/p&gt;
&lt;pre class="code literal-block"&gt;$ &lt;span class="nb"&gt;ulimit&lt;/span&gt; -s &lt;span class="m"&gt;81920&lt;/span&gt;
&amp;gt; &lt;span class="nb"&gt;ulimit&lt;/span&gt; -s
&lt;span class="m"&gt;81920&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;å‹•ã„ãŸã€‚
8192KB ã§ã¯è¶³ã‚Šãªãã€ unlimited ã§ã¯å¤šã™ãã‚‹ã‚‰ã—ã„ã€‚ã“ã‚Œã¯ã€é›£ã—ã„ãªã€‚&lt;/p&gt;
&lt;p&gt;ã¡ãªã¿ã«ã€ &lt;code&gt;gdb&lt;/code&gt; ä¸Šãªã‚‰ã‚¹ã‚¿ãƒƒã‚¯å•é¡Œã‚’è§£æ±ºã—ãªãã¦ã‚‚å‹•ã„ãŸã€‚
&lt;code&gt;gdb&lt;/code&gt; ãŒã‚¹ã‚¿ãƒƒã‚¯ã‚’è¦†ã„éš ã™ã®ã‹ãªï¼Ÿ
é–‹ç™ºã ã‘ãªã‚‰ã§ããªãã‚‚ãªã„ã€‚&lt;/p&gt;
&lt;h3&gt;ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ &lt;/h3&gt;
&lt;p&gt;ã¨ã‚Šã‚ãˆãšæ…£ã‚ŒãŸãƒ„ãƒ¼ãƒ«ã«å¤‰æ›´ã€‚
WSL ä¸Šã® vscode ã§ä½œæ¥­ã—ã¦ã„ã‚‹ã®ã‚‚ã‚ã‚Šã€autotools ã‹ã‚‰ CMake ã«å¤‰æ›´ã€‚
ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¯å¾Œé€€ã•ã›ã¦ã€æ–°ã—ã‚ã® gcc(c++20) ã§ãƒ“ãƒ«ãƒ‰ã§ãã‚Œã°ã„ã„ã‚„ã€‚
config.h ã‚„ funcname ç³»ã®ã‚³ãƒ¼ãƒ‰ç”Ÿæˆçµæœã¯ã‚³ãƒŸãƒƒãƒˆã—ã¡ã‚ƒã†ã€‚
libwc ãŒ static ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ã‹ã‚Œã¦ã„ã‚‹ã®ã‚‚ã€ã²ã¨ã¾ã¨ã‚ã«ã—ã¦ã—ã¾ã£ãŸã€‚
ã‚ã¨ã€é©å½“ã«ã‚½ãƒ¼ã‚¹ã‚’ãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•ã™ã‚‹ã€‚&lt;/p&gt;
&lt;p&gt;ç”Ÿæˆã‚³ãƒ¼ãƒ‰ä¸€è¦§&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ãƒ•ã‚¡ã‚¤ãƒ«&lt;/th&gt;
&lt;th&gt;ç”Ÿæˆæ–¹æ³•&lt;/th&gt;
&lt;th&gt;å…¥åŠ›&lt;/th&gt;
&lt;th&gt;å‚™è€ƒ&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;config.h&lt;/td&gt;
&lt;td&gt;configure&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;å„ç¨® #define ãªã©&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;entity.h&lt;/td&gt;
&lt;td&gt;Makefile(mktable)&lt;/td&gt;
&lt;td&gt;entity.tab&lt;/td&gt;
&lt;td&gt;./mktable 100 entity.tab &amp;gt; entity.h&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;funcname.tab&lt;/td&gt;
&lt;td&gt;Makefile(awk)&lt;/td&gt;
&lt;td&gt;main.c, menu.c&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;funcname.c&lt;/td&gt;
&lt;td&gt;Makefile(awk)&lt;/td&gt;
&lt;td&gt;funcname.tab&lt;/td&gt;
&lt;td&gt;sort funcname.tab ï½œ awk -f funcname0.awk &amp;gt; funcname.c&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;funcname1.h&lt;/td&gt;
&lt;td&gt;Makefile(awk)&lt;/td&gt;
&lt;td&gt;funcname.tab&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;funcname2.h&lt;/td&gt;
&lt;td&gt;Makefile(awk)&lt;/td&gt;
&lt;td&gt;funcname.tab&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;functable.c&lt;/td&gt;
&lt;td&gt;Makefile(mktable)&lt;/td&gt;
&lt;td&gt;funcname.tab&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tagtable.c&lt;/td&gt;
&lt;td&gt;Makefile(mktable)&lt;/td&gt;
&lt;td&gt;funcname.tab&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3&gt;è­¦å‘Šã‹ã‚‰ã‚¨ãƒ©ãƒ¼ã«å¼•ãä¸Šã’&lt;/h3&gt;
&lt;p&gt;æ”¹é€ ã—ã¦ã„ãã®ã« &lt;code&gt;C&lt;/code&gt; ã®ç·©ã„å‹åˆ¶é™ãŒå±é™º(ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚‹ã®ã«å‹ãŒä¸ä¸€è‡´ã«ãªã‚Šã‚„ã™ã„)ãªã®ã§ã€
ä»¥ä¸‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã€‚&lt;/p&gt;
&lt;pre class="code literal-block"&gt;-Werror=implicit-function-declaration
-Werror=int-conversion
-Werror=conversion-null
&lt;/pre&gt;
&lt;p&gt;ã“ã‚Œã§ã€å‹å®£è¨€ã‚’è£œå¼·ã—ãªãŒã‚‰é€²ã‚ã‚‹ã€‚&lt;/p&gt;
&lt;h2&gt;ç¬¬1æ®µéš&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;extern "C" ã‚’è¿½åŠ ã—ã¦ã‚½ãƒ¼ã‚¹ã®æ‹¡å¼µå­ã‚’ &lt;code&gt;.cpp&lt;/code&gt; ã«å¤‰æ›´&lt;/li&gt;
&lt;li&gt;extern "C" ã‚’ã¾ã¨ã‚ã¦å–ã‚Šé™¤ã&lt;/li&gt;
&lt;li&gt;typedef struct tag ã‚’å–ã‚Šé™¤ã&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ã“ã“ã¾ã§ã‚„ã‚‹ã¨ã€è‡ªç”±ã« &lt;code&gt;c++&lt;/code&gt; ã®ã‚³ãƒ¼ãƒ‰ã‚’æ··ãœã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
&lt;code&gt;std::string&lt;/code&gt;ã€&lt;code&gt;std::vector&lt;/code&gt;, &lt;code&gt;std::shared_ptr&lt;/code&gt;, &lt;code&gt;std::function&lt;/code&gt;, &lt;code&gt;std::string_view&lt;/code&gt;, &lt;code&gt;template&lt;/code&gt;, &lt;code&gt;class&lt;/code&gt;, å‰æ–¹å®£è¨€, &lt;code&gt;auto&lt;/code&gt;, &lt;code&gt;inline&lt;/code&gt; ç­‰ä½¿ã„æ”¾é¡Œ ğŸ‘&lt;/p&gt;
&lt;p&gt;ç‰¹ã« &lt;code&gt;std::string_view&lt;/code&gt; ã®ä½¿ã„å‹æ‰‹ã‚’è©¦ã—ãŸã„ã€‚
æ‰€æœ‰ã—ãªã„æ–‡å­—åˆ—ã¯ã™ã¹ã¦ã€ &lt;code&gt;std::string_view&lt;/code&gt; ã§ã„ã‘ã‚‹ã¨æ€ã†ã®ã ãŒã€‚
&lt;code&gt;split&lt;/code&gt; ã® &lt;code&gt;std::string_view&lt;/code&gt; ç‰ˆã¯å…·åˆãŒã‚ˆã‹ã£ãŸã€‚&lt;/p&gt;
&lt;h3&gt;c++ åŒ– (extern "C")&lt;/h3&gt;
&lt;p&gt;æ‰‹æ³•ã¨ã—ã¦ã¯ã€å„ã‚½ãƒ¼ã‚¹ã®æ‹¡å¼µå­ã‚’ &lt;code&gt;.c&lt;/code&gt; ã‹ã‚‰ &lt;code&gt;.cpp&lt;/code&gt; ã«å¤‰æ›´ã™ã‚‹ã€‚
&lt;code&gt;CMakeLists.txt&lt;/code&gt; ã‚’ä¿®æ­£ã€‚
&lt;code&gt;#include&lt;/code&gt; ã‚’ &lt;code&gt;extern "C"&lt;/code&gt; ã§å›²ã‚€ã€ã§ &lt;code&gt;c++&lt;/code&gt; åŒ–ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="k"&gt;extern&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"C"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="cpf"&gt;"xxx.h"&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;ãŸã ã€ &lt;code&gt;cpp&lt;/code&gt; ã§å®šç¾©ã™ã‚‹é–¢æ•°ã®å®£è¨€ãŒ &lt;code&gt;extern "C"&lt;/code&gt; ã®ä¸­ã«å…¥ã‚‰ãªã„ã¨ãƒªãƒ³ã‚¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã®ã§ã€
ãã†ãªã‚‹ã‚ˆã†ã«ã‚½ãƒ¼ã‚¹ã”ã¨ã«ãƒ˜ãƒƒãƒ€ã‚’åˆ†é…ã—ã¦ã‚„ã‚‹ã€‚
&lt;code&gt;w3m&lt;/code&gt; ã¯é–¢æ•°å®£è¨€ãŒå°‘æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ« &lt;code&gt;proto.h&lt;/code&gt;, &lt;code&gt;fm.h&lt;/code&gt; ã¨ã‹ã«é›†ä¸­ã—ã¦ã„ã‚‹ã®ã ãŒã€ã„ã£ã±ã„ã‚ã‚‹ã®ã§é›‘ã«ã‚„ã‚‹ã€‚
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚Œã°ã‚ˆã„ã€‚&lt;/p&gt;
&lt;p&gt;åˆ†é…ã™ã‚‹ã¨ãã«æœªå®šç¾©ã®å‹ã‚’å‰æ–¹å®£è¨€ã§ã™ã¾ã›ãŸã„ã®ã ã‘ã©ã€ &lt;code&gt;c&lt;/code&gt; ã® &lt;code&gt;struct&lt;/code&gt; å®šç¾©ãŒã€&lt;code&gt;struct tag&lt;/code&gt; ã¨ &lt;code&gt;typedef&lt;/code&gt; ã«åˆ†ã‹ã‚Œã¦ã„ã‚‹ã®ãŒã‚„ã£ã‹ã„ã ã£ãŸã€‚&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="c1"&gt;// C&lt;/span&gt;
&lt;span class="k"&gt;typedef&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;hogeTag&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Hoge&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;DoHoge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Hoge&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="c1"&gt;// ã«å¯¾ã™ã‚‹å‰æ–¹å®£è¨€ã¯ã€&lt;/span&gt;

&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;hogeTag&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="k"&gt;typedef&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;hogeTag&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Hoge&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;C&lt;/code&gt; ã®çŠ¶æ…‹ã§ã€å‰æ–¹å®£è¨€ã‚’å°å…¥ã§ããšãƒ˜ãƒƒãƒ€ã®åˆ†å‰²ãŒé›£èˆªã€‚
å‹ã”ã¨ã«åˆ¥ã®ãƒ˜ãƒƒãƒ€ã«åˆ†å‰²ã™ã‚‹ã“ã¨ã¯æ–­å¿µã—ã¦ã€
ã»ã¨ã‚“ã©å…¨éƒ¨ã® &lt;code&gt;struct&lt;/code&gt; å®šç¾©ã®å…¥ã£ãŸãƒ˜ãƒƒãƒ€ã‚’ &lt;code&gt;fm.h&lt;/code&gt; ã‹ã‚‰åˆ†é›¢ã—ã¦ä½œã‚‹ã®ã«ç•™ã‚ãŸã€‚&lt;/p&gt;
&lt;h3&gt;DEFUN&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;w3m&lt;/code&gt; ã¯ &lt;code&gt;DEFUN&lt;/code&gt; ã§ã‚­ãƒ¼ã‚¢ã‚µã‚¤ãƒ³ã§ãã‚‹é–¢æ•°ã‚’å®šç¾©ã—ã¦ã„ã‚‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="https://ousttrue.github.io/w3m/doc-jp/readme.func/"&gt;readme.func&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹ã®ã‚ˆã†ã«ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãªã©ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã„ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ã€‚&lt;/p&gt;
&lt;pre class="code literal-block"&gt;Key
    KeyMap
        DEFUN
    Menu
        DEFUN
MouseAction
    ActionMap
        DEFUN
    Menu
        DEFUN
Alarm
    DEFUN
&lt;/pre&gt;
&lt;p&gt;ã‚½ãƒ¼ã‚¹ã¯ã€&lt;code&gt;main.c&lt;/code&gt; ã¨ &lt;code&gt;menu.c&lt;/code&gt; ã« &lt;code&gt;DEFUN&lt;/code&gt; ã¨ãã‚Œã®ä½¿ã†è£œåŠ©é–¢æ•°ãŒã¾ã¨ã‚ã¦å®šç¾©ã•ã‚Œã¦ã„ã¦ã€
ãƒ˜ãƒƒãƒ€ã¯ &lt;code&gt;proto.h&lt;/code&gt; ã«å…¨éƒ¨å…¥ã‚Œã¨ãªã£ã¦ã„ã‚‹ã€‚&lt;/p&gt;
&lt;p&gt;c++ ã§ä¸‹è¨˜ã®ã‚ˆã†ãªãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒãƒ£ã‚’ä½œã£ãŸã€‚&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="k"&gt;typedef&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;void&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;Command&lt;/span&gt;&lt;span class="p"&gt;)();&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;unordered_map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Command&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;g_commandMap&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;ä½¿ã„æ¨ã¦ã® python ã§é–¢æ•°ã«ç™»éŒ²ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ãŸã€‚&lt;/p&gt;
&lt;h2&gt;ç¬¬ï¼’æ®µéš&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;PODã˜ã‚ƒãªã„å‹ãŒå‹•ãã‚ˆã†ã«ã™ã‚‹&lt;ul&gt;
&lt;li&gt;constructor/destructor&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è„±GC&lt;ul&gt;
&lt;li&gt;ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’STLã«ç½®ãæ›ãˆã‚‹&lt;/li&gt;
&lt;li&gt;std::string&lt;/li&gt;
&lt;li&gt;std::shared_ptr&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ©Ÿèƒ½ã”ã¨ã«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–&lt;/li&gt;
&lt;li&gt;å†å…¥å¯èƒ½&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;GC_MALLOC ã‹ã‚‰ gc_cleanup ç¶™æ‰¿ã¸&lt;/h3&gt;
&lt;p&gt;boehm-GC ã‚’ &lt;code&gt;c++&lt;/code&gt; ã®ã‚¯ãƒ©ã‚¹ã§ä½¿ã†æ–¹æ³•ã‚’èª¿ã¹ãŸã€‚&lt;/p&gt;
&lt;p&gt;http://www.namikilab.tuat.ac.jp/~sasada/prog/boehmgc.html#i-0-5&lt;/p&gt;
&lt;p&gt;&lt;code&gt;w3m&lt;/code&gt; ã§ã¯ã€ &lt;code&gt;GC&lt;/code&gt; ã‚’å¤šç”¨ã—ã¦ã„ã‚‹ã€‚&lt;/p&gt;
&lt;p&gt;ãŠã‚‚ã«ã€&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;struct Str&lt;/li&gt;
&lt;li&gt;ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³&lt;/li&gt;
&lt;li&gt;struct ã® field&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ã¨ã„ã†æ„Ÿã˜ã«ã€‚
ã“ã®ã†ã¡ã€ struct ã® field ã§ä½¿ã‚ã‚Œã‚‹ã‚¿ã‚¤ãƒ—ã®å˜ç™ºã® &lt;code&gt;GC_MALLOC&lt;/code&gt; ã—ã¦ã„ã‚‹å‹ã‚’ &lt;code&gt;gc_cleanup&lt;/code&gt; ç¶™æ‰¿ã«ã—ã¦ã€ &lt;code&gt;new&lt;/code&gt; ã§åˆæœŸåŒ–ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;bzero, bcopy, memcpy, sizeof&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç­‰ã§ãƒ¡ãƒ¢ãƒªã‚¯ãƒªã‚¢ã—ã¦ã„ã‚‹ã¨ã“ã‚ã«æ³¨æ„ã™ã‚‹ã€‚
ã“ã‚Œã§ã€ãã®å‹ã¯ &lt;code&gt;constructor/destructor&lt;/code&gt; ãŒå‹•ãã‚ˆã†ã«ãªã‚Šã€
ãƒ¡ãƒ³ãƒãƒ¼ã« &lt;code&gt;std::string&lt;/code&gt; ç­‰ã‚’é…ç½®ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚
ã‚ã¨ã§ã€ &lt;code&gt;gc_cleanup&lt;/code&gt; ã‹ã‚‰ &lt;code&gt;std::shared_ptr&lt;/code&gt; ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚è¦–é‡ã«å…¥ã‚Œã¦ã„ã‚‹ã€‚&lt;/p&gt;
&lt;h3&gt;GCæ–‡å­—åˆ— Str&lt;/h3&gt;
&lt;p&gt;ã‚¢ãƒ—ãƒªå…¨ä½“ã§ä½¿ã‚ã‚Œã¦ã„ã¦ä¸€æŒ™ã«ãªãã™ã“ã¨ã¯ã§ããªã„ã®ã ã‘ã©ã€æ§‹é€ ä½“ã®æœ«ç«¯ã®ãƒ¡ãƒ³ãƒãƒ¼ã‹ã‚‰ &lt;code&gt;std::string&lt;/code&gt; ã«å¤‰ãˆã‚‹ã€‚
ã‚ã¨ã€ãŒã‚“ã°ã£ã¦ &lt;code&gt;const char *&lt;/code&gt; ã®ç¯„å›²ã‚’å¢—ã‚„ã™ã€‚
&lt;code&gt;libwc&lt;/code&gt; ã‹ã‚‰ &lt;code&gt;Str&lt;/code&gt; ã‚’å‰¥ãã†ã¨æ€ã£ã¦ã„ãŸã®ã ãŒã€é€†ã« &lt;code&gt;libwc&lt;/code&gt; ã« &lt;code&gt;Str&lt;/code&gt; ã‚’å°ã˜è¾¼ã‚ã‚‹æ–¹å‘ã«è»Œé“ä¿®æ­£ã€‚
&lt;code&gt;indep.c&lt;/code&gt; ã®ä¾¿åˆ©æ–‡å­—åˆ—é–¢æ•°ã‚‚å°‘ã—ãšã¤å¤‰ãˆã¦ãã€‚&lt;/p&gt;
&lt;h3&gt;ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚’æ¸›ã‚‰ã™&lt;/h3&gt;
&lt;p&gt;é–¢æ•°ã®ä¸­ã§ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹å ´åˆ(CurrentBufferãªã©)ã€ã“ã‚Œã‚’é–¢æ•°ã®å¼•æ•°çµŒç”±ã¨ã‹ã€ã‚¯ãƒ©ã‚¹ã®ãƒ¡ãƒ³ãƒãƒ¼çµŒç”±ã§ã‚‚ã‚‰ã†ã€‚é¢å€’ã§ã‚‚ Getter ã¨ Setter ã‚’åŒºåˆ¥ã—ã¦ã€ã©ã“ã§å¤‰æ›´ã•ã‚Œã†ã‚‹ã‹ã‚ã‹ã‚Šã‚„ã™ãã™ã‚‹ã€‚
ã‚¯ãƒ©ã‚¹ã®ãƒ¡ãƒ³ãƒãƒ¼ã¯ã€ &lt;code&gt;private&lt;/code&gt; åŒ–ã‚’è©¦ã¿ã‚‹ã€‚&lt;/p&gt;
&lt;h3&gt;Streamå‡¦ç†&lt;/h3&gt;
&lt;p&gt;å¤šåˆ†ã€æœ€é›£é–¢ã® &lt;code&gt;loadGeneralFile&lt;/code&gt; é–¢æ•°ã€‚700è¡Œãã‚‰ã„ã ã£ãŸã‹ã€‚
goto ã¨ã‹ longjmp ãŒã‚ã£ã¦ã‚ˆãã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã ãŒã€æ…£ã‚Œã¦ããŸã€‚
&lt;code&gt;http&lt;/code&gt;, &lt;code&gt;https&lt;/code&gt;, &lt;code&gt;NNTP ?&lt;/code&gt;, &lt;code&gt;gopher&lt;/code&gt;, &lt;code&gt;ftp&lt;/code&gt;, &lt;code&gt;pipe&lt;/code&gt; ç­‰ã€&lt;code&gt;http&lt;/code&gt; ã®ãƒ—ãƒ­ã‚­ã‚·ãƒ¼ã‚„ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã€ &lt;code&gt;www-auth&lt;/code&gt; ãªã©ã‚’ä¸€æ‰‹ã«å‡¦ç†ã—ã¦ã„ã¦å®¹æ˜“ã«æ‰‹ã‚’ä»˜ã‘ã‚‰ã‚Œãªã„ã€‚
ä½•åº¦ã‹æ•´ç†ã—ã‚ˆã†ã¨ã—ã¦æ‚‰ãæ’ƒé€€ã•ã‚ŒãŸã®ã§ã€é›‘ã«ã‚„ã‚‹ã“ã¨ã«ã—ãŸã€‚
æ©Ÿèƒ½ã‚’ &lt;code&gt;http(https)&lt;/code&gt; ã«çµã£ã¦ãã‚Œä»¥å¤–ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ã¨ã«ã‹ãé‡ã‚’æ¸›ã‚‰ã™ã€‚
ãƒ—ãƒ­ã‚­ã‚·ãƒ¼ã¨ã‹ã€ &lt;code&gt;dump&lt;/code&gt;, &lt;code&gt;halfload&lt;/code&gt; ãªã©ã®ã‚ˆãçŸ¥ã‚‰ãªã„æ©Ÿèƒ½ã‚‚ã©ã‚“ã©ã‚“å‰Šã‚‹ã€‚
ã¨ã—ã¦ãªã‚“ã¨ã‹æ”¹é€ ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ããŸã€‚&lt;/p&gt;
&lt;p&gt;ã“ã“ã‚’ &lt;code&gt;HttpClient&lt;/code&gt;, &lt;code&gt;LocalFile&lt;/code&gt;, &lt;code&gt;PipeReader&lt;/code&gt; ã‚ãŸã‚Šã«æ•´ç†ã—ãŸã„ã€‚&lt;/p&gt;
&lt;h2&gt;ç¬¬ï¼“æ®µéš&lt;/h2&gt;
&lt;p&gt;Tab, Buffer, Line ã®ãƒªãƒ³ã‚¯ãƒªã‚¹ãƒˆã‚’ STL ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«ç½®ãæ›ãˆãŸã€‚&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="k"&gt;auto&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;buf&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;tab&lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="n"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buf&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;ã¨ã„ã†å½¢ã‚’ç›®æŒ‡ã™ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;loadGeneralFile&lt;/code&gt; ã‚’è§£ãã»ãã—ã¦ã€ &lt;code&gt;HTTP&lt;/code&gt; æ©Ÿèƒ½ã‚’æŠ½å‡ºã€ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã¾ã§å‹•ãã‚ˆã†ã«ã§ããŸã€‚
&lt;code&gt;loadGeneralFile&lt;/code&gt; ã¯ã€&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nv"&gt;OpenStream&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;Send&lt;/span&gt; &lt;span class="nv"&gt;HTTP&lt;/span&gt; &lt;span class="nv"&gt;Request&lt;/span&gt;
&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nv"&gt;HTTP&lt;/span&gt; &lt;span class="nv"&gt;Response&lt;/span&gt;
    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="nv"&gt;xx&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nv"&gt;Redirect&lt;/span&gt;
&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nv"&gt;content&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt; ã§åˆ†å²
    &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nv"&gt;BufferLoader&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nv"&gt;Buffer&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;ã¨ã„ã†æ„Ÿã˜ã«æ•´ç†ã§ããã†ã€‚
Httpã¨Bufferãƒ­ãƒ¼ãƒ€ãƒ¼ã‚’å‰¯ä½œç”¨ã®ç„¡ã„é–¢æ•°ã«æ•´ç†ã§ãã‚Œã°å†å…¥å¯èƒ½ãŒè¦‹ãˆã¦ãã‚‹ã€‚
æ—©ã‚ã«åˆ†å²ã•ã›ã¦ã€åˆ†å²ã—ãŸã‚‰åˆæµã—ãªã„ã€‚åŒã˜å‡¦ç†ã¯é–¢æ•°ã§å…±æœ‰ã™ã‚‹ã¨ã„ã†æ–¹å‘æ€§ã§æ•´ç†ã€‚&lt;/p&gt;
&lt;p&gt;Buffer ãŒå¤šæ©Ÿèƒ½ãªã®ã§ã€Document, HttpResponse, FileInfo ã¨ã‹ã«åˆ†å‰²ã—ãŸã„ã€‚&lt;/p&gt;
&lt;h2&gt;ç¬¬ï¼”æ®µéš&lt;/h2&gt;
&lt;p&gt;mainloop ã®å†å®Ÿè£…ã€‚libuv, libevent ç­‰ã‚’æ¤œè¨ã—ã¦ã„ãŸã®ã ã‘ã©ã€ c++ ã¨ã®è¦ªå’Œæ€§ã®é«˜ã„ asio ã‚’ä½¿ã†ã“ã¨ã«ã—ãŸã€‚
&lt;code&gt;tty read (keyboard input)&lt;/code&gt;, &lt;code&gt;signal callback (sigint, winresize)&lt;/code&gt;, &lt;code&gt;alarm&lt;/code&gt; ã®å‰²ã‚Šè¾¼ã¿ã‚’ asio çµŒç”±ã«ã™ã‚‹ã€‚
ã‚¢ãƒ—ãƒªã®çµ‚äº†ã‚’loop ã®çµ‚äº†ã«ã—ã¦ã€è‡ªç„¶ã« destructor ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚&lt;/p&gt;
&lt;h2&gt;ç¬¬ï¼•æ®µéš&lt;/h2&gt;
&lt;p&gt;html parse ã‹ã‚‰ term ã¸ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°éƒ¨åˆ†ã®åˆ†è§£ã€‚
ã‚„ã£ã¨è§£èª­ã§ãã¦ï¼‘ãƒ‘ã‚¹ç›®&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†…éƒ¨æ–‡å­—ã‚³ãƒ¼ãƒ‰(wtf-8)ã«å¤‰æ›&lt;/li&gt;
&lt;li&gt;tokenize&lt;/li&gt;
&lt;li&gt;tag ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦å±æ€§å–å¾— =&amp;gt; ãƒ‘ãƒ¼ã‚¹ã«æˆåŠŸã—ãŸã‚‰è¡Œãƒãƒƒãƒ•ã‚¡ã«æ›¸ãæˆ»ã™ã€‚ãƒ•ã‚©ãƒ¼ãƒ ã®æƒ…å ±ã‚’è“„ç©ã™ã‚‹ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;çµæœã¨ã—ã¦ã€è¡Œã®ãƒªã‚¹ãƒˆã¨ã€ãƒ•ã‚©ãƒ¼ãƒ æƒ…å ±ã‚’å¾—ã‚‹ã€‚&lt;/p&gt;
&lt;p&gt;ï¼’ãƒ‘ã‚¹ç›®&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¡Œã®ãƒªã‚¹ãƒˆã‚’å†åº¦ãƒ‘ãƒ¼ã‚¹&lt;/li&gt;
&lt;li&gt;éã‚¿ã‚°éƒ¨åˆ†ã‚’Bufferã«å‡ºåŠ›&lt;/li&gt;
&lt;li&gt;Aã‚¿ã‚°ã‚„ãƒ•ã‚©ãƒ¼ãƒ ã‚’ Anchor ãªã©ã«å‡ºåŠ›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ã¨ã„ã†æ„Ÿã˜ã ã£ãŸã€‚
ï¼‘ãƒ‘ã‚¹ç›®ã§ html åŒ–ã™ã‚‹ã¨ãã«çŸ¥ã‚‰ãªã„å±æ€§ã‚’æ¨ã¦ãŸã‚Šã€å†…éƒ¨å±æ€§ã‚’è¿½åŠ ã—ãŸã‚Šã—ã¦ã„ã‚‹æ§˜å­ã€‚
ã“ã®ã€å†…éƒ¨å±æ€§ãŒã‚ˆãã‚ã‹ã‚‰ãªãã¦é›£ã—ã„ã€‚&lt;/p&gt;
&lt;h2&gt;æ–‡å­—ã‚³ãƒ¼ãƒ‰&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;content-charset&lt;/code&gt; =&amp;gt; &lt;code&gt;wtf&lt;/code&gt; =&amp;gt; &lt;code&gt;DisplayCharset&lt;/code&gt; ã¨æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›ã—ã¦å‹•ä½œã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã€‚
è©¦ã—ã«ã€&lt;code&gt;utf-8&lt;/code&gt; ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã£ã¦ã„ã‚‹ &lt;code&gt;html&lt;/code&gt; ã§ &lt;code&gt;wtf&lt;/code&gt; å¤‰æ›ã‚’é£›ã°ã—ã¦ã¿ãŸã¨ã“ã‚è¡¨ç¤ºãŒå£Šã‚ŒãŸã€‚
&lt;code&gt;wtf&lt;/code&gt; ã¯ &lt;code&gt;utf-8&lt;/code&gt; ã¨äº’æ›æ€§ãŒãªã„ã‚‰ã—ã„ã€‚
http://simonsapin.github.io/wtf-8/
ãªã®ã‹ã¨æ€ã£ãŸã®ã ãŒã€é•ã†ç‹¬è‡ªå½¢å¼ã‹ã‚‚ã—ã‚Œãªã„ã€‚&lt;/p&gt;
&lt;p&gt;w3m ã¯ã€ã“ã® &lt;code&gt;wtf&lt;/code&gt; ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ã€html ã‚¿ã‚°ã®ãƒ‘ãƒ¼ã‚¹ã€æ–‡å­—ã®ãƒã‚¤ãƒˆå¹…ã®åˆ¤å®šã€æ–‡å­—ã®ã‚«ãƒ©ãƒ å¹…ã®åˆ¤å®šã‚’ã—ã¦ã„ã‚‹ã®ã ãŒã€
&lt;code&gt;utf-8&lt;/code&gt; ã§ã¯ã€æ–‡å­—ã®ãƒã‚¤ãƒˆå¹…ã€ã‚«ãƒ©ãƒ å¹…ã®åˆ¤å®šãŒç‹‚ã†ã€‚
ã¨ã„ã†ã“ã¨ã§ã€ &lt;code&gt;utf-8&lt;/code&gt; ã§ã®ãƒã‚¤ãƒˆå¹…åˆ¤å®šã‚’è‡ªä½œã—ã¦ &lt;code&gt;wcwidth&lt;/code&gt; ã‚’çµ„ã¿åˆã‚ã›ã¦ã¿ãŸã€‚
&lt;code&gt;*#12345;&lt;/code&gt; å½¢å¼ã® &lt;code&gt;unicode&lt;/code&gt; åŸ‹ã‚è¾¼ã¿ã«å¯¾å¿œã™ã‚‹ãŸã‚ã«ã€è¿½åŠ ã§ &lt;code&gt;unicode&lt;/code&gt; =&amp;gt; &lt;code&gt;utf-8&lt;/code&gt; å¤‰æ›ã‚‚ä½œã£ãŸã€‚
æ­£ã—ãè¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ããŸã€‚&lt;/p&gt;
&lt;p&gt;ã¨ã„ã†ã“ã¨ã§ã€&lt;code&gt;euc-jp&lt;/code&gt; ã¨ &lt;code&gt;shift-jis&lt;/code&gt; ã¨ &lt;code&gt;iso-2022-jp&lt;/code&gt; ã‹ã‚‰ &lt;code&gt;utf-8&lt;/code&gt; ã¸ã®å¤‰æ›ã‚’ä½œã‚Œã°æ—¥æœ¬èªã¯å¯¾å¿œã§ããã†ã€‚
&lt;code&gt;std::string_view&lt;/code&gt;, &lt;code&gt;char32_t&lt;/code&gt;, &lt;code&gt;char8_t&lt;/code&gt; ã‚ãŸã‚Šã®æ–°ã—ã„å‹ã‚’ä½¿ã£ãŸ &lt;code&gt;\0&lt;/code&gt; çµ‚ç«¯ã«é ¼ã‚‰ãªã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½œã£ã¦ã¿ã‚‹ã€‚&lt;/p&gt;
&lt;h2&gt;ãƒ¡ãƒ¢&lt;/h2&gt;
&lt;h3&gt;ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«åˆ†å‰²&lt;/h3&gt;
&lt;p&gt;æ©Ÿèƒ½ã”ã¨ã«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«åˆ†å‰²ã™ã‚‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;UI(frontend)&lt;ul&gt;
&lt;li&gt;Term&lt;ul&gt;
&lt;li&gt;ä½ãƒ¬ãƒ™ãƒ«æç”»&lt;ul&gt;
&lt;li&gt;termcap ã®é–¢æ•°ã‚’ç›´æ¥å‘¼ã¶ã€‚curses ã®è‡ªå‰å®Ÿè£…çš„ãª&lt;/li&gt;
&lt;li&gt;ãƒãƒ«ãƒãƒã‚¤ãƒˆã€ãƒãƒ«ãƒã‚«ãƒ©ãƒ ã®æ–‡å­—åˆ—ã¨å¯†æ¥ã«é–¢é€£ã—ã¦ã„ã¦ libwc ã¨ä¸å¯åˆ†&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›&lt;/li&gt;
&lt;li&gt;ãƒã‚¦ã‚¹å…¥åŠ›&lt;/li&gt;
&lt;li&gt;ãƒªã‚µã‚¤ã‚ºã‚¤ãƒ™ãƒ³ãƒˆ&lt;/li&gt;
&lt;li&gt;SIGNALãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°&lt;ul&gt;
&lt;li&gt;SIGINT =&amp;gt; longjmp ã§ã‚­ãƒ£ãƒ³ã‚»ãƒ«å‡¦ç†ã‚’å®Ÿç¾ã—ã¦ã„ã‚‹ã€‚c++ ã®ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¨ã‹ã¾ãšãã†&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é«˜ãƒ¬ãƒ™ãƒ«æç”»&lt;ul&gt;
&lt;li&gt;Lineã®æ§‹ç¯‰(byte ã”ã¨ã« char ã¨ Lineprop ãŒãƒšã‚¢ã«ãªã‚‹)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Tab&lt;/li&gt;
&lt;li&gt;Buffer&lt;/li&gt;
&lt;li&gt;Message&lt;/li&gt;
&lt;li&gt;Menu&lt;/li&gt;
&lt;li&gt;Keymap&lt;/li&gt;
&lt;li&gt;LineInput&lt;ul&gt;
&lt;li&gt;SearchKey&lt;/li&gt;
&lt;li&gt;History&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;IO(transport)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IStream&lt;ul&gt;
&lt;li&gt;union =&amp;gt; class polymorphismåŒ–&lt;/li&gt;
&lt;li&gt;file descriptor&lt;/li&gt;
&lt;li&gt;FILE*&lt;/li&gt;
&lt;li&gt;ssl&lt;/li&gt;
&lt;li&gt;memory&lt;/li&gt;
&lt;li&gt;Compression&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;LocalCGI&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;http&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;HttpSession&lt;ul&gt;
&lt;li&gt;HttpRequest&lt;/li&gt;
&lt;li&gt;HttpResponse&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;cookie&lt;/li&gt;
&lt;li&gt;redirect&lt;/li&gt;
&lt;li&gt;referer&lt;/li&gt;
&lt;li&gt;https&lt;/li&gt;
&lt;li&gt;ftp&lt;/li&gt;
&lt;li&gt;URL&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HTML&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;HTMLtagproc1&lt;/li&gt;
&lt;li&gt;HTMLlineproc2body&lt;ul&gt;
&lt;li&gt;process_form&lt;/li&gt;
&lt;li&gt;process_form_int&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;form&lt;/li&gt;
&lt;li&gt;table&lt;/li&gt;
&lt;li&gt;frame&lt;/li&gt;
&lt;li&gt;term rendering&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;String&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–‡å­—ã‚³ãƒ¼ãƒ‰&lt;/li&gt;
&lt;li&gt;quote&lt;/li&gt;
&lt;li&gt;url escape&lt;/li&gt;
&lt;li&gt;html escape&lt;/li&gt;
&lt;li&gt;html entity&lt;/li&gt;
&lt;li&gt;char_util&lt;ul&gt;
&lt;li&gt;myctype&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;string_view_util&lt;ul&gt;
&lt;li&gt;strip&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;string_util&lt;ul&gt;
&lt;li&gt;malloc&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ãƒªãƒ³ã‚¯ã‚’ãŸã©ã‚‹(followLink)&lt;/h3&gt;
&lt;p&gt;followA();
loadLink();
loadGeneralFile();&lt;/p&gt;
&lt;p&gt;cmd_loadURL();
loadGeneralFile();&lt;/p&gt;
&lt;p&gt;cmd_loadURL();
loadGeneralFile();&lt;/p&gt;
&lt;h3&gt;æç”»ã™ã‚‹&lt;/h3&gt;
&lt;p&gt;displayBuffer
redrawBuffer
redrawNLine&lt;/p&gt;
&lt;h3&gt;keyå…¥åŠ›&lt;/h3&gt;</description><category>w3m</category><guid>https://ousttrue.github.io/posts/2020/w3m-mod/</guid><pubDate>Sat, 25 Jul 2020 05:59:50 GMT</pubDate></item></channel></rss>