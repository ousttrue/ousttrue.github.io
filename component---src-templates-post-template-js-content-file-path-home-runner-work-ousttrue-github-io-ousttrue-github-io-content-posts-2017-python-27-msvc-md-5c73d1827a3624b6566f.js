"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9033],{4783:function(n,s,a){a.r(s),a.d(s,{default:function(){return k}});var t=a(1151),e=a(7294);function p(n){const s=Object.assign({p:"p",span:"span"},(0,t.ah)(),n.components);return e.createElement(e.Fragment,null,e.createElement(s.p,null,"python2.7のnativeモジュールをビルドするのにMSVC9(VisualStudio2008)ではなく、\nMSVC15(VisualStudio2017)とかを使うには。"),"\n",e.createElement(s.p,null,"本当はPythone.exeをビルドしたコンパイラにバージョンを合わせた方がいいのかもしれないが、古いC++でコンパイルできるようにコードを修正するのが嫌なので。\n例。"),"\n",e.createElement(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># setup.py</span>\n<span class="token keyword">from</span> distutils<span class="token punctuation">.</span>core <span class="token keyword">import</span> setup<span class="token punctuation">,</span> Extension\n\niex <span class="token operator">=</span> Extension<span class="token punctuation">(</span><span class="token string">\'iex\'</span><span class="token punctuation">,</span> sources <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'PyIex/iexmodule.cpp\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n\nsetup <span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">\'pyalembic\'</span><span class="token punctuation">,</span>\n       version <span class="token operator">=</span> <span class="token string">\'1.0\'</span><span class="token punctuation">,</span>\n       description <span class="token operator">=</span> <span class="token string">\'python binding of Alembic\'</span><span class="token punctuation">,</span>\n       ext_modules <span class="token operator">=</span> <span class="token punctuation">[</span>iex<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div>'}}),"\n",e.createElement(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">> python.exe setup.py build\nrunning build\nrunning build_ext\nbuilding \'iex\' extension\nerror: Unable to find vcvarsall.bat</code></pre></div>'}}),"\n",e.createElement(s.p,null,"vs2008をインストールしていないのでエラーになる。\n調べたところdistutils/mvsc9compiler.pyのfind_vcvarsallを置き換えればよさそう。"),"\n",e.createElement(s.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="python"><pre class="language-python"><code class="language-python"><span class="token comment"># monkey patch for msvccompiler</span>\n<span class="token keyword">import</span> distutils<span class="token punctuation">.</span>msvc9compiler\n<span class="token keyword">def</span> <span class="token function">find_vcvarsall</span><span class="token punctuation">(</span>version<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    <span class="token keyword">return</span> <span class="token string">"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Auxiliary/Build/vcvarsall.bat"</span>\ndistutils<span class="token punctuation">.</span>msvc9compiler<span class="token punctuation">.</span>find_vcvarsall<span class="token operator">=</span>find_vcvarsall\n\n\n<span class="token keyword">from</span> distutils<span class="token punctuation">.</span>core <span class="token keyword">import</span> setup<span class="token punctuation">,</span> Extension\n<span class="token keyword">import</span> os\n\niex <span class="token operator">=</span> Extension<span class="token punctuation">(</span><span class="token string">\'iex\'</span><span class="token punctuation">,</span> \n                sources <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'PyIex/iexmodule.cpp\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n                include_dirs <span class="token operator">=</span> <span class="token punctuation">[</span>\n                    os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">\'VCPKG_DIR\'</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">\'/installed/x64-windows/include\'</span><span class="token punctuation">,</span>\n                    os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">\'VCPKG_DIR\'</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">\'/installed/x64-windows/include/openexr\'</span>\n                    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n                library_dirs<span class="token operator">=</span><span class="token punctuation">[</span>\n                    os<span class="token punctuation">.</span>environ<span class="token punctuation">[</span><span class="token string">\'VCPKG_DIR\'</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">\'/installed/x64-windows/lib\'</span>\n                    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n                libraries<span class="token operator">=</span><span class="token punctuation">[</span>\n                    <span class="token string">\'Iex-2_2\'</span><span class="token punctuation">,</span>\n                    <span class="token punctuation">]</span>\n                <span class="token punctuation">)</span>\n\nsetup <span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">\'pyalembic\'</span><span class="token punctuation">,</span>\n       version <span class="token operator">=</span> <span class="token string">\'1.0\'</span><span class="token punctuation">,</span>\n       description <span class="token operator">=</span> <span class="token string">\'python binding of Alembic\'</span><span class="token punctuation">,</span>\n       ext_modules <span class="token operator">=</span> <span class="token punctuation">[</span>iex<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div>'}}),"\n",e.createElement(s.p,null,"VS2017のコンパイラでビルドできた。"))}var o=function(n){void 0===n&&(n={});const{wrapper:s}=Object.assign({},(0,t.ah)(),n.components);return s?e.createElement(s,n,e.createElement(p,n)):p(n)},c=a(8678),l=a(1883),i=a(8838);const u={code:n=>{let{children:s,className:a}=n;return a?e.createElement(i.Z,{className:a},s):e.createElement("code",null,s)}};function r(n){let{data:s,children:a}=n;const p=s.mdx.frontmatter;return e.createElement(c.Z,null,e.createElement("h1",null,p.title),e.createElement("div",{className:"tags-index"},p.tags&&p.tags.length>0&&p.tags.map((n=>e.createElement(l.rU,{to:"/tags/"+n+"/",itemProp:"url"},e.createElement("button",null,n))))),e.createElement(t.Zo,{components:u},a))}function k(n){return e.createElement(r,n,e.createElement(o,n))}}}]);
//# sourceMappingURL=component---src-templates-post-template-js-content-file-path-home-runner-work-ousttrue-github-io-ousttrue-github-io-content-posts-2017-python-27-msvc-md-5c73d1827a3624b6566f.js.map