"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[699],{6640:function(n,e,a){a.r(e),a.d(e,{default:function(){return i}});var t=a(1151),s=a(7294);function l(n){const e=Object.assign({h1:"h1",p:"p",h2:"h2",span:"span",code:"code",ul:"ul",li:"li",h3:"h3"},(0,t.ah)(),n.components);return s.createElement(s.Fragment,null,s.createElement(e.h1,null,"zig その2"),"\n",s.createElement(e.p,null,"再度使ってみるべく環境整備から。"),"\n",s.createElement(e.h2,null,"zls の master を使う"),"\n",s.createElement(e.p,null,"どうやら @import std 以外がうまく動かないらしく、 最新版を試してみたい。"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">const glfw = @import("glfw");</code></pre></div>'}}),"\n",s.createElement(e.p,null,"https://ziglang.org/download/ からダウンロードするべし。"),"\n",s.createElement(e.h2,null,"いちおう build を 試みた"),"\n",s.createElement(e.p,null,"zls の最新判を試すには、 zig の最新版(0.9.1じゃなくてmaster)が必要。\nzig のビルドには static build の llvm-13 が必要。\nWindows では頓挫した。\nしかし、最近 gentoo を育成しているのでこっちでやってみる。"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">cmake -B build -S .</code></pre></div>'}}),"\n",s.createElement(e.p,null,"してみたが、最後にリンクエラーが出る。"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">undefined reference to clang::SourceManager::getFilename</code></pre></div>'}}),"\n",s.createElement(e.p,null,"しかし、 gentoo の emerge に ",s.createElement(e.code,null,"dev-lang/zig-9999")," があった。\nこれを使って zls がビルドできた。\n",s.createElement(e.code,null,"glfw")," のインテリセンスも動作した。"),"\n",s.createElement(e.h2,null,"zig master(0.10) が変わっていて zls と gyro のビルドが通らない。"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"https://github.com/ziglang/zig/commit/a0a2ce92ca129d28e22c63f7bace1672c43776b5"),"\n"),"\n",s.createElement(e.h3,null,"zls"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"https://github.com/zigtools/zls/pull/481"),"\n"),"\n",s.createElement(e.h3,null,"gyro"),"\n",s.createElement(e.p,null,s.createElement(e.code,null,"std.ChildProcess.init")," のところ。"),"\n",s.createElement(e.h2,null,"OpenGL やってく"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"https://github.com/hexops/mach-glfw"),"\n"),"\n",s.createElement(e.p,null,"を起点にやってみる。\n前回は ",s.createElement(e.code,null,"@cImport")," を使っているサンプルでインテリセンス効かなくて、続かなかった。\n",s.createElement(e.code,null,"@import")," + ",s.createElement(e.code,null,"最新版zls")," で進めていけば慣れるかな。"),"\n",s.createElement(e.h2,null,"gyro の使いかた"),"\n",s.createElement(e.p,null,s.createElement(e.code,null,"202204")," 現在だと、 gyro で import すると zls が解決できないような気がする。"),"\n",s.createElement(e.h3,null,"add package"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">gyro add --src github hexops/mach-glfw --root src/main.zig --alias glfw</code></pre></div>'}}),"\n",s.createElement(e.h3,null,"dep package"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">gyro add --build-dep --src github hexops/mach-glfw --root build.zig --alias build-glfw</code></pre></div>'}}),"\n",s.createElement(e.h3,null,"use package"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="zig"><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> glfw <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"glfw"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>'}}),"\n",s.createElement(e.h3,null,"build.zig"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="zig"><pre class="language-zig"><code class="language-zig"><span class="token keyword">const</span> pkgs <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"deps.zig"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pkgs<span class="token punctuation">;</span>\n<span class="token keyword">const</span> glfw <span class="token operator">=</span> <span class="token builtin">@import</span><span class="token punctuation">(</span><span class="token string">"build-glfw"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">build</span><span class="token punctuation">(</span>b<span class="token punctuation">:</span> <span class="token class-name"><span class="token operator">*</span>Builder</span><span class="token punctuation">)</span> <span class="token class-name"><span class="token builtin-type keyword">void</span></span> <span class="token punctuation">{</span>\n    <span class="token operator">...</span>\n\n    exe<span class="token punctuation">.</span><span class="token function">addPackage</span><span class="token punctuation">(</span>pkgs<span class="token punctuation">.</span>glfw<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    glfw<span class="token punctuation">.</span><span class="token function">link</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> exe<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code></pre></div>'}}),"\n",s.createElement(e.h3,null,"zgl"),"\n",s.createElement(e.p,null,"libepoxy"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">gyro add --src github ziglibs/zgl --root zgl.zig --alias gl</code></pre></div>'}}))}var c=function(n){void 0===n&&(n={});const{wrapper:e}=Object.assign({},(0,t.ah)(),n.components);return e?s.createElement(e,n,s.createElement(l,n)):l(n)},p=a(8678),o=a(4160),u=a(8736);const r={code:n=>{let{children:e,className:a}=n;return a?s.createElement(u.Z,{className:a},e):s.createElement("code",null,e)}};function g(n){let{data:e,children:a}=n;const l=e.mdx.frontmatter;return s.createElement(p.Z,null,s.createElement("h1",null,l.title),s.createElement("div",{className:"tags-index"},l.tags&&l.tags.length>0&&l.tags.map((n=>s.createElement(o.rU,{to:"/tags/"+n+"/",itemProp:"url"},s.createElement("button",null,n))))),s.createElement(t.Zo,{components:r},a))}function i(n){return s.createElement(g,n,s.createElement(c,n))}}}]);
//# sourceMappingURL=component---src-templates-post-template-js-content-file-path-content-posts-2022-0428-zig-2-md-9ca1f247926c874d5d8e.js.map