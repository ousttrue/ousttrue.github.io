"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4421],{4754:function(e,t,n){n.r(t),n.d(t,{default:function(){return g}});var l=n(1151),a=n(7294);function s(e){const t=Object.assign({p:"p",span:"span",code:"code",h2:"h2"},(0,l.ah)(),e.components);return a.createElement(a.Fragment,null,a.createElement(t.p,null,"hererocks が VS2019BuildTools を検知して動作するように改造してみた。"),"\n",a.createElement(t.p,null,"https://github.com/luarocks/hererocks/pull/15"),"\n",a.createElement(t.p,null,"通るかどうかは微妙。\n内容的に、通りづらそう。\n古い vc を使っていたり MinGW 使っていたりすると実験できないしね。\nとりあえず、既存の動いている部分が壊れないようには配慮した。"),"\n",a.createElement(t.p,null,"採用されれば、"),"\n",a.createElement(t.p,null,"https://github.com/wbthomason/packer.nvim/issues/302"),"\n",a.createElement(t.p,null,"も進展する。\nWindows 版の luarocks 呼び出しに改造が必要なのだが、\n先に hererocks が動いている必要があるという順番。"),"\n",a.createElement(t.p,null,"とりあえず単体で試すことができて"),"\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># C:/Python38/Scripts/pip.exe\n$ pip install https://github.com/ousttrue/hererocks/archive/add_vswhere.zip</code></pre></div>'}}),"\n",a.createElement(t.p,null,"とする。"),"\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># C:/Python38/Scripts/hererocks.exe\n$ hererocks.exe --target vs -j 2.1.0-beta3 -r latest build_dir\nUsing cl.exe found in PATH.\nFetching LuaJIT 2.1.0-beta3 (target: vs) (cached)\nVerifying SHA256 checksum\nBuilding LuaJIT 2.1.0-beta3 (target: vs)\nInstalling LuaJIT 2.1.0-beta3 (target: vs)\nFetching LuaRocks 3.7.0 (cached)\nVerifying SHA256 checksum\nBuilding and installing LuaRocks 3.7.0</code></pre></div>'}}),"\n",a.createElement(t.p,null,"lua はシステムにインストールして全体でライブラリを共有するというよりは、\nプロジェクト単位でインストールしてローカルに必要なライブラリだけを追加するという運用になりそう。\nなので、 hererocks でプロジェクトローカルに lua をサクッとビルドできるのはなかなかよい。\npython の venv 的な運用。\n展開先は、 ",a.createElement(t.code,null,".gitignore")," する。"),"\n",a.createElement(t.p,null,"ただ、外部ライブラリのラッパーがさくっと動くかというと Windows だと厳しいものがありますな・・・。\nvcpkg と連携させるとか、更なる頑張りが必要かもしれない。\nなので、 luajit の ffi が面白いかもしれない。\nstandalone の lua インタプリタを使う場合は ",a.createElement(t.code,null,"hererocks")," がいいのではないか。"),"\n",a.createElement(t.h2,null,"vswhere メモ"),"\n",a.createElement(t.p,null,"https://github.com/Microsoft/vswhere"),"\n",a.createElement(t.p,null,a.createElement(t.code,null,"cl.exe"),", ",a.createElement(t.code,null,"msbuild.exe")," などの探索に使う。\n",a.createElement(t.code,null,"vs2017 version 15.2")," 以降に入っているらしい。"),"\n",a.createElement(t.p,null,"こんな感じに使う。"),"\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># %ProgramFiles(x86)%\\Microsoft Visual Studio\\Installer\\vswhere.exe\n> vswhere -nologo -products *\ninstanceId: 6762dfe1\ninstallDate: 2020/07/21 9:26:34\ninstallationName: VisualStudio/16.7.3+30503.244\ninstallationPath: C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\ninstallationVersion: 16.7.30503.244\nproductId: Microsoft.VisualStudio.Product.BuildTools\nproductPath: C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\Common7\\Tools\\LaunchDevCmd.bat\nstate: 4294967295\nisComplete: 1\nisLaunchable: 1\nisPrerelease: 0\nisRebootRequired: 0\ndisplayName: Visual Studio Build Tools 2019\ndescription: Visual Studio Build Tools では、Visual Studio IDE を必要とせずに、MSBuild ベースのネイティブ マネージド アプリケーションをビルドできます。また、Visual C++ のコンパイラやライブラリ、MFC、ATL、および C++/CLI サポートをインストールするオプションも用意されています。\nchannelId: VisualStudio.16.Release\nchannelUri: https://aka.ms/vs/16/release/channel\nenginePath: C:\\Program Files (x86)\\Microsoft Visual Studio\\Installer\\resources\\app\\ServiceHub\\Services\\Microsoft.VisualStudio.Setup.Service\nreleaseNotes: https://go.microsoft.com/fwlink/?LinkId=660893#16.7.3\nthirdPartyNotices: https://go.microsoft.com/fwlink/?LinkId=660909\nupdateDate: 2020-09-13T06:19:26.0508205Z\ncatalog_buildBranch: d16.7\ncatalog_buildVersion: 16.7.30503.244\ncatalog_id: VisualStudio/16.7.3+30503.244\ncatalog_localBuild: build-lab\ncatalog_manifestName: VisualStudio\ncatalog_manifestType: installer\ncatalog_productDisplayVersion: 16.7.3\ncatalog_productLine: Dev16\ncatalog_productLineVersion: 2019\ncatalog_productMilestone: RTW\ncatalog_productMilestoneIsPreRelease: False\ncatalog_productName: Visual Studio\ncatalog_productPatchVersion: 3\ncatalog_productPreReleaseMilestoneSuffix: 1.0\ncatalog_productSemanticVersion: 16.7.3+30503.244\ncatalog_requiredEngineVersion: 2.7.3132.26759\nproperties_campaignId:\nproperties_channelManifestId: VisualStudio.16.Release/16.7.3+30503.244\nproperties_nickname:\nproperties_setupEngineFilePath: C:\\Program Files (x86)\\Microsoft Visual Studio\\Installer\\vs_installershell.exe</code></pre></div>'}}),"\n",a.createElement(t.p,null,"https://github.com/microsoft/vswhere/wiki/Find-VC"),"\n",a.createElement(t.p,null,"フィルタをかけられる。"),"\n",a.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">> vswhere -latest -products * -requires Microsoft.VisualStudio.Component.VC.Tools.x86.x64 -property installationPath\nC:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools</code></pre></div>'}}),"\n",a.createElement(t.p,null,"見つかったパスから先は固定であるとみなして、 ",a.createElement(t.code,null,"vcvars64.bat")," などを見つける。"))}var o=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,l.ah)(),e.components);return t?a.createElement(t,e,a.createElement(s,e)):s(e)},r=n(8678),i=n(4160),c=n(8736);const u={code:e=>{let{children:t,className:n}=e;return n?a.createElement(c.Z,{className:n},t):a.createElement("code",null,t)}};function d(e){let{data:t,children:n}=e;const s=t.mdx.frontmatter;return a.createElement(r.Z,null,a.createElement("h1",null,s.title),a.createElement("div",{className:"tags-index"},s.tags&&s.tags.length>0&&s.tags.map((e=>a.createElement(i.rU,{to:"/tags/"+e+"/",itemProp:"url"},a.createElement("button",null,e))))),a.createElement(l.Zo,{components:u},n))}function g(e){return a.createElement(d,e,a.createElement(o,e))}}}]);
//# sourceMappingURL=component---src-templates-post-template-js-content-file-path-content-posts-2021-fix-hererocks-md-ffad08549c9906cb674c.js.map