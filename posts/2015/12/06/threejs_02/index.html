<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Nikola (getnikola.com)">
<meta name="viewport" content="width=device-width">
<script src="../../../../../assets/js/all-nocdn.js"></script><title>Three.jsã«ãƒã‚¦ã‚¹ã«ã‚ˆã‚‹è¦–ç‚¹æ“ä½œã‚’å…¥ã‚Œã‚‹ | ä¸‰æ¬¡å…ƒæ—¥èªŒ</title>
<link href="../../../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
</head>
<body>
    <h1 id="brand">
        <a href="../../../../../" title="ä¸‰æ¬¡å…ƒæ—¥èªŒ" rel="home">
            <span id="blog-title">ä¸‰æ¬¡å…ƒæ—¥èªŒ</span>
        </a>
    </h1>

    <nav id="menu"><ul>
<li><a href="../../../../../archive.html">Archives</a></li>
<li><a href="../../../../../categories/index.html">Tags</a></li>
<li><a href="../../../../../rss.xml">RSS feed</a></li>
<li><a href="../../../../../about">About</a></li>
<li><a href="../../../../../books">MemoBooks</a></li>

            
            
            
        </ul></nav><hr>
<main id="content"><h1 class="p-name entry-title" itemprop="headline name">
    <h1 class="p-name entry-title" itemprop="headline name">
    <a href="." class="u-url">Three.jsã«ãƒã‚¦ã‚¹ã«ã‚ˆã‚‹è¦–ç‚¹æ“ä½œã‚’å…¥ã‚Œã‚‹
    </a>
</h1>
<ul itemprop="keywords" class="tags">
<li>
        <time datetime="2015-12-06T00:00:00+09:00" title="2015-12-06">2015-12-06</time>
</li>
</ul>
</h1>

<p>source
ä»Šå›ã¯ã€TrackballControlsã‚’å°å…¥ã—ã¾ã™ã€‚
TrackballControlsã¯Three.jsã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå†…ã«å«ã¾ã‚Œã‚‹ã®ã§ã¯ãªãexamplesæ‰±ã„ãªã®ã§ã€
ç›´æ¥ã‚³ãƒ¼ãƒ‰ã‚’å…¥æ‰‹ã€‚
ä½¿ã„æ–¹ã¯ã€TrackballControlsã®ã‚½ãƒ¼ã‚¹ã‚’è¦‹ã‚‹ã¨
ä»¥ä¸‹ã®ã‚ˆã†ã«ã™ã‚‹ã‚‰ã—ã„ã€‚
controls = new THREE.TrackballControls( camera );</p>
<p>controls.rotateSpeed = 1.0;
controls.zoomSpeed = 1.2;
controls.panSpeed = 0.8;</p>
<p>controls.noZoom = false;
controls.noPan = false;</p>
<p>controls.staticMoving = true;
controls.dynamicDampingFactor = 0.3;</p>
<p>controls.keys = [ 65, 83, 68 ];</p>
<p>controls.addEventListener( 'change', render );</p>
<p>ã‚‚ã†ã²ã¨ã¤æ›´æ–°ç”¨ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚‚å¿…è¦ã€‚
function animate() {
    requestAnimationFrame( animate );
    controls.update();
}</p>
<p>ã‚„ã£ã¦ã¿ã‚ˆã†ã€‚
ãƒ™ãƒ¼ã‚¹ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚·ãƒ¼ãƒ³
ã‚·ãƒ¼ãƒ³ã«é©å½“ã«ã‚­ãƒ¥ãƒ¼ãƒ–ã‚’æç”»ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã€‚
å‰å›ã®è¨˜äº‹ã‚’ã»ã¼æµç”¨ã ã‘ã©ã„ãã¤ã‹å¤‰æ›´ç‚¹ãŒã‚ã‚‹ã€‚</p>
<p>namespaceã§ã‹ã“ã£ã¦åå‰è¡çªã‹ã‚‰é˜²è¡›
CreateCameraã‚’ç‹¬ç«‹
ã‚­ãƒ¥ãƒ¼ãƒ–ãŒã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹éƒ¨åˆ†ã‚’ã‚ªãƒŸãƒƒãƒˆ</p>
<p>threejs_02.ts
/// <reference path="../../../../typings/tsd.d.ts"></reference></p>
<p>namespace Renderer02 {</p>
<pre class="code literal-block"><span class="k">class</span> <span class="n">Renderer</span> <span class="p">{</span>
    <span class="o">$</span><span class="n">container</span><span class="p">:</span> <span class="n">JQuery</span><span class="p">;</span>
    <span class="n">renderer</span><span class="p">:</span> <span class="n">THREE</span><span class="o">.</span><span class="n">Renderer</span><span class="p">;</span>

    <span class="n">scene</span><span class="p">:</span> <span class="n">THREE</span><span class="o">.</span><span class="n">Scene</span><span class="p">;</span>
    <span class="n">camera</span><span class="p">:</span> <span class="n">THREE</span><span class="o">.</span><span class="n">Camera</span><span class="p">;</span>
    <span class="n">mesh</span><span class="p">:</span> <span class="n">THREE</span><span class="o">.</span><span class="n">Mesh</span><span class="p">;</span>

    <span class="n">CreateRenderer</span><span class="p">(</span><span class="o">$</span><span class="n">container</span><span class="p">:</span> <span class="n">JQuery</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">this</span><span class="o">.$</span><span class="n">container</span> <span class="o">=</span> <span class="o">$</span><span class="n">container</span><span class="p">;</span>

        <span class="n">this</span><span class="o">.</span><span class="n">renderer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">THREE</span><span class="o">.</span><span class="n">WebGLRenderer</span><span class="p">();</span>
        <span class="n">this</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">setSize</span><span class="p">(</span><span class="o">$</span><span class="n">container</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="o">$</span><span class="n">container</span><span class="o">.</span><span class="n">height</span><span class="p">());</span>
        <span class="o">$</span><span class="n">container</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">domElement</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">CreateCamera</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">this</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="n">new</span> <span class="n">THREE</span><span class="o">.</span><span class="n">PerspectiveCamera</span><span class="p">(</span><span class="mi">75</span>
            <span class="p">,</span> <span class="n">this</span><span class="o">.$</span><span class="n">container</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">/</span> <span class="n">this</span><span class="o">.$</span><span class="n">container</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
            <span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">);</span>
        <span class="n">this</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">CreateScene</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">this</span><span class="o">.</span><span class="n">scene</span> <span class="o">=</span> <span class="n">new</span> <span class="n">THREE</span><span class="o">.</span><span class="n">Scene</span><span class="p">();</span>

        <span class="k">var</span> <span class="n">geometry</span> <span class="o">=</span> <span class="n">new</span> <span class="n">THREE</span><span class="o">.</span><span class="n">BoxGeometry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="k">var</span> <span class="n">material</span> <span class="o">=</span> <span class="n">new</span> <span class="n">THREE</span><span class="o">.</span><span class="n">MeshBasicMaterial</span><span class="p">({</span> <span class="n">color</span><span class="p">:</span> <span class="mh">0x00ff00</span> <span class="p">});</span>
        <span class="n">this</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">new</span> <span class="n">THREE</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="n">material</span><span class="p">);</span>
        <span class="n">this</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">mesh</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">Render</span><span class="p">()</span> <span class="p">{</span>
        <span class="o">//</span> <span class="n">render</span>
        <span class="n">this</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">camera</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">var</span> <span class="n">renderer</span> <span class="o">=</span> <span class="n">new</span> <span class="n">Renderer</span><span class="p">();</span>
<span class="k">export</span> <span class="n">function</span> <span class="n">initialize</span><span class="p">(</span><span class="o">$</span><span class="n">container</span><span class="p">:</span> <span class="n">JQuery</span><span class="p">)</span> <span class="p">{</span>

    <span class="n">renderer</span><span class="o">.</span><span class="n">CreateRenderer</span><span class="p">(</span><span class="o">$</span><span class="n">container</span><span class="p">);</span>
    <span class="n">renderer</span><span class="o">.</span><span class="n">CreateCamera</span><span class="p">();</span>
    <span class="n">renderer</span><span class="o">.</span><span class="n">CreateScene</span><span class="p">();</span>

    <span class="n">renderer</span><span class="o">.</span><span class="n">Render</span><span class="p">();</span>
<span class="p">}</span>
</pre>
<p>}</p>
<p>$(() =&gt; {
    var $container = $('div#renderer');
    Renderer02.initialize($container);
});</p>
<p>TypeScriptå®šç¾©ã‚’è¿½åŠ ã™ã‚‹
ã¾ãšã€TrackballControlsã®å‹å®šç¾©ã‚’è¿½åŠ ã™ã‚‹ã€‚
declare module THREE {
    export class TrackballControls
    {
        constructor(camera: THREE.Camera);
        rotateSpeed: number;
        zoomSpeed: number;
        panSpeed: number;
        noZoom: boolean;
        noPan: boolean;
        staticMoving: boolean;
        dynamicDampingFactor: number;
        keys: number[];
        addEventListener(event: string, callback: Function):void;
        update():void;
    }
}</p>
<p>TrackballControlsã‚’åˆæœŸåŒ–
// Rendererã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä¿®æ­£
    CreateCamera() {
        this.camera = new THREE.PerspectiveCamera(75
            , this.$container.width() / this.$container.height()
            , 0.1, 1000);
        this.camera.position.z = 5;</p>
<pre class="code literal-block">    <span class="c1">// ä»¥ä¸‹ã‚’è¿½åŠ </span>
    <span class="n">this</span><span class="err">.</span><span class="n">controls</span> <span class="o">=</span> <span class="n">new</span> <span class="n">THREE</span><span class="err">.</span><span class="n">TrackballControls</span><span class="p">(</span><span class="n">this</span><span class="err">.</span><span class="nb">camera</span><span class="p">);</span>

    <span class="n">this</span><span class="err">.</span><span class="n">controls</span><span class="err">.</span><span class="n">rotateSpeed</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
    <span class="n">this</span><span class="err">.</span><span class="n">controls</span><span class="err">.</span><span class="n">zoomSpeed</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">;</span>
    <span class="n">this</span><span class="err">.</span><span class="n">controls</span><span class="err">.</span><span class="n">panSpeed</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">;</span>

    <span class="n">this</span><span class="err">.</span><span class="n">controls</span><span class="err">.</span><span class="n">noZoom</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
    <span class="n">this</span><span class="err">.</span><span class="n">controls</span><span class="err">.</span><span class="n">noPan</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>

    <span class="n">this</span><span class="err">.</span><span class="n">controls</span><span class="err">.</span><span class="n">staticMoving</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="n">this</span><span class="err">.</span><span class="n">controls</span><span class="err">.</span><span class="n">dynamicDampingFactor</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>

    <span class="n">this</span><span class="err">.</span><span class="n">controls</span><span class="err">.</span><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">68</span><span class="p">];</span>

    <span class="c1">// trackballã«å¤‰åŒ–ãŒã‚ã£ãŸæ™‚ã ã‘æç”»ã‚’å‘¼ã¶</span>
    <span class="n">this</span><span class="err">.</span><span class="n">controls</span><span class="err">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="err">'</span><span class="n">change</span><span class="err">'</span><span class="p">,</span> <span class="n">this</span><span class="err">.</span><span class="n">Render</span><span class="err">.</span><span class="n">bind</span><span class="p">(</span><span class="n">this</span><span class="p">));</span>
<span class="p">}</span>
</pre>
<p>// Rendererã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ 
    Animate() {
        requestAnimationFrame(this.Animate.bind(this));
        this.controls.update();
    }</p>
<p>// Animateå‘¼ã³å‡ºã—ã‚’è¿½åŠ 
    export function initialize($container: JQuery) {</p>
<pre class="code literal-block">    renderer.CreateRenderer($container);
    renderer.CreateCamera();
    renderer.CreateScene();

    renderer.Render();
    renderer.Animate(); // è¿½åŠ 
}
</pre>
<p>å‹•ã„ãŸãŒWindowå…¨ä½“ã®ãƒã‚¦ã‚¹ã‚¤ãƒ™ãƒ³ãƒˆãŒå–ã‚‰ã‚Œã¦ã„ã¦ã“ã‚Œã˜ã‚ƒãªã„ã€‚
canvasã®è¦ªã«ãªã£ãŸdivã‚’ãƒã‚¦ã‚¹ã‚¤ãƒ™ãƒ³ãƒˆã®å¯¾è±¡ã«ã—ãŸã„ã€‚
div#rendererã‚’æ“ä½œå¯¾è±¡ã«ã™ã‚‹
TrackballControls.jsã‚’è¦‹ã¦ãŸã‚‰
THREE.TrackballControls = function ( object, domElement ) {
}</p>
<p>ã¨ã„ã†è¨˜è¿°ã‚’ç™ºè¦‹ã€‚ç¬¬ï¼’å¼•æ•°ã«htmlã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã‚’æ¸¡ã›ã‚‹ã‚‰ã—ã„ã€‚
å®šç¾©ã‚’ä¿®æ­£ã€‚
// å®šç¾©
    constructor(camera: THREE.Camera, element?: Element);</p>
<p>// å‘¼ã³å‡ºã—
   this.controls = new THREE.TrackballControls(this.camera, this.$container[0]);</p>
<p>æƒ³å®šã—ãŸå‹•ãã«ãªã£ãŸã€‚
ãƒã‚¦ã‚¹ã‚«ãƒ¼ã‚½ãƒ«ã‚’å¤‰ãˆã¦ã¿ã‚‹
cssã®è©±ã ã‘ã‚Œã©ã€‚</p>
<div id="renderer" style="width:300px;height:200px;cursor:pointer;"></div>

<pre class="code literal-block"><span class="o">$</span><span class="nt">container</span>
    <span class="p">.</span><span class="nc">mousedown</span><span class="o">(</span><span class="nt">function</span><span class="o">(</span><span class="nt">event</span><span class="o">)</span> <span class="p">{</span>
        <span class="err">switch</span> <span class="err">(event.button)</span> <span class="err">{</span>
            <span class="err">case</span> <span class="err">0:</span>
                <span class="err">$(this).css({</span> <span class="k">cursor</span><span class="p">:</span> <span class="s1">'pointer'</span> <span class="p">}</span><span class="o">);</span>
                <span class="nt">break</span><span class="o">;</span>

            <span class="nt">case</span> <span class="nt">1</span><span class="o">:</span>
                <span class="o">$(</span><span class="nt">this</span><span class="o">)</span><span class="p">.</span><span class="nc">css</span><span class="o">(</span><span class="p">{</span> <span class="k">cursor</span><span class="p">:</span> <span class="s1">'n-resize'</span> <span class="p">}</span><span class="o">);</span>
                <span class="nt">break</span><span class="o">;</span>

            <span class="nt">case</span> <span class="nt">2</span><span class="o">:</span>
                <span class="o">$(</span><span class="nt">this</span><span class="o">)</span><span class="p">.</span><span class="nc">css</span><span class="o">(</span><span class="p">{</span> <span class="k">cursor</span><span class="p">:</span> <span class="s1">'move'</span> <span class="p">}</span><span class="o">);</span>
                <span class="nt">break</span><span class="o">;</span>
        <span class="err">}</span>
    <span class="err">}</span><span class="o">)</span>
    <span class="p">.</span><span class="nc">mouseup</span><span class="o">(</span><span class="nt">function</span><span class="o">(</span><span class="nt">event</span><span class="o">)</span><span class="p">{</span>
        <span class="err">$(this).css({</span><span class="k">cursor</span><span class="p">:</span> <span class="s1">'pointer'</span><span class="p">}</span><span class="o">);</span>
    <span class="err">}</span><span class="o">)</span>
<span class="o">;</span>
</pre>

<hr>
<ul class="pager hidden-print">
<li class="previous">
        <a href="../threejs_03/" rel="prev" title="ã‚°ãƒªãƒƒãƒ‰ã¨è»¸ã¨å…‰æºã¨FPSè¡¨ç¤ºã‚’å…¥ã‚Œã‚‹">
            ã‚°ãƒªãƒƒãƒ‰ã¨è»¸ã¨å…‰æºã¨FPSè¡¨ç¤ºã‚’å…¥ã‚Œã‚‹ ğŸ‘ˆ
        </a>
    </li>
    <li style="flex-grow: 1">
    <li class="next">
        <a href="../threejs_01/" rel="next" title="TypeScriptã§Three.jsã“ã¨ã¯ã˜ã‚">
            ğŸ‘‰ TypeScriptã§Three.jsã“ã¨ã¯ã˜ã‚
        </a>
    </li>
</ul></main><footer id="footer"><p>
            Powered by
            <a href="https://getnikola.com" rel="nofollow">Nikola</a>
        </p>
    </footer>
</body>
</html>
