<!DOCTYPE html><html lang="ja"><head><link rel="icon" type="image/svg+xml" href="/favicon.svg"><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="Astro v3.4.3"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://ousttrue.github.io/posts/2020/w3m-mod/"><!-- Primary Meta Tags --><title></title><meta name="title"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://ousttrue.github.io/posts/2020/w3m-mod/"><meta property="og:title"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://ousttrue.github.io/posts/2020/w3m-mod/"><meta property="twitter:title"><style>:root{--accent: #2337ff;--accent-dark: #000d8a;--black: 15, 18, 25;--gray: 96, 115, 159;--gray-light: 229, 233, 240;--gray-dark: 34, 41, 57;--gray-gradient: rgba(var(--gray-light), 50%), #fff;--box-shadow: 0 2px 6px rgba(var(--gray), 25%), 0 8px 24px rgba(var(--gray), 33%), 0 16px 32px rgba(var(--gray), 33%)}@font-face{font-family:Atkinson;src:url(/fonts/atkinson-regular.woff) format("woff");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Atkinson;src:url(/fonts/atkinson-bold.woff) format("woff");font-weight:700;font-style:normal;font-display:swap}body{font-family:Atkinson,sans-serif;margin:0;padding:0;text-align:left;background:linear-gradient(var(--gray-gradient)) no-repeat;background-size:100% 600px;word-wrap:break-word;overflow-wrap:break-word;color:rgb(var(--gray-dark));font-size:20px;line-height:1.7}main{width:720px;max-width:calc(100% - 2em);margin:auto;padding:3em 1em}h1,h2,h3,h4,h5,h6{margin:0 0 .5rem;color:rgb(var(--black));line-height:1.2}h1{font-size:2em}h2{font-size:1.8em}h3{font-size:1.6em}h4{font-size:1.4em}h5{font-size:1.2em}strong,b{font-weight:700}a,a:hover{color:var(--accent)}p{margin-bottom:1em}.prose p{margin-bottom:2em}textarea{width:100%;font-size:16px}input{font-size:16px}table{width:100%}img{max-width:100%;height:auto;border-radius:8px}code{padding:2px 5px;background-color:rgb(var(--gray-light));border-radius:2px}pre{padding:1.5em;border-radius:8px}pre>code{all:unset}blockquote{border-left:4px solid var(--accent);padding:0 0 0 20px;margin:0;font-size:1.333em}hr{border:none;border-top:1px solid rgb(var(--gray-light))}@media (max-width: 720px){body{font-size:18px}main{padding:1em}}.sr-only{border:0;padding:0;margin:0;position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);clip-path:inset(50%);white-space:nowrap}.date{margin-bottom:.5em;color:rgb(var(--gray))}.tags{display:flex;flex-wrap:wrap}.tag{margin:.25em;border:dotted 1px #a1a1a1;border-radius:.5em;padding:.5em 1em;font-size:1.15em;background-color:#f8fcfd}a[data-astro-cid-eimmu3lg]{display:inline-block;text-decoration:none}a[data-astro-cid-eimmu3lg].active{font-weight:bolder;text-decoration:underline}header[data-astro-cid-3ef6ksr2]{margin:0;padding:0 1em;background:white;box-shadow:0 2px 8px rgba(var(--black),5%)}h2[data-astro-cid-3ef6ksr2]{margin:0;font-size:1em}h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2],h2[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none}nav[data-astro-cid-3ef6ksr2]{display:flex;align-items:center;justify-content:space-between}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{padding:1em .5em;color:var(--black);border-bottom:4px solid transparent;text-decoration:none}nav[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2].active{text-decoration:none;border-bottom-color:var(--accent)}.social-links[data-astro-cid-3ef6ksr2],.social-links[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{display:flex}@media (max-width: 720px){.social-links[data-astro-cid-3ef6ksr2]{display:none}}footer[data-astro-cid-sz7xmlte]{padding:2em 1em 6em;background:linear-gradient(var(--gray-gradient)) no-repeat;color:rgb(var(--gray));text-align:center}.social-links[data-astro-cid-sz7xmlte]{display:flex;justify-content:center;gap:1em;margin-top:1em}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]{text-decoration:none;color:rgb(var(--gray))}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]:hover{color:rgb(var(--gray-dark))}
</style></head><body><header data-astro-cid-3ef6ksr2><nav data-astro-cid-3ef6ksr2><h2 data-astro-cid-3ef6ksr2><a href="/" data-astro-cid-3ef6ksr2>ä¸‰æ¬¡å…ƒæ—¥èªŒ(Astro)</a></h2><div class="internal-links" data-astro-cid-3ef6ksr2><a href="/tags/" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg>Tags</a><a href="/about" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg>About</a></div><div class="social-links" data-astro-cid-3ef6ksr2><a href="https://github.com/ousttrue/" target="_blank" data-astro-cid-3ef6ksr2><span class="sr-only" data-astro-cid-3ef6ksr2>Go to Astro's GitHub repo</span><svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path></svg></a></div></nav></header><main><article><div class="prose"><div class="title"><div class="date"><time datetime="2020-07-25T14:59:50.000Z">2020
-07
-25</time></div><a href="/posts/2020/w3m-mod"><h1>w3mæ”¹é€ </h1></a><div class="tags"><p class="tag"><a href="/tags/w3m">w3m</a></p></div></div></div><p>ä»¥å‰ã«ã‚‚ä½•åº¦ã‹ã‚„ã£ãŸã“ã¨ãŒã‚ã‚‹ã®ã ã‘ã©ç«‹ã¡æ¶ˆãˆã«ãªã£ã¦ã„ãŸã€ <a href="http://w3m.sourceforge.net/index.ja.html">w3m</a> ã®æ”¹é€ ã‚’è©¦ã¿ã¦ã„ã‚‹ã€‚
w3m ã¯ã‚ã‚Šã¨å¥½ããªãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ©ã‚¦ã‚¶ãªã®ã ãŒã€ 2011 å¹´ãã‚‰ã„ã® 0.5.3 ã§é–‹ç™ºãŒçµ‚äº†ã—ã¦ã„ã‚‹æ§˜å­ã€‚</p>
<p><a href="https://github.com/ousttrue/w3m">https://github.com/ousttrue/w3m</a></p>
<p>ã¾ãšã¯ <code>C++</code> åŒ–ã—ã¦ã‹ã‚‰ã€HTMLå‡¦ç†ãªã©ã‚’å†å…¥å¯èƒ½ã«ã—ã¦ã‚¿ãƒ–ã”ã¨ã«ã‚¹ãƒ¬ãƒƒãƒ‰ç‹¬ç«‹ã™ã‚‹æ–¹å‘ã‚’ç›®æŒ‡ã™ã€‚
åŒæ™‚ã«ã€ <code>boehm-GC</code> ã‚’å°‘ã—ãšã¤ <code>STL</code> ã®ã‚³ãƒ³ãƒ†ãƒŠã‚„ <code>std::string</code> ã«ç½®ãæ›ãˆã‚‹ã€‚
ã©ã†ã‚‚ã€<code>c++</code> ã¨ <code>boehm-GC</code> ã®å…±å­˜ã™ã‚‹ã®ã«æŠ€ãŒã„ã‚‹ã‚‰ã—ãã€é©å½“ã«ç½®ãæ›ãˆã¦ã„ãã¨ãƒ¡ãƒ¢ãƒªç ´å£Šã§æ­»ã¬ã€‚<code>boehm-GC</code> ã‚’ã™ã¹ã¦ç½®ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã€‚<code>C++</code> ã‚¯ãƒ©ã‚¹ã®ãƒ¡ãƒ³ãƒãƒ¼ã« <code>GC</code> ãŒè¦ã‚‹ã€<code>GC struct</code> ã®ãƒ¡ãƒ³ãƒãƒ¼ã« <code>C++</code> ã‚¯ãƒ©ã‚¹ãŒå±…ã‚‹ã®ä¸¡æ–¹ã«å•é¡ŒãŒã‚ã‚‹ã£ã½ã„ã€‚ä¸€å¿œã€ <code>gc_cleanup</code> ã‚’ç¶™æ‰¿ã—ãŸã‚Šã—ã¦ã„ã‚‹ã®ã ã‘ã©ã€ã‚„ã‚Šæ–¹ãŒã¾ãšã„ã½ã„ã€‚</p>
<p>æ”¹é€ ã«ã‚ãŸã£ã¦ãªã‚‹ã¹ãæ©Ÿèƒ½ã‚’ç¶­æŒã—ã‚ˆã†ã¨ã—ã¦ã„ãŸã®ã ã‘ã©ã€ã‚ã‚‹ç¨‹åº¦ã‚ã‚Šãã£ã¦æ©Ÿèƒ½ã‚’è½ã¨ã•ãªã„ã¨æ‰‹ã«è² ãˆãªã„ã¨ã“ã‚ãŒã‚ã‚‹ã€‚</p>
<ul>
<li>http + https ä»¥å¤–ã®é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯è½ã¨ã™ã€‚NNTP ã¨ã‹ Gopher ä½¿ã£ãŸã“ã¨ãªã„ã—ãªãƒ¼ã€FTPã‚‚ã„ã£ãŸã‚“è½ã¨ã™</li>
<li>backend, dump, halfload ç­‰ã®å‡ºåŠ›ã«ä»‹å…¥ã™ã‚‹æ©Ÿèƒ½ã¯è½ã¨ã™ã€‚ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚€ã®ãŒå¤§å¤‰</li>
<li>M17N, COLOR, IMAGE, MENU ã¯æ®‹ã™</li>
<li>Mouse ã¯å¾®å¦™ã€‚å‰Šã£ã¦ã‚‚ã‚ˆã„ã‹ã‚‚</li>
<li>GetText ã‚‚å‰Šã‚‹</li>
</ul>
<p>é‡ã‚’æ¸›ã‚‰ã™ã€‚æ€ã£ãŸã‚ˆã‚Šã‚³ãƒ¼ãƒ‰ãŒå¤šã‹ã£ãŸã®ã ã€‚</p>
<h1 id="ä¸‹æº–å‚™">ä¸‹æº–å‚™</h1>
<h2 id="msys2-ã§ã¨ã‚Šã‚ãˆãšãƒ“ãƒ«ãƒ‰">msys2 ã§ã¨ã‚Šã‚ãˆãšãƒ“ãƒ«ãƒ‰</h2>
<p>WSL Ubuntu ã ã¨ãƒ“ãƒ«ãƒ‰ã§ããªã‹ã£ãŸã€‚
ã—ã‹ã—ã€msys2 ãªã‚‰ã‚ã‚Šã¨ç°¡å˜ã«ãƒ“ãƒ«ãƒ‰ã§ãã‚‹ã“ã¨ã‚’ç™ºè¦‹ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="plaintext"><code><span class="line"><span>$ pacman -S make gcc libgc-devel openssl-devel ncurses-devel</span></span>
<span class="line"><span>$ x86_64-pc-msys-gcc --version</span></span>
<span class="line"><span>x86_64-pc-msys-gcc (GCC) 9.3.0</span></span>
<span class="line"><span>Copyright (C) 2019 Free Software Foundation, Inc.</span></span>
<span class="line"><span>This is free software; see the source for copying conditions.  There is NO</span></span>
<span class="line"><span>warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span></span>
<span class="line"><span>$ ./configure</span></span></code></pre>
<p>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ç’°å¢ƒã®æ–¹ãŒæ˜”ã¨å¤‰ã‚ã£ã¦ã—ã¾ã£ã¦ãƒ“ãƒ«ãƒ‰ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚</p>
<p>ä¿®æ­£æ–¹æ³•ğŸ‘‡</p>
<p><a href="https://qiita.com/imkitchen/items/02a9df7baaaf434fee66">[CentOS7] emacs24ã«emacs-w3mã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></p>
<p><code>#ifdef</code> ã®èª¿æ•´</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="plaintext"><code><span class="line"><span>// config.h</span></span>
<span class="line"><span>//#define USE_BINMODE_STREAM 1</span></span>
<span class="line"><span>//#define USE_EGD</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="plaintext"><code><span class="line"><span>$ make</span></span>
<span class="line"><span>$ ./w3m www.google.com // å‹•ã„ãŸ</span></span></code></pre>
<h2 id="wsl-ã§-gc-ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹å•é¡Œ">WSL ã§ GC ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹å•é¡Œ</h2>
<p><code>boehm-GC</code> ãŒãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã“ã¨ã§ã€ <code>make</code> ä¸­ã®ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ <code>mktable</code> ãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã®ãŒåŸå› ã§ãƒ“ãƒ«ãƒ‰ã‚¹ãƒ†ãƒƒãƒ—ãŒé€”ä¸­ã§æ­¢ã¾ã‚‹ã®ãŒåŸå› ã ã£ãŸã€‚ãªã®ã§ã€ãŸã¨ãˆãƒ“ãƒ«ãƒ‰æ¸ˆã¿ã® <code>w3m</code> ã‚’ <code>apt get</code> ã—ã¦ã‚‚ã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚‚åŒã˜åŸå› ã§ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã€‚</p>
<p>ã‚¨ãƒ©ãƒ¼ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="plaintext"><code><span class="line"><span>Wrong __data_start/_end pair</span></span>
<span class="line"><span>fish: './build/w3m' terminated by signal SIGABRT (Abort)</span></span></code></pre>
<p><a href="https://hitkey.nekokan.dyndns.info/diary2004.php#D200424">https://hitkey.nekokan.dyndns.info/diary2004.php#D200424</a></p>
<p>ã«ã‚ˆã‚‹ã¨ã€stack size ã®åˆ¶é™ãŒåŸå› ã‚‰ã—ã„ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="plaintext"><code><span class="line"><span>$ ulimit -s</span></span>
<span class="line"><span>8192</span></span></code></pre>
<p>WSL ã§ã“ã‚Œã‚’å¤‰ãˆã‚‹ã«ã¯ãƒ»ãƒ»ãƒ»ã€‚</p>
<p><a href="https://github.com/microsoft/WSL/issues/633">https://github.com/microsoft/WSL/issues/633</a></p>
<p>ç„¡ç†ã€‚</p>
<p><code>WSL2</code> ãªã‚‰ã§ãã‚‹ï¼Ÿ</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="plaintext"><code><span class="line"><span>> wsl -l -v</span></span>
<span class="line"><span>  NAME            STATE           VERSION</span></span>
<span class="line"><span>* Ubuntu-20.04    Running         2</span></span></code></pre>
<p>ã‚„ã£ã¦ã¿ã‚‹ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="plaintext"><code><span class="line"><span>$ ulimit -s unlimited</span></span>
<span class="line"><span>> ulimit -s</span></span>
<span class="line"><span>unlimited</span></span></code></pre>
<p>ã§ããŸã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="plaintext"><code><span class="line"><span>$ w3m</span></span>
<span class="line"><span>Wrong __data_start/_end pair</span></span></code></pre>
<p>ã†ãƒ¼ã‚€ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="plaintext"><code><span class="line"><span>$ ulimit -s 81920</span></span>
<span class="line"><span>> ulimit -s</span></span>
<span class="line"><span>81920</span></span></code></pre>
<p>å‹•ã„ãŸã€‚
8192KB ã§ã¯è¶³ã‚Šãªãã€ unlimited ã§ã¯å¤šã™ãã‚‹ã‚‰ã—ã„ã€‚ã“ã‚Œã¯ã€é›£ã—ã„ãªã€‚</p>
<p>ã¡ãªã¿ã«ã€ <code>gdb</code> ä¸Šãªã‚‰ã‚¹ã‚¿ãƒƒã‚¯å•é¡Œã‚’è§£æ±ºã—ãªãã¦ã‚‚å‹•ã„ãŸã€‚
<code>gdb</code> ãŒã‚¹ã‚¿ãƒƒã‚¯ã‚’è¦†ã„éš ã™ã®ã‹ãªï¼Ÿ
é–‹ç™ºã ã‘ãªã‚‰ã§ããªãã‚‚ãªã„ã€‚</p>
<h2 id="ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ">ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ </h2>
<p>ã¨ã‚Šã‚ãˆãšæ…£ã‚ŒãŸãƒ„ãƒ¼ãƒ«ã«å¤‰æ›´ã€‚
WSL ä¸Šã® vscode ã§ä½œæ¥­ã—ã¦ã„ã‚‹ã®ã‚‚ã‚ã‚Šã€autotools ã‹ã‚‰ CMake ã«å¤‰æ›´ã€‚
ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¯å¾Œé€€ã•ã›ã¦ã€æ–°ã—ã‚ã® gcc(c++20) ã§ãƒ“ãƒ«ãƒ‰ã§ãã‚Œã°ã„ã„ã‚„ã€‚
config.h ã‚„ funcname ç³»ã®ã‚³ãƒ¼ãƒ‰ç”Ÿæˆçµæœã¯ã‚³ãƒŸãƒƒãƒˆã—ã¡ã‚ƒã†ã€‚
libwc ãŒ static ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ã‹ã‚Œã¦ã„ã‚‹ã®ã‚‚ã€ã²ã¨ã¾ã¨ã‚ã«ã—ã¦ã—ã¾ã£ãŸã€‚
ã‚ã¨ã€é©å½“ã«ã‚½ãƒ¼ã‚¹ã‚’ãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•ã™ã‚‹ã€‚</p>
<p>ç”Ÿæˆã‚³ãƒ¼ãƒ‰ä¸€è¦§</p>



























































<table><thead><tr><th>ãƒ•ã‚¡ã‚¤ãƒ«</th><th>ç”Ÿæˆæ–¹æ³•</th><th>å…¥åŠ›</th><th>å‚™è€ƒ</th></tr></thead><tbody><tr><td>config.h</td><td>configure</td><td></td><td>å„ç¨® #define ãªã©</td></tr><tr><td>entity.h</td><td>Makefile(mktable)</td><td>entity.tab</td><td>./mktable 100 entity.tab > entity.h</td></tr><tr><td>funcname.tab</td><td>Makefile(awk)</td><td>main.c, menu.c</td><td></td></tr><tr><td>funcname.c</td><td>Makefile(awk)</td><td>funcname.tab</td><td>sort funcname.tab ï½œ awk -f funcname0.awk > funcname.c</td></tr><tr><td>funcname1.h</td><td>Makefile(awk)</td><td>funcname.tab</td><td></td></tr><tr><td>funcname2.h</td><td>Makefile(awk)</td><td>funcname.tab</td><td></td></tr><tr><td>functable.c</td><td>Makefile(mktable)</td><td>funcname.tab</td><td></td></tr><tr><td>tagtable.c</td><td>Makefile(mktable)</td><td>funcname.tab</td><td></td></tr></tbody></table>
<h2 id="è­¦å‘Šã‹ã‚‰ã‚¨ãƒ©ãƒ¼ã«å¼•ãä¸Šã’">è­¦å‘Šã‹ã‚‰ã‚¨ãƒ©ãƒ¼ã«å¼•ãä¸Šã’</h2>
<p>æ”¹é€ ã—ã¦ã„ãã®ã« <code>C</code> ã®ç·©ã„å‹åˆ¶é™ãŒå±é™º(ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚‹ã®ã«å‹ãŒä¸ä¸€è‡´ã«ãªã‚Šã‚„ã™ã„)ãªã®ã§ã€
ä»¥ä¸‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="plaintext"><code><span class="line"><span>-Werror=implicit-function-declaration</span></span>
<span class="line"><span>-Werror=int-conversion</span></span>
<span class="line"><span>-Werror=conversion-null</span></span></code></pre>
<p>ã“ã‚Œã§ã€å‹å®£è¨€ã‚’è£œå¼·ã—ãªãŒã‚‰é€²ã‚ã‚‹ã€‚</p>
<h1 id="ç¬¬1æ®µéš">ç¬¬1æ®µéš</h1>
<ul>
<li>extern â€œCâ€ ã‚’è¿½åŠ ã—ã¦ã‚½ãƒ¼ã‚¹ã®æ‹¡å¼µå­ã‚’ <code>.cpp</code> ã«å¤‰æ›´</li>
<li>extern â€œCâ€ ã‚’ã¾ã¨ã‚ã¦å–ã‚Šé™¤ã</li>
<li>typedef struct tag ã‚’å–ã‚Šé™¤ã</li>
</ul>
<p>ã“ã“ã¾ã§ã‚„ã‚‹ã¨ã€è‡ªç”±ã« <code>c++</code> ã®ã‚³ãƒ¼ãƒ‰ã‚’æ··ãœã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
<code>std::string</code>ã€<code>std::vector</code>, <code>std::shared_ptr</code>, <code>std::function</code>, <code>std::string_view</code>, <code>template</code>, <code>class</code>, å‰æ–¹å®£è¨€, <code>auto</code>, <code>inline</code> ç­‰ä½¿ã„æ”¾é¡Œ ğŸ‘</p>
<p>ç‰¹ã« <code>std::string_view</code> ã®ä½¿ã„å‹æ‰‹ã‚’è©¦ã—ãŸã„ã€‚
æ‰€æœ‰ã—ãªã„æ–‡å­—åˆ—ã¯ã™ã¹ã¦ã€ <code>std::string_view</code> ã§ã„ã‘ã‚‹ã¨æ€ã†ã®ã ãŒã€‚
<code>split</code> ã® <code>std::string_view</code> ç‰ˆã¯å…·åˆãŒã‚ˆã‹ã£ãŸã€‚</p>
<h2 id="c-åŒ–-extern-c">c++ åŒ– (extern â€œCâ€)</h2>
<p>æ‰‹æ³•ã¨ã—ã¦ã¯ã€å„ã‚½ãƒ¼ã‚¹ã®æ‹¡å¼µå­ã‚’ <code>.c</code> ã‹ã‚‰ <code>.cpp</code> ã«å¤‰æ›´ã™ã‚‹ã€‚
<code>CMakeLists.txt</code> ã‚’ä¿®æ­£ã€‚
<code>#include</code> ã‚’ <code>extern "C"</code> ã§å›²ã‚€ã€ã§ <code>c++</code> åŒ–ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="c++"><code><span class="line"><span style="color:#F97583">extern</span><span style="color:#9ECBFF"> "C"</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">#include</span><span style="color:#9ECBFF"> "xxx.h"</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>ãŸã ã€ <code>cpp</code> ã§å®šç¾©ã™ã‚‹é–¢æ•°ã®å®£è¨€ãŒ <code>extern "C"</code> ã®ä¸­ã«å…¥ã‚‰ãªã„ã¨ãƒªãƒ³ã‚¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã®ã§ã€
ãã†ãªã‚‹ã‚ˆã†ã«ã‚½ãƒ¼ã‚¹ã”ã¨ã«ãƒ˜ãƒƒãƒ€ã‚’åˆ†é…ã—ã¦ã‚„ã‚‹ã€‚
<code>w3m</code> ã¯é–¢æ•°å®£è¨€ãŒå°‘æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ« <code>proto.h</code>, <code>fm.h</code> ã¨ã‹ã«é›†ä¸­ã—ã¦ã„ã‚‹ã®ã ãŒã€ã„ã£ã±ã„ã‚ã‚‹ã®ã§é›‘ã«ã‚„ã‚‹ã€‚
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚Œã°ã‚ˆã„ã€‚</p>
<p>åˆ†é…ã™ã‚‹ã¨ãã«æœªå®šç¾©ã®å‹ã‚’å‰æ–¹å®£è¨€ã§ã™ã¾ã›ãŸã„ã®ã ã‘ã©ã€ <code>c</code> ã® <code>struct</code> å®šç¾©ãŒã€<code>struct tag</code> ã¨ <code>typedef</code> ã«åˆ†ã‹ã‚Œã¦ã„ã‚‹ã®ãŒã‚„ã£ã‹ã„ã ã£ãŸã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="c"><code><span class="line"><span style="color:#6A737D">// C</span></span>
<span class="line"><span style="color:#F97583">typedef</span><span style="color:#F97583"> struct</span><span style="color:#E1E4E8"> hogeTag</span></span>
<span class="line"><span style="color:#E1E4E8">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">} Hoge;</span></span></code></pre>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="c"><code><span class="line"><span style="color:#F97583">void</span><span style="color:#B392F0"> DoHoge</span><span style="color:#E1E4E8">(Hoge </span><span style="color:#F97583">*</span><span style="color:#FFAB70">p</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// ã«å¯¾ã™ã‚‹å‰æ–¹å®£è¨€ã¯ã€</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">struct</span><span style="color:#E1E4E8"> hogeTag;</span></span>
<span class="line"><span style="color:#F97583">typedef</span><span style="color:#E1E4E8"> hogeTag Hoge;</span></span></code></pre>
<p><code>C</code> ã®çŠ¶æ…‹ã§ã€å‰æ–¹å®£è¨€ã‚’å°å…¥ã§ããšãƒ˜ãƒƒãƒ€ã®åˆ†å‰²ãŒé›£èˆªã€‚
å‹ã”ã¨ã«åˆ¥ã®ãƒ˜ãƒƒãƒ€ã«åˆ†å‰²ã™ã‚‹ã“ã¨ã¯æ–­å¿µã—ã¦ã€
ã»ã¨ã‚“ã©å…¨éƒ¨ã® <code>struct</code> å®šç¾©ã®å…¥ã£ãŸãƒ˜ãƒƒãƒ€ã‚’ <code>fm.h</code> ã‹ã‚‰åˆ†é›¢ã—ã¦ä½œã‚‹ã®ã«ç•™ã‚ãŸã€‚</p>
<h2 id="defun">DEFUN</h2>
<p><code>w3m</code> ã¯ <code>DEFUN</code> ã§ã‚­ãƒ¼ã‚¢ã‚µã‚¤ãƒ³ã§ãã‚‹é–¢æ•°ã‚’å®šç¾©ã—ã¦ã„ã‚‹ã€‚</p>
<p><a href="/w3m/doc-jp/readme.func/">readme.func</a></p>
<p>ä»¥ä¸‹ã®ã‚ˆã†ã«ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãªã©ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã„ã†ã‚¤ãƒ¡ãƒ¼ã‚¸ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="plaintext"><code><span class="line"><span>Key</span></span>
<span class="line"><span>    KeyMap</span></span>
<span class="line"><span>        DEFUN</span></span>
<span class="line"><span>    Menu</span></span>
<span class="line"><span>        DEFUN</span></span>
<span class="line"><span>MouseAction</span></span>
<span class="line"><span>    ActionMap</span></span>
<span class="line"><span>        DEFUN</span></span>
<span class="line"><span>    Menu</span></span>
<span class="line"><span>        DEFUN</span></span>
<span class="line"><span>Alarm</span></span>
<span class="line"><span>    DEFUN</span></span></code></pre>
<p>ã‚½ãƒ¼ã‚¹ã¯ã€<code>main.c</code> ã¨ <code>menu.c</code> ã« <code>DEFUN</code> ã¨ãã‚Œã®ä½¿ã†è£œåŠ©é–¢æ•°ãŒã¾ã¨ã‚ã¦å®šç¾©ã•ã‚Œã¦ã„ã¦ã€
ãƒ˜ãƒƒãƒ€ã¯ <code>proto.h</code> ã«å…¨éƒ¨å…¥ã‚Œã¨ãªã£ã¦ã„ã‚‹ã€‚</p>
<p>c++ ã§ä¸‹è¨˜ã®ã‚ˆã†ãªãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒãƒ£ã‚’ä½œã£ãŸã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="c++"><code><span class="line"><span style="color:#F97583">typedef</span><span style="color:#F97583"> void</span><span style="color:#E1E4E8"> (*Command)();</span></span>
<span class="line"><span style="color:#B392F0">std</span><span style="color:#E1E4E8">::unordered_map</span><span style="color:#F97583">&#x3C;</span><span style="color:#B392F0">std</span><span style="color:#E1E4E8">::string, Command</span><span style="color:#F97583">></span><span style="color:#E1E4E8"> g_commandMap;</span></span></code></pre>
<p>ä½¿ã„æ¨ã¦ã® python ã§é–¢æ•°ã«ç™»éŒ²ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ãŸã€‚</p>
<h1 id="ç¬¬ï¼’æ®µéš">ç¬¬ï¼’æ®µéš</h1>
<ul>
<li>PODã˜ã‚ƒãªã„å‹ãŒå‹•ãã‚ˆã†ã«ã™ã‚‹
<ul>
<li>constructor/destructor</li>
</ul>
</li>
<li>è„±GC
<ul>
<li>ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’STLã«ç½®ãæ›ãˆã‚‹</li>
<li>std::string</li>
<li>std::shared_ptr</li>
</ul>
</li>
<li>æ©Ÿèƒ½ã”ã¨ã«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–</li>
<li>å†å…¥å¯èƒ½</li>
</ul>
<h2 id="gc_malloc-ã‹ã‚‰-gc_cleanup-ç¶™æ‰¿ã¸">GC_MALLOC ã‹ã‚‰ gc_cleanup ç¶™æ‰¿ã¸</h2>
<p>boehm-GC ã‚’ <code>c++</code> ã®ã‚¯ãƒ©ã‚¹ã§ä½¿ã†æ–¹æ³•ã‚’èª¿ã¹ãŸã€‚</p>
<p><a href="http://www.namikilab.tuat.ac.jp/~sasada/prog/boehmgc.html#i-0-5">http://www.namikilab.tuat.ac.jp/~sasada/prog/boehmgc.html#i-0-5</a></p>
<p><code>w3m</code> ã§ã¯ã€ <code>GC</code> ã‚’å¤šç”¨ã—ã¦ã„ã‚‹ã€‚</p>
<p>ãŠã‚‚ã«ã€</p>
<ul>
<li>struct Str</li>
<li>ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³</li>
<li>struct ã® field</li>
</ul>
<p>ã¨ã„ã†æ„Ÿã˜ã«ã€‚
ã“ã®ã†ã¡ã€ struct ã® field ã§ä½¿ã‚ã‚Œã‚‹ã‚¿ã‚¤ãƒ—ã®å˜ç™ºã® <code>GC_MALLOC</code> ã—ã¦ã„ã‚‹å‹ã‚’ <code>gc_cleanup</code> ç¶™æ‰¿ã«ã—ã¦ã€ <code>new</code> ã§åˆæœŸåŒ–ã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚</p>
<ul>
<li>bzero, bcopy, memcpy, sizeof</li>
</ul>
<p>ç­‰ã§ãƒ¡ãƒ¢ãƒªã‚¯ãƒªã‚¢ã—ã¦ã„ã‚‹ã¨ã“ã‚ã«æ³¨æ„ã™ã‚‹ã€‚
ã“ã‚Œã§ã€ãã®å‹ã¯ <code>constructor/destructor</code> ãŒå‹•ãã‚ˆã†ã«ãªã‚Šã€
ãƒ¡ãƒ³ãƒãƒ¼ã« <code>std::string</code> ç­‰ã‚’é…ç½®ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚
ã‚ã¨ã§ã€ <code>gc_cleanup</code> ã‹ã‚‰ <code>std::shared_ptr</code> ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚è¦–é‡ã«å…¥ã‚Œã¦ã„ã‚‹ã€‚</p>
<h2 id="gcæ–‡å­—åˆ—-str">GCæ–‡å­—åˆ— Str</h2>
<p>ã‚¢ãƒ—ãƒªå…¨ä½“ã§ä½¿ã‚ã‚Œã¦ã„ã¦ä¸€æŒ™ã«ãªãã™ã“ã¨ã¯ã§ããªã„ã®ã ã‘ã©ã€æ§‹é€ ä½“ã®æœ«ç«¯ã®ãƒ¡ãƒ³ãƒãƒ¼ã‹ã‚‰ <code>std::string</code> ã«å¤‰ãˆã‚‹ã€‚
ã‚ã¨ã€ãŒã‚“ã°ã£ã¦ <code>const char *</code> ã®ç¯„å›²ã‚’å¢—ã‚„ã™ã€‚
<code>libwc</code> ã‹ã‚‰ <code>Str</code> ã‚’å‰¥ãã†ã¨æ€ã£ã¦ã„ãŸã®ã ãŒã€é€†ã« <code>libwc</code> ã« <code>Str</code> ã‚’å°ã˜è¾¼ã‚ã‚‹æ–¹å‘ã«è»Œé“ä¿®æ­£ã€‚
<code>indep.c</code> ã®ä¾¿åˆ©æ–‡å­—åˆ—é–¢æ•°ã‚‚å°‘ã—ãšã¤å¤‰ãˆã¦ãã€‚</p>
<h2 id="ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚’æ¸›ã‚‰ã™">ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚’æ¸›ã‚‰ã™</h2>
<p>é–¢æ•°ã®ä¸­ã§ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹å ´åˆ(CurrentBufferãªã©)ã€ã“ã‚Œã‚’é–¢æ•°ã®å¼•æ•°çµŒç”±ã¨ã‹ã€ã‚¯ãƒ©ã‚¹ã®ãƒ¡ãƒ³ãƒãƒ¼çµŒç”±ã§ã‚‚ã‚‰ã†ã€‚é¢å€’ã§ã‚‚ Getter ã¨ Setter ã‚’åŒºåˆ¥ã—ã¦ã€ã©ã“ã§å¤‰æ›´ã•ã‚Œã†ã‚‹ã‹ã‚ã‹ã‚Šã‚„ã™ãã™ã‚‹ã€‚
ã‚¯ãƒ©ã‚¹ã®ãƒ¡ãƒ³ãƒãƒ¼ã¯ã€ <code>private</code> åŒ–ã‚’è©¦ã¿ã‚‹ã€‚</p>
<h2 id="streamå‡¦ç†">Streamå‡¦ç†</h2>
<p>å¤šåˆ†ã€æœ€é›£é–¢ã® <code>loadGeneralFile</code> é–¢æ•°ã€‚700è¡Œãã‚‰ã„ã ã£ãŸã‹ã€‚
goto ã¨ã‹ longjmp ãŒã‚ã£ã¦ã‚ˆãã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã ãŒã€æ…£ã‚Œã¦ããŸã€‚
<code>http</code>, <code>https</code>, <code>NNTP ?</code>, <code>gopher</code>, <code>ftp</code>, <code>pipe</code> ç­‰ã€<code>http</code> ã®ãƒ—ãƒ­ã‚­ã‚·ãƒ¼ã‚„ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã€ <code>www-auth</code> ãªã©ã‚’ä¸€æ‰‹ã«å‡¦ç†ã—ã¦ã„ã¦å®¹æ˜“ã«æ‰‹ã‚’ä»˜ã‘ã‚‰ã‚Œãªã„ã€‚
ä½•åº¦ã‹æ•´ç†ã—ã‚ˆã†ã¨ã—ã¦æ‚‰ãæ’ƒé€€ã•ã‚ŒãŸã®ã§ã€é›‘ã«ã‚„ã‚‹ã“ã¨ã«ã—ãŸã€‚
æ©Ÿèƒ½ã‚’ <code>http(https)</code> ã«çµã£ã¦ãã‚Œä»¥å¤–ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ã¨ã«ã‹ãé‡ã‚’æ¸›ã‚‰ã™ã€‚
ãƒ—ãƒ­ã‚­ã‚·ãƒ¼ã¨ã‹ã€ <code>dump</code>, <code>halfload</code> ãªã©ã®ã‚ˆãçŸ¥ã‚‰ãªã„æ©Ÿèƒ½ã‚‚ã©ã‚“ã©ã‚“å‰Šã‚‹ã€‚
ã¨ã—ã¦ãªã‚“ã¨ã‹æ”¹é€ ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ããŸã€‚</p>
<p>ã“ã“ã‚’ <code>HttpClient</code>, <code>LocalFile</code>, <code>PipeReader</code> ã‚ãŸã‚Šã«æ•´ç†ã—ãŸã„ã€‚</p>
<h1 id="ç¬¬ï¼“æ®µéš">ç¬¬ï¼“æ®µéš</h1>
<p>Tab, Buffer, Line ã®ãƒªãƒ³ã‚¯ãƒªã‚¹ãƒˆã‚’ STL ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«ç½®ãæ›ãˆãŸã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="c++"><code><span class="line"><span style="color:#F97583">auto</span><span style="color:#E1E4E8"> buf </span><span style="color:#F97583">=</span><span style="color:#B392F0"> load</span><span style="color:#E1E4E8">(url);</span></span>
<span class="line"><span style="color:#E1E4E8">tab-></span><span style="color:#B392F0">push</span><span style="color:#E1E4E8">(buf);</span></span></code></pre>
<p>ã¨ã„ã†å½¢ã‚’ç›®æŒ‡ã™ã€‚</p>
<p><code>loadGeneralFile</code> ã‚’è§£ãã»ãã—ã¦ã€ <code>HTTP</code> æ©Ÿèƒ½ã‚’æŠ½å‡ºã€ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã¾ã§å‹•ãã‚ˆã†ã«ã§ããŸã€‚
<code>loadGeneralFile</code> ã¯ã€</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" lang="plaintext"><code><span class="line"><span>* OpenStream/Send HTTP Request</span></span>
<span class="line"><span>* HTTP Response</span></span>
<span class="line"><span>    * 3xx => Redirect</span></span>
<span class="line"><span>* content-type ã§åˆ†å²</span></span>
<span class="line"><span>    * BufferLoader => Buffer</span></span></code></pre>
<p>ã¨ã„ã†æ„Ÿã˜ã«æ•´ç†ã§ããã†ã€‚
Httpã¨Bufferãƒ­ãƒ¼ãƒ€ãƒ¼ã‚’å‰¯ä½œç”¨ã®ç„¡ã„é–¢æ•°ã«æ•´ç†ã§ãã‚Œã°å†å…¥å¯èƒ½ãŒè¦‹ãˆã¦ãã‚‹ã€‚
æ—©ã‚ã«åˆ†å²ã•ã›ã¦ã€åˆ†å²ã—ãŸã‚‰åˆæµã—ãªã„ã€‚åŒã˜å‡¦ç†ã¯é–¢æ•°ã§å…±æœ‰ã™ã‚‹ã¨ã„ã†æ–¹å‘æ€§ã§æ•´ç†ã€‚</p>
<p>Buffer ãŒå¤šæ©Ÿèƒ½ãªã®ã§ã€Document, HttpResponse, FileInfo ã¨ã‹ã«åˆ†å‰²ã—ãŸã„ã€‚</p>
<h1 id="ç¬¬ï¼”æ®µéš">ç¬¬ï¼”æ®µéš</h1>
<p>mainloop ã®å†å®Ÿè£…ã€‚libuv, libevent ç­‰ã‚’æ¤œè¨ã—ã¦ã„ãŸã®ã ã‘ã©ã€ c++ ã¨ã®è¦ªå’Œæ€§ã®é«˜ã„ asio ã‚’ä½¿ã†ã“ã¨ã«ã—ãŸã€‚
<code>tty read (keyboard input)</code>, <code>signal callback (sigint, winresize)</code>, <code>alarm</code> ã®å‰²ã‚Šè¾¼ã¿ã‚’ asio çµŒç”±ã«ã™ã‚‹ã€‚
ã‚¢ãƒ—ãƒªã®çµ‚äº†ã‚’loop ã®çµ‚äº†ã«ã—ã¦ã€è‡ªç„¶ã« destructor ãŒã‚³ãƒ¼ãƒ«ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ã€‚</p>
<h1 id="ç¬¬ï¼•æ®µéš">ç¬¬ï¼•æ®µéš</h1>
<p>html parse ã‹ã‚‰ term ã¸ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°éƒ¨åˆ†ã®åˆ†è§£ã€‚
ã‚„ã£ã¨è§£èª­ã§ãã¦ï¼‘ãƒ‘ã‚¹ç›®</p>
<ul>
<li>å†…éƒ¨æ–‡å­—ã‚³ãƒ¼ãƒ‰(wtf-8)ã«å¤‰æ›</li>
<li>tokenize</li>
<li>tag ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦å±æ€§å–å¾— => ãƒ‘ãƒ¼ã‚¹ã«æˆåŠŸã—ãŸã‚‰è¡Œãƒãƒƒãƒ•ã‚¡ã«æ›¸ãæˆ»ã™ã€‚ãƒ•ã‚©ãƒ¼ãƒ ã®æƒ…å ±ã‚’è“„ç©ã™ã‚‹ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</li>
</ul>
<p>çµæœã¨ã—ã¦ã€è¡Œã®ãƒªã‚¹ãƒˆã¨ã€ãƒ•ã‚©ãƒ¼ãƒ æƒ…å ±ã‚’å¾—ã‚‹ã€‚</p>
<p>ï¼’ãƒ‘ã‚¹ç›®</p>
<ul>
<li>è¡Œã®ãƒªã‚¹ãƒˆã‚’å†åº¦ãƒ‘ãƒ¼ã‚¹</li>
<li>éã‚¿ã‚°éƒ¨åˆ†ã‚’Bufferã«å‡ºåŠ›</li>
<li>Aã‚¿ã‚°ã‚„ãƒ•ã‚©ãƒ¼ãƒ ã‚’ Anchor ãªã©ã«å‡ºåŠ›</li>
</ul>
<p>ã¨ã„ã†æ„Ÿã˜ã ã£ãŸã€‚
ï¼‘ãƒ‘ã‚¹ç›®ã§ html åŒ–ã™ã‚‹ã¨ãã«çŸ¥ã‚‰ãªã„å±æ€§ã‚’æ¨ã¦ãŸã‚Šã€å†…éƒ¨å±æ€§ã‚’è¿½åŠ ã—ãŸã‚Šã—ã¦ã„ã‚‹æ§˜å­ã€‚
ã“ã®ã€å†…éƒ¨å±æ€§ãŒã‚ˆãã‚ã‹ã‚‰ãªãã¦é›£ã—ã„ã€‚</p>
<h1 id="æ–‡å­—ã‚³ãƒ¼ãƒ‰">æ–‡å­—ã‚³ãƒ¼ãƒ‰</h1>
<p><code>content-charset</code> => <code>wtf</code> => <code>DisplayCharset</code> ã¨æ–‡å­—ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›ã—ã¦å‹•ä½œã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã€‚
è©¦ã—ã«ã€<code>utf-8</code> ã§ã‚ã‚‹ã“ã¨ãŒåˆ†ã‹ã£ã¦ã„ã‚‹ <code>html</code> ã§ <code>wtf</code> å¤‰æ›ã‚’é£›ã°ã—ã¦ã¿ãŸã¨ã“ã‚è¡¨ç¤ºãŒå£Šã‚ŒãŸã€‚
<code>wtf</code> ã¯ <code>utf-8</code> ã¨äº’æ›æ€§ãŒãªã„ã‚‰ã—ã„ã€‚
<a href="http://simonsapin.github.io/wtf-8/">http://simonsapin.github.io/wtf-8/</a>
ãªã®ã‹ã¨æ€ã£ãŸã®ã ãŒã€é•ã†ç‹¬è‡ªå½¢å¼ã‹ã‚‚ã—ã‚Œãªã„ã€‚</p>
<p>w3m ã¯ã€ã“ã® <code>wtf</code> ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ã€html ã‚¿ã‚°ã®ãƒ‘ãƒ¼ã‚¹ã€æ–‡å­—ã®ãƒã‚¤ãƒˆå¹…ã®åˆ¤å®šã€æ–‡å­—ã®ã‚«ãƒ©ãƒ å¹…ã®åˆ¤å®šã‚’ã—ã¦ã„ã‚‹ã®ã ãŒã€
<code>utf-8</code> ã§ã¯ã€æ–‡å­—ã®ãƒã‚¤ãƒˆå¹…ã€ã‚«ãƒ©ãƒ å¹…ã®åˆ¤å®šãŒç‹‚ã†ã€‚
ã¨ã„ã†ã“ã¨ã§ã€ <code>utf-8</code> ã§ã®ãƒã‚¤ãƒˆå¹…åˆ¤å®šã‚’è‡ªä½œã—ã¦ <code>wcwidth</code> ã‚’çµ„ã¿åˆã‚ã›ã¦ã¿ãŸã€‚
<code>*#12345;</code> å½¢å¼ã® <code>unicode</code> åŸ‹ã‚è¾¼ã¿ã«å¯¾å¿œã™ã‚‹ãŸã‚ã«ã€è¿½åŠ ã§ <code>unicode</code> => <code>utf-8</code> å¤‰æ›ã‚‚ä½œã£ãŸã€‚
æ­£ã—ãè¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ããŸã€‚</p>
<p>ã¨ã„ã†ã“ã¨ã§ã€<code>euc-jp</code> ã¨ <code>shift-jis</code> ã¨ <code>iso-2022-jp</code> ã‹ã‚‰ <code>utf-8</code> ã¸ã®å¤‰æ›ã‚’ä½œã‚Œã°æ—¥æœ¬èªã¯å¯¾å¿œã§ããã†ã€‚
<code>std::string_view</code>, <code>char32_t</code>, <code>char8_t</code> ã‚ãŸã‚Šã®æ–°ã—ã„å‹ã‚’ä½¿ã£ãŸ <code>\0</code> çµ‚ç«¯ã«é ¼ã‚‰ãªã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½œã£ã¦ã¿ã‚‹ã€‚</p>
<h1 id="ãƒ¡ãƒ¢">ãƒ¡ãƒ¢</h1>
<h2 id="ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«åˆ†å‰²">ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«åˆ†å‰²</h2>
<p>æ©Ÿèƒ½ã”ã¨ã«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«åˆ†å‰²ã™ã‚‹ã€‚</p>
<ul>
<li>
<p>UI(frontend)</p>
<ul>
<li>Term
<ul>
<li>ä½ãƒ¬ãƒ™ãƒ«æç”»
<ul>
<li>termcap ã®é–¢æ•°ã‚’ç›´æ¥å‘¼ã¶ã€‚curses ã®è‡ªå‰å®Ÿè£…çš„ãª</li>
<li>ãƒãƒ«ãƒãƒã‚¤ãƒˆã€ãƒãƒ«ãƒã‚«ãƒ©ãƒ ã®æ–‡å­—åˆ—ã¨å¯†æ¥ã«é–¢é€£ã—ã¦ã„ã¦ libwc ã¨ä¸å¯åˆ†</li>
</ul>
</li>
<li>ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›</li>
<li>ãƒã‚¦ã‚¹å…¥åŠ›</li>
<li>ãƒªã‚µã‚¤ã‚ºã‚¤ãƒ™ãƒ³ãƒˆ</li>
<li>SIGNALãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
<ul>
<li>SIGINT => longjmp ã§ã‚­ãƒ£ãƒ³ã‚»ãƒ«å‡¦ç†ã‚’å®Ÿç¾ã—ã¦ã„ã‚‹ã€‚c++ ã®ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¨ã‹ã¾ãšãã†</li>
</ul>
</li>
</ul>
</li>
<li>é«˜ãƒ¬ãƒ™ãƒ«æç”»
<ul>
<li>Lineã®æ§‹ç¯‰(byte ã”ã¨ã« char ã¨ Lineprop ãŒãƒšã‚¢ã«ãªã‚‹)</li>
</ul>
</li>
<li>Tab</li>
<li>Buffer</li>
<li>Message</li>
<li>Menu</li>
<li>Keymap</li>
<li>LineInput
<ul>
<li>SearchKey</li>
<li>History</li>
</ul>
</li>
</ul>
</li>
<li>
<p>IO(transport)</p>
<ul>
<li>IStream
<ul>
<li>union => class polymorphismåŒ–</li>
<li>file descriptor</li>
<li>FILE*</li>
<li>ssl</li>
<li>memory</li>
<li>Compression</li>
</ul>
</li>
<li>LocalCGI</li>
</ul>
</li>
<li>
<p>http</p>
<ul>
<li>HttpSession
<ul>
<li>HttpRequest</li>
<li>HttpResponse</li>
</ul>
</li>
<li>cookie</li>
<li>redirect</li>
<li>referer</li>
<li>https</li>
<li>ftp</li>
<li>URL</li>
</ul>
</li>
<li>
<p>HTML</p>
<ul>
<li>HTMLtagproc1</li>
<li>HTMLlineproc2body
<ul>
<li>process_form</li>
<li>process_form_int</li>
</ul>
</li>
<li>form</li>
<li>table</li>
<li>frame</li>
<li>term rendering</li>
</ul>
</li>
<li>
<p>String</p>
<ul>
<li>æ–‡å­—ã‚³ãƒ¼ãƒ‰</li>
<li>quote</li>
<li>url escape</li>
<li>html escape</li>
<li>html entity</li>
<li>char_util
<ul>
<li>myctype</li>
</ul>
</li>
<li>string_view_util
<ul>
<li>strip</li>
</ul>
</li>
<li>string_util
<ul>
<li>malloc</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="ãƒªãƒ³ã‚¯ã‚’ãŸã©ã‚‹followlink">ãƒªãƒ³ã‚¯ã‚’ãŸã©ã‚‹(followLink)</h2>
<p>followA();
loadLink();
loadGeneralFile();</p>
<p>cmd_loadURL();
loadGeneralFile();</p>
<p>cmd_loadURL();
loadGeneralFile();</p>
<h2 id="æç”»ã™ã‚‹">æç”»ã™ã‚‹</h2>
<p>displayBuffer
redrawBuffer
redrawNLine</p>
<h2 id="keyå…¥åŠ›">keyå…¥åŠ›</h2></article></main><footer data-astro-cid-sz7xmlte>
&copy; 2023 ousttrue. All rights reserved.
<div class="social-links" data-astro-cid-sz7xmlte><a href="https://github.com/ousttrue/" target="_blank" data-astro-cid-sz7xmlte><svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/github" data-astro-cid-sz7xmlte><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg></a></div></footer></body></html>