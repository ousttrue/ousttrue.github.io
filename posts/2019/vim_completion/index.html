<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Nikola (getnikola.com)">
<meta name="viewport" content="width=device-width">
<script src="../../../assets/js/all-nocdn.js"></script><title>vim ã® Completion ã«ã¤ã„ã¦èª¿ã¹ã‚‹ | ä¸‰æ¬¡å…ƒæ—¥èªŒ</title>
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
</head>
<body>
    <h1 id="brand">
        <a href="../../../" title="ä¸‰æ¬¡å…ƒæ—¥èªŒ" rel="home">
            <span id="blog-title">ä¸‰æ¬¡å…ƒæ—¥èªŒ</span>
        </a>
    </h1>

    <nav id="menu"><ul>
<li><a href="../../../archive.html">Archives</a></li>
<li><a href="../../../categories/index.html">Tags</a></li>
<li><a href="../../../rss.xml">RSS feed</a></li>
<li><a href="../../../about">About</a></li>
<li><a href="../../../books">MemoBooks</a></li>

            
            
            
        </ul></nav><hr>
<main id="content"><h1 class="p-name entry-title" itemprop="headline name">
    <h1 class="p-name entry-title" itemprop="headline name">
    <a href="." class="u-url">vim ã® Completion ã«ã¤ã„ã¦èª¿ã¹ã‚‹
    </a>
</h1>
<ul itemprop="keywords" class="tags">
<li>
        <time datetime="2019-04-22T02:17:20+09:00" title="2019-04-22">2019-04-22</time>
</li>
    <li><a class="tag p-category" href="../../../categories/lsp/" rel="tag">lsp</a></li>
    <li><a class="tag p-category" href="../../../categories/vim/" rel="tag">vim</a></li>
</ul>
</h1>

<div>
<p><code>omnicompletion</code> ã¨ã‹ã„ã‚ã„ã‚ã‚ã‚‹ã‘ã©ã©ã†é•ã†ã­ã‚“ã€‚ã¨ã„ã†ã“ã¨ã§èª¿ã¹ã‚‹ã€‚
<code>help ins-completion</code>
<code>help complete-functions</code></p>
<h3>ã„ã‚ã„ã‚ãªè£œå®Œ</h3>
<h3>è£œå®Œé–¢æ•°ã‚’å®šç¾©</h3>
<p><code>&lt;C-X&gt;&lt;C-U&gt;</code> ã‚’ <code>set completefunc</code> ã§ã€
<code>&lt;C-X&gt;&lt;C-O&gt;</code> ã‚’ <code>set omnifunc</code> ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ã§ãã‚‹ã€‚</p>
<pre class="code literal-block"><span></span><span class="k">function</span><span class="p">!</span> s:my_omni_complete<span class="p">(</span>findstart<span class="p">,</span> base<span class="p">)</span>
    <span class="k">if</span> <span class="k">a</span>:findstart
<span class="c">        " è£œå®Œã®é–‹å§‹åˆ—ã‚’è¿”ã™</span>
        <span class="k">return</span> <span class="k">col</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)</span>
    <span class="k">endif</span>

<span class="c">    " è£œå®Œå€™è£œã‚’è¿”ã™</span>
    <span class="k">let</span> <span class="k">l</span>:matches <span class="p">=</span>  [<span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span>]
    <span class="k">return</span> {<span class="s1">'words'</span>: matches<span class="p">,</span> <span class="s1">'refresh'</span>: <span class="s1">'always'</span>}

<span class="k">endfunction</span>

<span class="c">"setlocal complefunc = </span>
<span class="k">setlocal</span> <span class="nb">omnifunc</span> <span class="p">=</span> s:my_omni_complete
<span class="c">" menuone</span>
<span class="k">setlocal</span> <span class="nb">completeopt</span> <span class="p">=</span> menu<span class="p">,</span>preview<span class="p">,</span>longest
<span class="c">" default</span>
<span class="k">setlocal</span> <span class="nb">previewheight</span> <span class="p">=</span> <span class="m">3</span>
<span class="c">"setlocal pumheight</span>
<span class="k">setlocal</span> pumwidth <span class="p">=</span> <span class="m">15</span>
</pre>

<p>ã®ã‚ˆã†ã«å®šç¾©ã™ã‚‹ã€‚</p>
<h4>æœ€åˆã®å®Ÿè¡Œæ™‚</h4>
<blockquote>
<p>On the first invocation the arguments are:
   a:findstart  1
   a:base empty</p>
</blockquote>
<h4>å€™è£œã®å–å¾—</h4>
<blockquote>
<p>On the second invocation the arguments are:
   a:findstart  0
   a:base the text with which matches should match; the text that was
      located in the first call (can be empty)</p>
</blockquote>
<h4>è£œå®Œå€™è£œ</h4>
<p>å˜ãªã‚‹æ–‡å­—åˆ—ã‹ä»¥ä¸‹ã®dictionary</p>
<pre class="code literal-block"><span></span>{
    word        the text that will be inserted, mandatory
    abbr        abbreviation of "word"; when not empty it is used in
            the menu instead of "word"
    menu        extra text for the popup menu, displayed after "word"
            or "abbr"
    info        more information about the item, can be displayed in a
            preview window
    kind        single letter indicating the type of completion

        v   variable
        f   function or method
        m   member of a struct or class
        t   typedef
        d   #define or macro

    icase       when non-zero case is to be ignored when comparing
            items to be equal; when omitted zero is used, thus
            items that only differ in case are added
    dup     when non-zero this match will be added even when an
            item with the same word is already present.
    empty       when non-zero this match will be added even when it is
            an empty string
    user_data   custom data which is associated with the item and
            available in |v:completed_item|
}
</pre>

<h4>éåŒæœŸã§æ›´æ–°</h4>
<h4>è‡ªå‹•çš„ã«suggest</h4>
<ul>
<li>deoplete</li>
</ul>
<h4>å‘¼ã³å‡ºã—ä¾‹</h4>
<pre class="code literal-block"><span></span><span class="nb">inoremap</span> <span class="p">&lt;</span>expr<span class="p">&gt;</span> . MayComplete<span class="p">()</span>
func MayComplete<span class="p">()</span>
    <span class="k">if</span> <span class="p">(</span>can <span class="nb">complete</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">".\&lt;C-X&gt;\&lt;C-O&gt;"</span>
    <span class="k">endif</span>
    <span class="k">return</span> <span class="s1">'.'</span>
endfunc
</pre>

<h4>å®Ÿè£…ä¾‹</h4>
<h5>vim-lsp</h5>
<pre class="code literal-block"><span></span><span class="k">function</span><span class="p">!</span> <span class="nb">lsp</span>#omni#<span class="nb">complete</span><span class="p">(</span>findstart<span class="p">,</span> base<span class="p">)</span> abort
    <span class="k">if</span> <span class="k">a</span>:findstart
        <span class="k">return</span> <span class="k">col</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)</span>
    <span class="k">else</span>
<span class="c">        " language serverã«è£œå®Œå€™è£œã‚’ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</span>
        <span class="k">call</span> s:send_completion_request<span class="p">(</span><span class="k">l</span>:info<span class="p">)</span>

<span class="c">        " ç©ºã§æŠœã‘ã‚‹</span>
        <span class="k">redraw</span>
        <span class="k">return</span> <span class="k">v</span>:none
    <span class="k">endif</span>
endfunc
</pre>

<pre class="code literal-block"><span></span><span class="c">" call s:send_completion_request(l:info) ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯</span>
<span class="k">call</span> <span class="nb">complete</span><span class="p">(</span><span class="k">col</span><span class="p">(</span><span class="s1">'.'</span><span class="p">),</span> <span class="k">l</span>:matches<span class="p">)</span>
</pre>
</div>

<hr>
<ul class="pager hidden-print">
<li class="previous">
        <a href="../../../github/deso/" rel="prev" title="deso">
            deso ğŸ‘ˆ
        </a>
    </li>
    <li style="flex-grow: 1">
    <li class="next">
        <a href="../vim_create_plugin_has_buffer/" rel="next" title="buffer ã‚’æŒã¤ vim plugin ã‚’ä½œã‚‹">
            ğŸ‘‰ buffer ã‚’æŒã¤ vim plugin ã‚’ä½œã‚‹
        </a>
    </li>
</ul></main><footer id="footer"><p>
            Powered by
            <a href="https://getnikola.com" rel="nofollow">Nikola</a>
        </p>
    </footer>
</body>
</html>
