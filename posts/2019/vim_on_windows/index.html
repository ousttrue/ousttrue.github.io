<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Nikola (getnikola.com)">
<meta name="viewport" content="width=device-width">
<script src="../../../assets/js/all-nocdn.js"></script><title>vim on Windows | 三次元日誌</title>
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
</head>
<body>
    <h1 id="brand">
        <a href="../../../" title="三次元日誌" rel="home">
            <span id="blog-title">三次元日誌</span>
        </a>
    </h1>

    <nav id="menu"><ul>
<li><a href="../../../archive.html">Archives</a></li>
<li><a href="../../../categories/index.html">Tags</a></li>
<li><a href="../../../rss.xml">RSS feed</a></li>
<li><a href="../../../about">About</a></li>
<li><a href="../../../books">MemoBooks</a></li>

            
            
            
        </ul></nav><hr>
<main id="content"><h1 class="p-name entry-title" itemprop="headline name">
    <h1 class="p-name entry-title" itemprop="headline name">
    <a href="." class="u-url">vim on Windows
    </a>
</h1>
<ul itemprop="keywords" class="tags">
<li>
        <time datetime="2019-04-18T01:00:00+09:00" title="2019-04-18">2019-04-18</time>
</li>
    <li><a class="tag p-category" href="../../../categories/vim/" rel="tag">vim</a></li>
</ul>
</h1>

<p>常用エディタをvimに復古するべく環境を整備し始めた。
せっかくなので <code>neovim</code> も試してみる。</p>
<ul>
<li>環境はWindows10</li>
</ul>
<h3>neovim</h3>
<ul>
<li>neovim本家サイトからダウンロード<ul>
<li>https://github.com/neovim/neovim/releases</li>
<li>nvim-win32.zip</li>
</ul>
</li>
<li>python3の環境を作る<ul>
<li>python36-32を入れた(nvimのバージョンに合わせた)</li>
<li>環境変数PATHに <code>C:/Python36-32</code> と <code>C:/Python36-32/Scripts</code> を追加</li>
<li><code>pip install neovim</code></li>
</ul>
</li>
</ul>
<h4>nvim-qt.exe (gui)</h4>
<p>だいたい動く。</p>
<ul>
<li>コピペはクリップボード経由で。<code>set clipboard+=unnamed</code>
</li>
<li>color emojiは諦める</li>
</ul>
<h4>nvim.exe (cmd.exe)</h4>
<p>だいたい動く。</p>
<ul>
<li>コピペはクリップボード経由で。<code>set clipboard+=unnamed</code>
</li>
<li>
<code>set termguicolors</code> でフルカラー</li>
</ul>
<h4>Oni(Electron製)</h4>
<p>意外と良かったが細かいところ(日本語の変換中の表示とか)が使いづらかった。
<code>oni2</code> 作っているらしい。</p>
<ul>
<li>emoji とか見た目はいい</li>
</ul>
<h4>$HOME/local/bin/nvim (wsl)</h4>
<p><code>mintty</code> が良くて、なかなか快適。</p>
<ul>
<li>Windowsのプロセスを実行する系は諦める(<code>!start .</code> とか)</li>
<li>git とかさくさく動く</li>
<li>もろもろ、パッケージマネージャーで入れるだけなので楽</li>
<li>無ければ、ソースからビルドするのも楽</li>
</ul>
<p>既にWSLがインストール済みであるところから。
わいは、</p>
<ul>
<li>https://github.com/yuk7/ArchWSL</li>
</ul>
<p>入れてる。</p>
<h5>wslする端末を整備する</h5>
<p>minttyのwsl向けのwslttyを使う。</p>
<ul>
<li>https://github.com/mintty/wsltty</li>
<li>Cicaフォント</li>
<li>xterm-256</li>
</ul>
<p>color emoji を設定する。</p>
<ul>
<li>https://github.com/mintty/wsltty/issues/93</li>
<li>
<code>%USERPROFILE%\AppData\Roaming\wsltty</code> フォルダに対して作業する</li>
</ul>
<p><img alt="emoji" src="emoji.jpg"></p>
<p>複合文字とか複雑すぎなのでは・・・</p>
<h5>nvimを自前ビルドする</h5>
<p>足りないパッケージを適宜追加でインストールしながら。</p>
<pre class="code literal-block">mkdir -p <span class="nv">$HOME</span>/local/src
<span class="nb">cd</span> <span class="nv">$HOME</span>/local/src
git clone https://github.com/neovim/neovim.git
<span class="nb">cd</span> neovim
<span class="nv">CMAKE_INSTALL_PREFIX</span><span class="o">=</span><span class="nv">$HOME</span>/local make install <span class="c1"># $HOME/local/bin にインストールする</span>
</pre>
<p>環境変数 <code>PATH</code> に <code>$HOME/local/bin</code> を足した</p>
<h5>python3</h5>
<pre class="code literal-block">pip install --user neovim
</pre>
<h3>vim8</h3>
<h4>gvim</h4>
<ul>
<li>
<code>emoji</code> など難しいマルチバイト文字の入る文書を編集するときは最善でした</li>
</ul>
<h3>cmd.exe</h3>
<ul>
<li>
<a href="https://mridgers.github.io/clink/">clink</a>を導入して、cmd.exeの苦しさを軽減する(c-p, c-n, tab)</li>
<li>
<code>Cica</code> フォントなどを導入することで見た目はいい感じになる</li>
<li>color emojiは諦める(cmd.exeの制約)</li>
<li>一応、 <code>chcp 65001</code> してから <code>vim</code> で <code>set encoding=utf8</code>
</li>
<li>color thema<ul>
<li>https://github.com/Microsoft/console/tree/master/tools/ColorTool</li>
</ul>
</li>
</ul>
<p>ptyが入ったらしい。近々いい感じになりそう。
* https://devblogs.microsoft.com/commandline/windows-command-line-introducing-the-windows-pseudo-console-conpty/</p>
<ul>
<li>F1-F5は何故か、 <code>A, B, C, D, E</code> のキーコードで来る。</li>
</ul>
<h3>powershell</h3>
<p>普通に、readlineの設定があるのを発見した。</p>
<ul>
<li>一度だけ、管理者権限でps1の実行許可を設定する必要あり</li>
<li>
<code>%USERPROFILE%\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1</code> を自分で作る</li>
</ul>
<p>powershellの設定ファイルに下記のように設定すると、 <code>emacs</code> 風コマンドラインになって使いやすくなる。</p>
<pre class="code literal-block"><span class="nb">Set-PSReadlineKeyHandler</span> <span class="n">-Key</span> <span class="s1">'Ctrl+u'</span> <span class="n">-Function</span> <span class="n">BackwardDeleteLine</span>
<span class="nb">Set-PSReadlineKeyHandler</span> <span class="n">-Key</span> <span class="s1">'Ctrl+b'</span> <span class="n">-Function</span> <span class="n">BackwardChar</span>
<span class="nb">Set-PSReadlineKeyHandler</span> <span class="n">-Key</span> <span class="s1">'Ctrl+f'</span> <span class="n">-Function</span> <span class="n">ForwardChar</span>
<span class="nb">Set-PSReadlineKeyHandler</span> <span class="n">-Key</span> <span class="s1">'Ctrl+d'</span> <span class="n">-Function</span> <span class="n">DeleteChar</span>
<span class="nb">Set-PSReadlineKeyHandler</span> <span class="n">-Key</span> <span class="s1">'Ctrl+h'</span> <span class="n">-Function</span> <span class="n">BackwardDeleteChar</span>
<span class="nb">Set-PSReadlineKeyHandler</span> <span class="n">-Key</span> <span class="s1">'Ctrl+p'</span> <span class="n">-Function</span> <span class="n">HistorySearchBackward</span>
<span class="nb">Set-PSReadlineKeyHandler</span> <span class="n">-Key</span> <span class="s1">'Ctrl+n'</span> <span class="n">-Function</span> <span class="n">HistorySearchForward</span>
<span class="nb">Set-PSReadlineKeyHandler</span> <span class="n">-Key</span> <span class="s1">'Ctrl+a'</span> <span class="n">-Function</span> <span class="n">BeginningOfLine</span>
<span class="nb">Set-PSReadlineKeyHandler</span> <span class="n">-Key</span> <span class="s1">'Ctrl+e'</span> <span class="n">-Function</span> <span class="n">EndOfLine</span>
<span class="nb">Set-PSReadlineKeyHandler</span> <span class="n">-Key</span> <span class="s1">'Ctrl+m'</span> <span class="n">-Function</span> <span class="n">AcceptLine</span>
<span class="nb">Set-PSReadlineKeyHandler</span> <span class="n">-Key</span> <span class="s1">'Ctrl+k'</span> <span class="n">-Function</span> <span class="n">ForwardDeleteLine</span>
</pre>

<hr>
<ul class="pager hidden-print">
<li class="previous">
        <a href="../moldstamp/" rel="prev" title="静的サイト生成器 MoldStamp">
            静的サイト生成器 MoldStamp 👈
        </a>
    </li>
    <li style="flex-grow: 1">
    <li class="next">
        <a href="../python_clang/" rel="next" title="pythonモジュール clang で C++ ヘッダーを変換する">
            👉 pythonモジュール clang で C++ ヘッダーを変換する
        </a>
    </li>
</ul></main><footer id="footer"><p>
            Powered by
            <a href="https://getnikola.com" rel="nofollow">Nikola</a>
        </p>
    </footer>
</body>
</html>
