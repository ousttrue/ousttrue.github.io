<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Nikola (getnikola.com)">
<meta name="viewport" content="width=device-width">
<script src="../../../../../assets/js/all-nocdn.js"></script><title>cmakeã‚’ä½¿ã£ã¦ã¿ã‚‹(Windowsã‹ã¤ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§) | ä¸‰æ¬¡å…ƒæ—¥èªŒ</title>
<link href="../../../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
</head>
<body>
    <h1 id="brand">
        <a href="../../../../../" title="ä¸‰æ¬¡å…ƒæ—¥èªŒ" rel="home">
            <span id="blog-title">ä¸‰æ¬¡å…ƒæ—¥èªŒ</span>
        </a>
    </h1>

    <nav id="menu"><ul>
<li><a href="../../../../../archive.html">Archives</a></li>
<li><a href="../../../../../categories/index.html">Tags</a></li>
<li><a href="../../../../../rss.xml">RSS feed</a></li>
<li><a href="../../../../../about">About</a></li>
<li><a href="../../../../../books">MemoBooks</a></li>

            
            
            
        </ul></nav><hr>
<main id="content"><h1 class="p-name entry-title" itemprop="headline name">
    <h1 class="p-name entry-title" itemprop="headline name">
    <a href="." class="u-url">cmakeã‚’ä½¿ã£ã¦ã¿ã‚‹(Windowsã‹ã¤ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§)</a>
</h1>
<ul itemprop="keywords" class="tags">
<li>
        <time datetime="2013-12-08T00:00:00+09:00" title="2013-12-08">2013-12-08</time>
</li>
</ul>
</h1>

<div>
<p>ArUcoã‚’ä½¿ãŠã†ã¨ã—ãŸã‚‰ã€msvcpdã®vc10ç‰ˆã‚’è¦æ±‚ã•ã‚Œã¦vc12ã§ãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ«ãƒ‰ãŒå‹•ã‹ãªã‹ã£ãŸã€‚</p>
<p>æœ€æ–°ç‰ˆã®OpenCV-2.4.7ã‚’ã‚²ãƒƒãƒˆã—ã¦ããŸã¨ã“ã‚vc10ã¨vc11ã¯å«ã¾ã‚Œã¦å±…ã‚‹ã®ã ãŒã€vc12ãƒ“ãƒ«ãƒ‰ã¯å«ã¾ã‚Œã¦ã„ãªã‹ã£ãŸ(vc2013ã¯æ—©ã™ããŸã‹w)ã€‚
ä»•æ–¹ãªã„ã®ã§è‡ªå‰ãƒ“ãƒ«ãƒ‰ã™ã‚‹ã“ã¨ã«ã—ãŸã€‚
ã¨ã„ã†ã“ã¨ã§cmakeã®ä½¿ã„æ–¹ã‚’èª¿ã¹ã¦ã¿ã‚‹ã€‚
ã¤ã„ã§ã«ã€cmakeã§ãƒ“ãƒ«ãƒ‰ã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ç‰¹å®šã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’åŸºæº–ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•ã‚’èª¿ã¹ã¦ã¿ã‚‹ã€‚
ç·´ç¿’ã«zlibã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ã‚‹
ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã§é‹ç”¨ã—ã¦ã¿ã‚‹ã“ã¨ã‚’ç›®æ¨™ã«ä½œæ¥­é–‹å§‹ã€‚
local_vc12
 + bin # dllç½®ãå ´
 + include # dllã‚’ä½¿ã†ã®ã«å¿…è¦ãªheaderç½®ãå ´
 + lib # dllã®importãƒ©ã‚¤ãƒ–ãƒ©ãƒªç½®ãå ´</p>
<p>å¤–éƒ¨ä¾å­˜ã®ç„¡ã„é©å½“ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ç·´ç¿’ã—ã¦ã¿ã‚ˆã†ã¨ã„ã†ã“ã¨ã§zlibã‚’é¸å®šã€‚
ã•ã£ããcmakeã‚’ä½¿ã£ã¦ã¿ã‚ˆã†ã¨æ€ã£ãŸã‚‰ã€zlib-1.2.8ã«ã¯CmakeLists.txtãŒå«ã¾ã‚Œã¨ã‚‹ã§ã€‚
C:\src&gt; cd zlib-1.2.8
C:\src\zlib-1.2.8&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\zlib-1.2.8&gt; msbuild INSTALL.vcxproj
C:\src\zlib-1.2.8&gt; msbuild INSTALL.vcxproj /p:Configuration=Release</p>
<p>ä»¥ä¸Šã§ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã£ãŸã€‚
C:/local_vc12
C:/local_vc12/bin
C:/local_vc12/bin/zlib.dll
C:/local_vc12/bin/zlibd.dll
C:/local_vc12/include
C:/local_vc12/include/zconf.h
C:/local_vc12/include/zlib.h
C:/local_vc12/lib
C:/local_vc12/lib/zlib.lib
C:/local_vc12/lib/zlibd.lib
C:/local_vc12/lib/zlibstatic.lib
C:/local_vc12/lib/zlibstaticd.lib
C:/local_vc12/share
C:/local_vc12/share/man
C:/local_vc12/share/man/man3
C:/local_vc12/share/man/man3/zlib.3
C:/local_vc12/share/pkgconfig
C:/local_vc12/share/pkgconfig/zlib.pc</p>
<p>ç´ æ™´ã‚‰ã—ã„ã€‚
OpenCV-2.4.7ã§ã‚„ã£ã¦ã¿ã‚‹
C:\src&gt; cd opencv-2.4.7
C:\src\opencv-2.4.7&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\opencv-2.4.7&gt; msbuild ALL_BUILD.vcxproj</p>
<p>å¤±æ•—ã™ã‚‹ã€‚</p>
<p>https://github.com/SpecLad/opencv/commit/7973594a01228107dcb9d2d1f10eb64498b91aac
http://stackoverflow.com/questions/17409956/cannot-compile-opencv-2-4-5-with-vs-2013-rtm</p>
<p>ã‚ã¨Ilmxxxã§min, maxã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã®ã§â€#include
<algorithm>â€œã™ã‚‹ã€‚std::min,
maxã¯algorithmã«å…¥ã£ã¨ã‚‹ã€‚ALL_BUILDãŒæˆåŠŸã—ãŸã‚‰INSTALLã™ã‚‹ã€‚
C:\src\opencv-2.4.7&gt; msbuild INSTALL.vcxproj</algorithm></p>
<p>ã“ã‚Œã§â€local_vc12â€ã«opencvã‚‚å…¥ã£ãŸã€‚
cmakeã¯ã„ã¾ã¾ã§æ•¬é ã—ã¦ã„ãŸã®ã ãŒãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®installã¾ã§é¢å€’è¦‹ã¦ãã‚Œã‚‹ã®ã¯ã„ã„ã§ã™ãªã€‚
åŒã˜ãæ•¬é ã—ã¦ã„ãŸè‡ªå‰dllã‚’ä½¿ã†é–‹ç™ºãŒæ—ã‚Šãã†ãªæ„Ÿã˜ã ã€‚
ArUcoã‚’ãƒ“ãƒ«ãƒ‰
cmakeã‚’ä½¿ã£ãŸã‚¢ãƒ—ãƒª(ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†æ–¹)ã®ãƒ“ãƒ«ãƒ‰ã€‚
C:\src&gt; cd aruco-1.2.4
C:\src\aruco-1.2.4&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .</p>
<p>ã“ã“ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã€‚
OpenCVãŒæ­£å¼ãƒ“ãƒ«ãƒ‰ã¨é•ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸãŸã‚ã«æ¤œçŸ¥ã«å¤±æ•—ã™ã‚‹ã€‚
â€œC:/local_vc12/OpenCVConfig.cmakeâ€ã‚’ç›´æ¥ä¿®æ­£ã—ãŸã€‚
get_filename_component(OpenCV_CONFIG_PATH "${CMAKE_CURRENT_LIST_FILE}" PATH CACHE)</p>
<h2>if(OpenCV_RUNTIME AND OpenCV_ARCH)</h2>
<h2>if(OpenCV_STATIC AND EXISTS "${OpenCV_CONFIG_PATH}/${OpenCV_ARCH}/${OpenCV_RUNTIME}/staticlib/OpenCVConfig.cmake")</h2>
<h2>if(OpenCV_CUDA AND EXISTS "${OpenCV_CONFIG_PATH}/gpu/${OpenCV_ARCH}/${OpenCV_RUNTIME}/staticlib/OpenCVConfig.cmake")</h2>
<h2>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/gpu/${OpenCV_ARCH}/${OpenCV_RUNTIME}/staticlib")</h2>
<h2>else()</h2>
<h2>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/${OpenCV_ARCH}/${OpenCV_RUNTIME}/staticlib")</h2>
<h2>endif()</h2>
<h2>elseif(EXISTS "${OpenCV_CONFIG_PATH}/${OpenCV_ARCH}/${OpenCV_RUNTIME}/lib/OpenCVConfig.cmake")</h2>
<h2>if(OpenCV_CUDA AND EXISTS "${OpenCV_CONFIG_PATH}/gpu/${OpenCV_ARCH}/${OpenCV_RUNTIME}/lib/OpenCVConfig.cmake")</h2>
<h2>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/gpu/${OpenCV_ARCH}/${OpenCV_RUNTIME}/lib")</h2>
<h2>else()</h2>
<h2>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/${OpenCV_ARCH}/${OpenCV_RUNTIME}/lib")</h2>
<h2>endif()</h2>
<h2>endif()</h2>
<h2>endif()</h2>
<p>set(OpenCV_LIB_PATH "${OpenCV_CONFIG_PATH}/lib")</p>
<p>ã“ã‚Œã§ãƒ“ãƒ«ãƒ‰ã§ããŸã€‚
C:\src\aruco-1.2.4&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\opencv-2.4.7&gt; msbuild ALL_BUILD.vcxproj</p>
<p>ã—ã‹ã—ã€OpenGLã‚’ä½¿ã£ãŸã‚µãƒ³ãƒ—ãƒ«ãŒãƒ“ãƒ«ãƒ‰ã•ã‚Œã¬ã€‚
ã©ã†ã‚„ã‚‰glutãŒè¦‹ã¤ã‹ã‚‰ãªã„ã‚‰ã„ã—ã„ã€‚ã›ã£ã‹ããªã®ã§FreeGlutã‚’å…¥ã‚Œã¦ã¿ã¾ã™ã‹ã€‚
FreeGlut
http://freeglut.sourceforge.net/
C:\src\freeglut-2.8.1&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
CMake Error: The source directory "C:/src/freeglut-2.8.1" does not appear to contain CMakeLists.txt.
Specify --help for usage, or press the help button on the CMake GUI.</p>
<p>CMakeLists.txtãŒç„¡ã„ã€‚ä½œã£ã¦ã¿ã‚‹ã€‚
project (freeglut)</p>
<p>file(GLOB SOURCES "src/*.c")
ADD_LIBRARY(freeglut SHARED ${SOURCES})</p>
<p>include_directories(include)</p>
<p>ADD_DEFINITIONS(-DFREEGLUT_EXPORTS)
ADD_DEFINITIONS(-D_USRDLL)
ADD_DEFINITIONS(-D_WINDOWS)
ADD_DEFINITIONS(-DWIN32)</p>
<p>C:\src\freeglut-2.8.1&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\opencv-2.4.7&gt; msbuild ALL_BUILD.vcxproj</p>
<p>ãƒ“ãƒ«ãƒ‰ã§ããŸã€‚INSTALL.vcxprojãŒè¦‹å½“ãŸã‚‰ãªã„ã®ã§CMakeLists.txtã«è¿½è¨˜ã™ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã€‚
ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«é–¢ã™ã‚‹è¿½è¨˜ã€‚</p>
<h2>dll</h2>
<p>INSTALL(TARGETS freeglut RUNTIME
    DESTINATION bin)</p>
<h2>lib</h2>
<p>INSTALL(TARGETS freeglut ARCHIVE
    DESTINATION lib)</p>
<h2>headers</h2>
<p>INSTALL(DIRECTORY include/
    DESTINATION include
    PATTERN "Makefile.*" EXCLUDE
)</p>
<p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ã‚‹ã€‚
C:\src\freeglut-2.8.1&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
C:\src\opencv-2.4.7&gt; msbuild INSTALL.vcxproj</p>
<p>-- Install configuration: "Debug"
 -- Installing: C:/local_vc12/bin/freeglut.dll
 -- Installing: C:/local_vc12/lib/freeglut.lib
 -- Installing: C:/local_vc12/include
 -- Installing: C:/local_vc12/include/GL
 -- Up-to-date: C:/local_vc12/include/GL/freeglut.h
 -- Up-to-date: C:/local_vc12/include/GL/freeglut_ext.h
 -- Up-to-date: C:/local_vc12/include/GL/freeglut_std.h
 -- Up-to-date: C:/local_vc12/include/GL/glut.h</p>
<p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æˆåŠŸã€‚
å†åº¦ArUco
C:\src\freeglut-2.8.1&gt; cmake -D CMAKE_INSTALL_PREFIX=C:/local_vc12 .
 -- FOUND OPENGL=YES    LIBS=opengl32;glu32;C:/local_vc12/lib/freeglut.lib</p>
<p>glutãŒç™ºè¦‹ã•ã‚ŒãŸã‚ˆã†ã ã€‚
ã©ã†ã‚„ã‚‰cmakeã¯CMAKE_INSTALL_PREFIXã«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ¢ã—ã«è¡Œãã‚ˆã†ã§ã™ãªã€‚
C:\src\opencv-2.4.7&gt; msbuild ALL_BUILD.vcxproj</p>
<p>gl.hã®å‰ã«â€#include <windows.h>â€œã—ã¦ã‚„ã£ã¦ãƒ“ãƒ«ãƒ‰ã§ããŸã€‚
Debugç‰ˆã®å¾Œã‚ã«â€dâ€ã‚’ã¤ã‘ã‚‹
FreeGlutã®CmakeLists.txtã«zlibã®â€CmakeLists.txtâ€ã‹ã‚‰é ‚ã„ã¦ããŸã€‚
set(CMAKE_DEBUG_POSTFIX "d")</windows.h></p>
<p>è¨˜è¿°é †ã®å½±éŸ¿ãŒã‚ã‚‹ã‚ˆã†ã§å‰ã®æ–¹(ADD_LIBRARYã‚ˆã‚Šå‰ï¼Ÿ)ã«æ›¸ãå¿…è¦ãŒã‚ã‚‹ã£ã½ã„ã€‚
Debugç‰ˆã®å¾Œã‚ã«â€dâ€ãŒã¤ã„ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†</p>
<p>http://stackoverflow.com/questions/2209929/linking-different-libraries-for-debug-and-release-builds-in-cmake-on-windows
http://stackoverflow.com/questions/5497348/debug-and-release-library-linking-with-cmake-visual-studio</p>
<p>ã“ã†ã„ã†æ›¸ãæ–¹ã§ã§ããŸã€‚
set (OPENGL_LIBS  general ${OPENGL_gl_LIBRARY} ${OPENGL_glu_LIBRARY} optimized ${GLUT_glut_LIBRARY} debug ${GLUT_glut_DEBUG_LIBRARY})</p>
<p>CMAKE_DEBUG_POSTFIXã«é–¢é€£ã¯ä½¿ã‚ã‚Œã‚‹æ–¹ã¨ä½¿ã†æ–¹ã®åŒæ–¹ã§åˆã‚ã›ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§å¤‰æ›´ã™ã‚‹å ´åˆã¯è‡ªåˆ†ã§ä¸¡æ–¹ã®é¢å€’ã‚’è¦‹ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚
ä¸€å¿œã€cmakeã®ã²ã¨ã¨ãŠã‚Šã®ä½¿ã„æ–¹ãŒåˆ†ã‹ã£ã¦ããŸã€‚
vcãŒmsbuildã‚’ä½¿ã†ã‚ˆã†ã«ãªã£ã¦ãƒ“ãƒ«ãƒ‰ãŒåˆ¶å¾¡å¯èƒ½ã«ãªã£ã¦ã„ã‚‹æ„Ÿã˜ã€‚
makeã®å„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«å¯¾ã™ã‚‹msbuildã®å®Ÿè¡Œæ–¹æ³•ã¯ä»¥ä¸‹ã®é€šã‚Šã€‚
"target", "make", "msbuild"
"build", "make all", "msbuild ALL_BUILD.vcxproj /t:Build"
"release build", "?", "msbuild ALL_BUILD.vcxproj /t:Build /p:Configuration=Release"
"debug build", "?", "msbuild ALL_BUILD.vcxproj /t:Build /p:Configuration=Debug"
"clean", "make clean", "msbuild ALL_BUILD.vcxproj /t:Clean"
"install", "make install", "msbuild INSTALL.vcxproj"</p>
<p>ã¡ã‚‡ã£ã¨ã„ã‚ã„ã‚ãƒ“ãƒ«ãƒ‰ã—ã¦ã¿ã‚‹ã€‚</p>
</div>

<ul class="pager hidden-print">
<li class="previous">
        <a href="../../01/sharpdx/" rel="prev" title="SharpDXäº‹å§‹ã‚">
            SharpDXäº‹å§‹ã‚ ğŸ‘ˆ
        </a>
    </li>
    <li style="flex-grow: 1">
    <li class="next">
        <a href="../cmake/" rel="next" title="cmakeã‚’ä½¿ã£ã¦ã¿ã‚‹(Windowsã‹ã¤ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§)">
            ğŸ‘‰ cmakeã‚’ä½¿ã£ã¦ã¿ã‚‹(Windowsã‹ã¤ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§)
        </a>
    </li>
</ul></main><footer id="footer"><p>
            Powered by
            <a href="https://getnikola.com" rel="nofollow">Nikola</a>
        </p>
    </footer>
</body>
</html>
