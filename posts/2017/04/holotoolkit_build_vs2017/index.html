<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Nikola (getnikola.com)">
<meta name="viewport" content="width=device-width">
<script src="../../../../assets/js/all-nocdn.js"></script><title>Holotoolkit-unityでMSBuild-15.0(VS2017)を使う | 三次元日誌</title>
<link href="../../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
</head>
<body>
    <h1 id="brand">
        <a href="../../../../" title="三次元日誌" rel="home">
            <span id="blog-title">三次元日誌</span>
        </a>
    </h1>

    <nav id="menu"><ul>
<li><a href="../../../../archive.html">Archives</a></li>
<li><a href="../../../../categories/index.html">Tags</a></li>
<li><a href="../../../../rss.xml">RSS feed</a></li>
<li><a href="../../../../about">About</a></li>
<li><a href="../../../../books">MemoBooks</a></li>

            
            
            
        </ul></nav><hr>
<main id="content"><h1 class="p-name entry-title" itemprop="headline name">
    <a href="." class="u-url">Holotoolkit-unityでMSBuild-15.0(VS2017)を使う</a>
</h1>
<div>
<p>VS2017からレジストリの構成が変わっている。</p>
<p>http://stackoverflow.com/questions/328017/path-to-msbuild</p>
<pre class="code literal-block"><span></span>    <span class="n">public</span> <span class="k">static</span> <span class="n">string</span> <span class="nf">CalcMSBuildPath</span><span class="p">(</span><span class="n">string</span> <span class="n">msBuildVersion</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">msBuildVersion</span> <span class="o">==</span> <span class="s">"15.0"</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">using</span> <span class="p">(</span><span class="n">var</span> <span class="n">key</span> <span class="o">=</span> <span class="n">Microsoft</span><span class="p">.</span><span class="n">Win32</span><span class="p">.</span><span class="n">Registry</span><span class="p">.</span><span class="n">LocalMachine</span><span class="p">.</span><span class="n">OpenSubKey</span><span class="p">(</span>
                <span class="s">@"SOFTWARE\WOW6432Node\Microsoft\VisualStudio\SxS\VS7"</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">key</span> <span class="o">==</span> <span class="n">null</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">return</span> <span class="n">null</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">string</span> <span class="n">folder</span> <span class="o">=</span> <span class="n">key</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="n">msBuildVersion</span><span class="p">)</span> <span class="n">as</span> <span class="n">string</span><span class="p">;</span>
                <span class="n">string</span> <span class="n">msBuildPath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">Combine</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s">"MSBuild</span><span class="se">\\</span><span class="s">15.0</span><span class="se">\\</span><span class="s">Bin</span><span class="se">\\</span><span class="s">msbuild.exe"</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">msBuildPath</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// 既存のコード</span>
    <span class="p">}</span>
</pre>
</div>
    </main><footer id="footer"><p>
            Powered by
            <a href="https://getnikola.com" rel="nofollow">Nikola</a>
        </p>
    </footer>
</body>
</html>
