<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Nikola (getnikola.com)">
<meta name="viewport" content="width=device-width">
<script src="../../../../assets/js/all-nocdn.js"></script><title>Windowsã§PyAlembicã§ãã‚‹ã®ã‹ | ä¸‰æ¬¡å…ƒæ—¥èªŒ</title>
<link href="../../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
</head>
<body>
    <h1 id="brand">
        <a href="../../../../" title="ä¸‰æ¬¡å…ƒæ—¥èªŒ" rel="home">
            <span id="blog-title">ä¸‰æ¬¡å…ƒæ—¥èªŒ</span>
        </a>
    </h1>

    <nav id="menu"><ul>
<li><a href="../../../../archive.html">Archives</a></li>
<li><a href="../../../../categories/index.html">Tags</a></li>
<li><a href="../../../../rss.xml">RSS feed</a></li>
<li><a href="../../../../about">About</a></li>
<li><a href="../../../../books">MemoBooks</a></li>

            
            
            
        </ul></nav><hr>
<main id="content"><h1 class="p-name entry-title" itemprop="headline name">
    <h1 class="p-name entry-title" itemprop="headline name">
    <a href="." class="u-url">Windowsã§PyAlembicã§ãã‚‹ã®ã‹
    </a>
</h1>
<ul itemprop="keywords" class="tags">
<li>
        <time datetime="2017-08-07T00:00:00+09:00" title="2017-08-07">2017-08-07</time>
</li>
    <li><a class="tag p-category" href="../../../../categories/cg/" rel="tag">cg</a></li>
    <li><a class="tag p-category" href="../../../../categories/cmake/" rel="tag">cmake</a></li>
    <li><a class="tag p-category" href="../../../../categories/python/" rel="tag">python</a></li>
</ul>
</h1>

<p>Windowsä¸Šã§PyAlembicã‚’ä½¿ã„ãŸã„ã®ã ãŒã§ãã‚‹ã®ã‹ã€‚
ç´ ç›´ã«Linuxã§ã‚„ã‚‹ã¹ãã§ã¯ãƒ»ãƒ»ãƒ»
Windows10(64bit) + Python-3.6(64bit)</p>
<p>ä½œæ¥­å ´ã€‚</p>
<p>https://github.com/ousttrue/openexr</p>
<p>Anaconda3(Windows10 64bit)ã§ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¢ã™</p>
<blockquote>
<p>conda install -c conda-forge alembic</p>
</blockquote>
<p>ã—ã‹ã—ã€ã“ã‚Œã¯é•ã†Alembicã ã£ãŸã€‚
Pythonã®alembicã¯ã€database migrations toolã¨åå‰ãŒè¢«ã£ã¦ãŠã‚Šã¾ã™ã€‚
ãªã‚‹ã»ã©ãƒ»ãƒ»ãƒ»ã€‚
Python2.7ãªã‚‰</p>
<p>http://www.lfd.uci.edu/~gohlke/pythonlibs/#pyalembic</p>
<p>ã‚ã¨ã‹ã‚‰ç™ºè¦‹ã€‚ã‚ã„ã¯ã€Python3.6ã«ã—ãŸã„ã®ã§ã€‚
è‡ªå‰ã§ãƒ“ãƒ«ãƒ‰ã‚’è©¦ã¿ã‚‹
alembic-1.7.1/python/PyAlembicãŒãã‚Œã§ã™ãªã€‚
å•é¡ŒãŒï¼’ã¤ã‚ã‚‹ã€‚</p>
<p>Python2(Python3ã«ã—ãŸã„)
Boost.Python(PyBind11ã«ã—ã¦ãƒªãƒ³ã‚¯å•é¡Œã¨ãŠã•ã‚‰ã°ã—ãŸã„)</p>
<p>ã•ã™ãŒã«PyBind11å·®ã—æ›¿ãˆã¯ã‚„ã‚‹ã«ã—ã¦ã‚‚å¾Œã«ã™ã‚‹ã¹ããªã®ã§ã€ Python3åŒ–ã ã‘ã‚„ã‚‹ã€‚
Boost.Pythonã®ãƒ“ãƒ«ãƒ‰
Boost.Pythonã§ä½¿ã†Pythonã‚’æ˜ç¤ºã™ã‚‹ã«ã¯ã€user-config.jamã«è¨˜è¿°ã™ã‚‹ã€‚
BOOST_DIR/user-conifg.jam
using python 
    : 3.6                   # Version
    : D:\Anaconda3\python.exe      # Python Path
    : D:\Anaconda3\include         # include path
    : D:\Anaconda3\libs            # lib path(s)
    : <define>BOOST_ALL_NO_LIB=1
    ;</define></p>
<p>ãƒ“ãƒ«ãƒ‰
boost&gt; b2.exe -j3 --stagedir=stage\x86_64 link=shared runtime-link=shared threading=multi toolset=msvc-14.0 address-model=64 --with-python</p>
<p>link=sharedã«ã—ã¦dllã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒå¿…è¦ã€‚
ã“ã‚Œã¯ã€iex.pydã¨imath.pydé–“ã§Boost.Pythonã®staticå¤‰æ•°ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«å¿…é ˆã§ã‚ã‚‹(pyexã®å‹ç™»éŒ²å‘¨ã‚Šã‹)ã€‚
IlmBaseã‚’ä¿®æ­£
ilmbase-2.2.0/IexMath/IexMathFloatExc.h
ã®ä»¥ä¸‹ã®éƒ¨åˆ†ã‚’ä¿®æ­£ã™ã‚‹ã€‚å¤šåˆ†ã€è¨˜è¿°ãƒŸã‚¹ãªã®ã ã‘ã©èª°ã‚‚Windowsãƒ“ãƒ«ãƒ‰ã—ãªã„ã®ã§æ°—ä»˜ã‹ã‚Œã¦ã„ãªã„ã®ã§ã‚ã‚ã†ã€‚
//#if defined(IEX_EXPORTS)â†²</p>
<h2>if defined(IEXMATH_EXPORTS)â†²</h2>
<p>ã“ã‚Œã§ilmbaseã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ãŠãã€‚vcpkgã‚’ä½¿ã£ãŸã€‚
alembicã‚’ä¿®æ­£
alembic-1.7.1/lib/Alembic/AbcCoreLayer/CMakeLists.txtã‚’ä¿®æ­£ã—ã¦ãƒ˜ãƒƒãƒ€ã‚’è¿½åŠ ã™ã‚‹(PyAlembicãŒä½¿ã†)
INSTALL(FILES Read.h Util.h
    Foundation.h # è¿½åŠ 
    DESTINATION include/Alembic/AbcCoreLayer)</p>
<p>ã“ã‚Œã‚‚ã€vcpkgã‚’ä½¿ã£ãŸã€‚
PyIlmBaseã®ãƒ“ãƒ«ãƒ‰
OpenEXRã®ã‚µã‚¤ãƒˆã«ã‚ã‚‹pyilmbase-2.2.0tar.gzã‚’ä½¿ãŠã†ã¨ã—ãŸã®ã ã‘ã©ã€githubã®æ–¹ãŒæ–°ã—ã„ã‚ˆã†ãªã®ã§ã“ã¡ã‚‰ã‚’ä½¿ã†ã€‚
Python3å‘ã‘ã®ä¿®æ­£
Python2ã¨Pytnon3é–“ã§ã®éäº’æ›ã«ã‚ˆã‚‹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã‚’ç›´ã—ã¦ã„ãã€‚</p>
<p>PySliceObject_XXX -&gt; PyObject_XXX
PyInt_XXX -&gt; PyLong_XXX
PyString_AsString -&gt; PyUnicode_AsUTF8
_PyThreadState_Current -&gt; _PyThreadState_UncheckedGet()</p>
<p>å‚è€ƒ</p>
<p>Python3 Advent Calendar - Pythonã§2/3ä¸¡æ–¹ã§å‹•ãã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã(C/API)
Fix build for Python 3.5
http://py3c.readthedocs.io/en/latest/guide.html</p>
<p>CMakeè¨­å®š</p>
<p>CMAKE_INSTALL_PREFIX
BOOST_ROOT
ILMBASE_PACKAGE_PREFIX
FIND_PACKAGE(numpy)ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
Debugã§ã‚‚Python36.libã«ãƒªãƒ³ã‚¯ã™ã‚‹ã‚ˆã†ã«ã€#include <python.h>ã‚’é™¤å»(boost/python.hppçµŒç”±ã§ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ã•ã›ã‚Œã°ãã†ãªã‚‹)</python.h></p>
<p>ãƒ“ãƒ«ãƒ‰ãŒé€šã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚
PyAlembicã®ãƒ“ãƒ«ãƒ‰
å½“åˆã€Alembicã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§Pythonãƒ•ãƒ©ã‚°ã‚’æœ‰åŠ¹ã«ã—ã¦ä¸€ç·’ã«ãƒ“ãƒ«ãƒ‰ã—ã‚ˆã†ã¨ã—ã¦ã„ãŸãŒã€PyIlmBaseå‚˜ä¸‹ã«PyAlembicã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹æ–¹å¼ã«å¤‰ãˆãŸã€‚
alembic-1.7.1/python/PyAlembicã‚’ilmbase-2.2.0/PyIlmBaseã«ã‚³ãƒ”ãƒ¼ã—ã¦ã€CMakeLists.txtã‚’èª¿æ•´ã™ã‚‹ã€‚
CMakeè¨­å®š</p>
<p>Alembic_ROOT</p>
<p>å‚è€ƒ</p>
<p>uimacå®Ÿè£…ãƒ¡ãƒ¢ - PyImath</p>
<p>PyAlembicã®ãƒ“ãƒ«ãƒ‰ãŒé€šã£ãŸã®ã§å®Ÿè¡Œã—ã¦ã¿ã‚ˆã†
PyAlembic/Tests/testPolyMesh.pyã‚’å‹•ã‹ã—ã¦ã¿ã‚ˆã†ã¨æ€ã†ã€‚
ã“ã†ã„ã†æ„Ÿã˜ã«æº–å‚™ã™ã‚‹ã€‚
testPolyMesh.py
iex.pyd
PyIex.dll
imath.pyd
PyImath.dll
alembic.lib
alembic.pyd
boost_python-vc140-mt-1_61.dll # debug buildã‚‚ã“ã‚Œ</p>
<blockquote>
<p>C:/python36/python.exe testPolyMesh.py</p>
</blockquote>
<p>import alembicã§ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã€‚ãƒ‡ãƒãƒƒã‚¬ã§è¿½ã£ã¦ã¿ã‚‹ã¨ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®åˆæœŸåŒ–ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã€‚ä¸€å€‹ãšã¤ç›´ã™ã€‚
åˆæœŸåŒ–ã®ä¿®æ­£
Python3åŒ–ã«ã‚ˆã‚‹å¤‰æ›´ï¼Ÿ
AbcView
ä»Šå›ã®ä½œæ¥­ç›®æ¨™ã€‚</p>
<p>http://alembic.github.io/abcview/</p>
<p>ã“ã‚Œã‚’å‹•ä½œã•ã›ãŸã„ã€‚
AbcView has the following requirements:</p>
<p>Python 2.6+ =&gt; Python 3.6 ã§å‹•ãã‚ˆã†ã«æ”¹é€ ã™ã‚‹(printæ–‡ã¨ã‹)
PyAlembicã€‚ã§ããŸ
PyAbcOpenGLã€‚ã§ããŸ
PyOpenGLã€‚pip
argparseã€‚pip
PyQt4ã€‚http://www.lfd.uci.edu/~gohlke/pythonlibs/#pyalembic
numpy-mklã€‚http://www.lfd.uci.edu/~gohlke/pythonlibs/#pyalembic</p>
<p>PyQt4ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</p>
<p>https://stackoverflow.com/questions/22640640/how-to-install-pyqt4-on-windows-using-pip
http://www.lfd.uci.edu/~gohlke/pythonlibs/#pyqt4</p>
<p>ã“ã‚“ãªæ„Ÿã˜ã§å…¬å¼ã®Python3.6(64bit)ã«å¯¾ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚
D:\Python36\Scripts\pip.exe install .\PyQt4-4.11.4-cp36-cp36m-win_amd64.whl</p>
<p>https://www.tutorialspoint.com/pyqt/pyqt_hello_world.htm</p>
<p>import sys
from PyQt4 import QtGui</p>
<p>def window():
    app = QtGui.QApplication(sys.argv)
    w = QtGui.QWidget()
    b = QtGui.QLabel(w)
    b.setText("Hello World!")
    w.setGeometry(100,100,200,50)
    b.move(50,20)
    w.setWindowTitle("PyQt")
    w.show()
    sys.exit(app.exec_())</p>
<p>if <strong>name</strong> == '<strong>main</strong>':
    window()</p>
<p>å‹•ã„ãŸã€‚
alembicgl.pyd, alembic.pyd, imath.pyd, iex.pydã¨ä¾å­˜dllç¾¤ã‚’wheelåŒ–ã™ã‚‹
åŒã˜dllã‚’å‚ç…§ã™ã‚‹pydã‚’åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã«é…ç½®ã—ãŸã„ã®ã§ã€
å…±é€šã®è¦ªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦ilmã‚’å®šç¾©ã—ã¦ãã®ä¸­ã«ã™ã¹ã¦ã®pydã¨dllã‚’åã‚ã‚‹ã“ã¨ã«ã—ãŸã€‚
ãã®ã†ãˆã§ã“ã‚Œã‚’é–“æ¥çš„ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«â€™iexâ€™, â€˜imathâ€™, â€˜alembicâ€™, â€˜alembicglâ€™
ã‚’ä½œã‚‹è¨ˆç”»ã€‚
ilm
    + <strong>init</strong>.py
    + iex.pyd
    + imath.pyd
    + alembic.pyd
    + alembicgl.pyd
    + PyEx.dll
    + PyImath.dll
    + boost_python.dll
    + Alembic.dll # VCPKG BUILD
    + ilmbase.dll # VCPKG BUILD
    + iex.dll # VCPKG BUILD
    + imath.dll # VCPKG BUILD
    + half.dll # VCPKG BUILD
    + hdf5.dll # VCPKG BUILD
    + zip.dll # VCPKG BUILD
    + szip.dll # VCPKG BUILD
iex
    + <strong>init</strong>.py # ilm.iexã‚’å…¬é–‹
imath
    + <strong>init</strong>.py # ilm.imathã‚’å…¬é–‹
alembic
    + <strong>init</strong>.py # ilm.alembicã‚’å…¬é–‹
alembicgl
    + <strong>init</strong>.py # ilm.alembicglã‚’å…¬é–‹
setup.py</p>
<p>iex/init.py
from ilm.iex import *</p>
<p>ã“ã†ã„ã†ã®ã‚’iex, imath, alembic, alembicglãã‚Œãã‚Œã«ä½œã£ãŸã€‚
setup.py</p>
<h2>!/usr/bin/env python</h2>
<p>from setuptools import setup, Distribution</p>
<p>setup(
        name='alembic',
        version='0.1',
        description='Alembic Library',
        packages=['ilm', 'iex', 'imath', 'alembic', 'alembicgl'],
        package_data={
            'ilm':['<em>.pyd', '</em>.dll'],
            },
        )</p>
<p>py_package&gt; D:\Python36\python.exe setup.py bidst_wheel
py_package&gt; D:\Python36\Scripts\pip.exe install .\dist\alembic-0.1-cp36-cp36m-win_amd64.whl</p>
<p>AbcViewã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹
ã“ã†ã„ã†æ„Ÿã˜ã«é…ç½®ã—ã¦ã€abcview_main.pyã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹ã€‚
abcview_main.py # bin/abcviewã‹ã‚‰æ”¹å(åå‰ãŒãƒ•ã‚©ãƒ«ãƒ€ã¨è¢«ã‚‰ãªã„ã‚ˆã†ã«å¤‰æ›´)
abcview
    <strong>init</strong>.py</p>
<p>python2ä»•æ§˜ã®éƒ¨åˆ†ã‚’ã¾ã¨ã‚ã¦ä¿®æ­£ã€‚</p>
<p>https://docs.python.jp/3/library/2to3.html</p>
<p>AbcView&gt; D:\Python36\python.exe D:\Python36\Tools\scripts\2to3.py -w .</p>
<p>printæ–‡ã€exceptæ–‡ãªã©ã®å®šå‹çš„ãªæ–‡æ³•å•é¡Œã¯ã“ã‚Œã§ä¸€ç¶²æ‰“å°½ã€‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã¾ã¨ã‚ã¦å‡¦ç†ã§ãã‚‹ã€‚
file.toAscii() =&gt; file
ã“ã‚Œã‚‚Python2ã¨ã®éäº’æ›ã‹ã€‚
QtCore.QString(str(value)) =&gt; str(value)
QStringã¯ã€Pythonã®Stringã§ã‚ˆã•ã’ã€‚
å‹•ã„ãŸ</p>
<p>https://github.com/ousttrue/openexr/releases/tag/v0.1</p>
<p>ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã‚’æ“ä½œã—ãŸã‚‰è›¸ãŒå‹•ã„ãŸã€‚</p>

<hr>
<ul class="pager hidden-print">
<li class="previous">
        <a href="../distutils_msvccompiler/" rel="prev" title="distutilsã§cl.exeãŒè¦‹ã¤ã‹ã‚‰ãªã„">
            distutilsã§cl.exeãŒè¦‹ã¤ã‹ã‚‰ãªã„ ğŸ‘ˆ
        </a>
    </li>
    <li style="flex-grow: 1">
    <li class="next">
        <a href="../cmake_find_boost_python/" rel="next" title="CMakeã§Boost.Pythonã‚’ä½¿ã†">
            ğŸ‘‰ CMakeã§Boost.Pythonã‚’ä½¿ã†
        </a>
    </li>
</ul></main><footer id="footer"><p>
            Powered by
            <a href="https://getnikola.com" rel="nofollow">Nikola</a>
        </p>
    </footer>
</body>
</html>
