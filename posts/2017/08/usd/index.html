<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Nikola (getnikola.com)">
<meta name="viewport" content="width=device-width">
<script src="../../../../assets/js/all-nocdn.js"></script><title>usd | 三次元日誌</title>
<link href="../../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
</head>
<body>
    <h1 id="brand">
        <a href="../../../../" title="三次元日誌" rel="home">
            <span id="blog-title">三次元日誌</span>
        </a>
    </h1>

    <nav id="menu"><ul>
<li><a href="../../../../archive.html">Archives</a></li>
<li><a href="../../../../categories/index.html">Tags</a></li>
<li><a href="../../../../rss.xml">RSS feed</a></li>
<li><a href="../../../../about">About</a></li>
<li><a href="../../../../books">MemoBooks</a></li>

            
            
            
        </ul></nav><hr>
<main id="content"><h1 class="p-name entry-title" itemprop="headline name">
    <h1 class="p-name entry-title" itemprop="headline name">
    <a href="." class="u-url">usd
    </a>
</h1>
<ul itemprop="keywords" class="tags">
<li>
        <time datetime="2017-08-14T00:00:00+09:00" title="2017-08-14">2017-08-14</time>
</li>
    <li><a class="tag p-category" href="../../../../categories/usd/" rel="tag">usd</a></li>
</ul>
</h1>

<h2>PixarのUniversal Scene Descriptionをビルドしてみる</h2>
<p>20170902。実はビルドスクリプトがあって、簡単になっていた。</p>
<p>動画でCEDEC2017のセッションを聞いてよさげな気がしたので再度やってみた(ちょっと前に途中までやって放置していた)。
usdviewが使えるようにするとよいらしい。</p>
<h3>Pixar USD の Windows ビルド方法（2017/9 版）</h3>
<p>自動ビルドスクリプトがついているので放っておくだけなのだけど、うまくいかなかったところを補足する。
環境は、<code>Windows10(64bit)</code> + <code>VisualStudio2017</code> + <code>VisualStudio2015 のコンパイラ追加インストール(VisualStudio2017のインストールメニューにある)</code>
visualstudio補足
VisualStudioは、最近のバージョンに限ってもいろいろある。</p>
<ul>
<li>VisualStudio2017(MSVC14.1)のみ</li>
<li>VisualStudio2017(MSVC14.1)にVS2015(MSVC14.0)のコンパイラが追加インストールされている(うちはこれ)</li>
<li>VisualStudio2015(MSVC14.0)のみ</li>
<li>Visual C++ 2015 Build Tools(MSVC14.0)Python3ビルド向けにIDEの無いバージョン)</li>
</ul>
<p>ものによって <code>vcvars.bat</code> の場所が違って、<code>bjam</code> とか <code>distutils</code> がコンパイラの発見に失敗したりする場合があるようだ。
<code>cl.exe</code> が見つからないような場合、visualstudioの提供する設定済みのdosプロンプトから始めるのが手堅いかもしれない。
一応、
<code>VisualStudio2017 - x64 native tools command prompt</code> からはじめる。
CMakeはVisualStudioの検出にあまり失敗しないので、おもにBoostのビルド対策。
効果があったかは不明。</p>
<div class="code"><pre class="code literal-block"><span class="nv">D</span>:\<span class="nv">work</span><span class="o">&gt;</span><span class="w"> </span><span class="nv">cl</span><span class="w"></span>
<span class="nv">Microsoft</span><span class="ss">(</span><span class="nv">R</span><span class="ss">)</span><span class="w"> </span><span class="nv">C</span><span class="o">/</span><span class="nv">C</span><span class="o">++</span><span class="w"> </span><span class="nv">Optimizing</span><span class="w"> </span><span class="nv">Compiler</span><span class="w"> </span><span class="nv">Version</span><span class="w"> </span><span class="mi">19</span>.<span class="mi">10</span>.<span class="mi">25019</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">x64</span><span class="w"></span>
<span class="nv">Copyright</span><span class="w"> </span><span class="ss">(</span><span class="nv">C</span><span class="ss">)</span><span class="w"> </span><span class="nv">Microsoft</span><span class="w"> </span><span class="nv">Corporation</span>.<span class="w">  </span><span class="nv">All</span><span class="w"> </span><span class="nv">rights</span><span class="w"> </span><span class="nv">reserved</span>.<span class="w"></span>

使い方:<span class="w"> </span><span class="nv">cl</span><span class="w"> </span>[<span class="w"> </span>オプション...<span class="w"> </span>]<span class="w"> </span>ファイル名...<span class="w"> </span>[<span class="w"> </span><span class="o">/</span><span class="nv">link</span><span class="w"> </span>リンク<span class="w"> </span>オプション...<span class="w"> </span>]<span class="w"></span>
</pre></div>

<p><code>VS2017</code> しか入っていないとき
build_usd.py内Boost.Pythonに関してmsvc=14.0指定(VS2015)があるので、これをコメントアウトすればたぶんVS2017しかなくてもビルドできる。Windows版のPython2.7のビルドコンパイラは <code>VS2008(MSVC9.0)</code> らしい。</p>
<p><a href="https://www.microsoft.com/en-us/download/details.aspx?id=44266">https://www.microsoft.com/en-us/download/details.aspx?id=44266</a></p>
<h3>python補足</h3>
<p>Python27以外のPythonが入っているとはまる率が上がる。</p>
<div class="code"><pre class="code literal-block"><span class="n">D</span><span class="p">:</span>\<span class="n">work</span><span class="o">&gt;</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="o">-</span><span class="n">V</span><span class="w"></span>
<span class="n">Python</span><span class="w"> </span><span class="mf">3.6</span><span class="o">.</span><span class="mi">0</span><span class="w"> </span><span class="p">::</span><span class="w"> </span><span class="n">Anaconda</span><span class="w"> </span><span class="mf">4.3</span><span class="o">.</span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span><span class="w"></span>

<span class="err">違う</span><span class="n">Pythonだー</span><span class="err">。</span><span class="w"></span>
<span class="n">D</span><span class="p">:</span>\<span class="n">work</span><span class="o">&gt;</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">PATH</span><span class="o">=</span><span class="n">D</span><span class="p">:</span>\<span class="n">Python27</span><span class="p">;</span><span class="n">D</span><span class="p">:</span>\<span class="n">Python27</span>\<span class="n">Scripts</span><span class="p">;</span><span class="o">%</span><span class="n">PATH</span><span class="o">%</span><span class="w"></span>
<span class="n">D</span><span class="p">:</span>\<span class="n">work</span><span class="o">&gt;</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="o">-</span><span class="n">V</span><span class="w"></span>
<span class="n">Python</span><span class="w"> </span><span class="mf">2.7</span><span class="o">.</span><span class="mi">14</span><span class="n">rc1</span><span class="w"></span>
<span class="n">D</span><span class="p">:</span>\<span class="n">work</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">pyside</span><span class="w"></span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">pyside</span><span class="w"></span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">PySide</span><span class="o">-</span><span class="mf">1.2</span><span class="o">.</span><span class="mi">4</span><span class="o">-</span><span class="n">cp27</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">win_amd64</span><span class="o">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mf">45.0</span><span class="n">MB</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="mi">100</span><span class="o">%</span><span class="w"> </span><span class="o">|</span><span class="c1">################################| 45.0MB 36kB/s</span><span class="w"></span>
<span class="n">Installing</span><span class="w"> </span><span class="n">collected</span><span class="w"> </span><span class="n">packages</span><span class="p">:</span><span class="w"> </span><span class="n">pyside</span><span class="w"></span>
<span class="n">Successfully</span><span class="w"> </span><span class="n">installed</span><span class="w"> </span><span class="n">pyside</span><span class="o">-</span><span class="mf">1.2</span><span class="o">.</span><span class="mi">4</span><span class="w"></span>
</pre></div>

<p>python使いたるもの２系、３系両方入っていたりするものである。
cloneしてビルドスクリプトを実行</p>
<div class="code"><pre class="code literal-block">D:\work&gt; git clone https://github.com/PixarAnimationStudios/USD

D:\work&gt; mkdir USD_build
D:\work&gt; cd USD_build
D:\work\USD_build&gt;

D:\work\USD_build&gt; python ..\USD\build_scripts\build_usd.py
usage: build_usd.py [-h] [-n] [-v | -q] [--build BUILD]
                    [--generator GENERATOR]
                    [--build-shared | --build-monolithic] [--src SRC]
                    [--inst INST] [--force FORCE_BUILD] [--force-all]
                    [--tests | --no-tests] [--docs | --no-docs]
                    [--imaging | --usd-imaging | --no-imaging]
                    [--ptex | --no-ptex] [--embree | --no-embree]
                    [--embree-location EMBREE_LOCATION]
                    [--alembic | --no-alembic] [--hdf5 | --no-hdf5]
                    [--maya | --no-maya] [--maya-location MAYA_LOCATION]
                    [--katana | --no-katana]
                    [--katana-api-location KATANA_API_LOCATION]
                    [--houdini | --no-houdini]
                    [--houdini-location HOUDINI_LOCATION]
                    install_dir
build_usd.py: error: too few arguments

D:\work\USD_build&gt; python ..\USD\build_scripts\build_usd.py .
ERROR: CMake not found -- please install it and adjust your PATH
</pre></div>

<p>こんな風に足りないツールのメッセージが出るのでせっせとインストールしてパスを設定する。</p>
<blockquote>
<p>set PATH=D:\Program Files\CMake\bin;%PATH%
set PATH=D:\Program Files\NASM;%PATH%</p>
</blockquote>
<p>build…</p>
<h3>Alembicとか無しの最小ビルド。</h3>
<div class="code"><pre class="code literal-block">D:\work\USD_build&gt; python ..\USD\build_scripts\build_usd.py .

Building with settings:
  USD source directory          D:\work\USD
  USD install directory         D:\work\USD_build
  3rd-party source directory    D:\work\USD_build\src
  3rd-party install directory   D:\work\USD_build
  Build directory               D:\work\USD_build\build

  Building                      Shared libraries
    Imaging                     On
      Ptex support:             Off
    UsdImaging                  On
    Documentation               Off
    Tests                       Off
    Alembic Plugin              Off
      HDF5 support:             Off
    Maya Plugin                 Off
    Katana Plugin               Off
    Houdini Plugin              Off

    Dependencies                zlib, boost, TBB, JPEG, TIFF, PNG, OpenEXR, GLEW, OpenImageIO, OpenSubdiv, PyOpenGL

STATUS: Installing zlib...
STATUS: Installing boost...
STATUS: Installing TBB...
STATUS: Installing JPEG...
STATUS: Installing TIFF...
STATUS: Installing PNG...
</pre></div>

<p>こんな感じに順番にビルドが進んでいく。</p>
<h3>pngのビルドでこけた</h3>
<div class="code"><pre class="code literal-block">pngrutil.obj : error LNK2019: 未解決の外部シンボル inflateValidate が関数 png_inflate_claim で参照されました。
</pre></div>

<p>何故か、zlibへのリンクがうまくいっていない？
CMakeのGUIでsourceをUSD_build/src/libpng-1.6.29、buildをD:/dev/_alembic/USD_build/build/libpng-1.6.29にして確認するとZLIB_LIBRARY_RELEASEがC:/Program Files/Anaconda3/Library/lib/z.libになっていてお察し。
pythonをフルパスで指定したらなんか治った。違うPythonが意図せず使われていたか。
dos窓は、whichコマンドが無いしよくわからん。</p>
<div class="code"><pre class="code literal-block"><span class="n">work</span>\<span class="n">USD_build</span><span class="o">&gt;</span><span class="w"> </span><span class="n">D</span><span class="p">:</span>\<span class="n">python27</span>\<span class="n">python</span><span class="w"> </span><span class="o">..</span>\<span class="n">USD</span>\<span class="n">build_scripts</span>\<span class="n">build_usd</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">--</span><span class="n">force</span><span class="w"> </span><span class="n">png</span><span class="w"></span>

<span class="n">STATUS</span><span class="p">:</span><span class="w"> </span><span class="n">Installing</span><span class="w"> </span><span class="n">PNG</span><span class="o">...</span><span class="w"></span>
<span class="n">STATUS</span><span class="p">:</span><span class="w"> </span><span class="n">Installing</span><span class="w"> </span><span class="n">OpenEXR</span><span class="o">...</span><span class="w"></span>
<span class="n">STATUS</span><span class="p">:</span><span class="w"> </span><span class="n">Installing</span><span class="w"> </span><span class="n">GLEW</span><span class="o">...</span><span class="w"></span>
<span class="n">STATUS</span><span class="p">:</span><span class="w"> </span><span class="n">Installing</span><span class="w"> </span><span class="n">OpenImageIO</span><span class="o">...</span><span class="w"></span>
<span class="n">STATUS</span><span class="p">:</span><span class="w"> </span><span class="n">Installing</span><span class="w"> </span><span class="n">OpenSubdiv</span><span class="o">...</span><span class="w"></span>
<span class="n">STATUS</span><span class="p">:</span><span class="w"> </span><span class="n">Installing</span><span class="w"> </span><span class="n">PyOpenGL</span><span class="o">...</span><span class="w"></span>
<span class="n">STATUS</span><span class="p">:</span><span class="w"> </span><span class="n">Installing</span><span class="w"> </span><span class="n">PyOpenGL</span><span class="o">...</span><span class="w"></span>
<span class="n">STATUS</span><span class="p">:</span><span class="w"> </span><span class="n">Installing</span><span class="w"> </span><span class="n">USD</span><span class="o">...</span><span class="w"></span>

<span class="n">Success</span><span class="o">!</span><span class="w"> </span><span class="n">To</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">USD</span><span class="p">,</span><span class="w"> </span><span class="n">please</span><span class="w"> </span><span class="n">ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">PYTHONPATH</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variable</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="n">D</span><span class="p">:</span>\<span class="n">dev</span>\<span class="n">_alembic</span>\<span class="n">USD_build</span>\<span class="n">lib</span>\<span class="n">python</span><span class="w"></span>

<span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">PATH</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variable</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="n">D</span><span class="p">:</span>\<span class="n">dev</span>\<span class="n">_alembic</span>\<span class="n">USD_build</span>\<span class="n">bin</span><span class="w"></span>
<span class="w">    </span><span class="n">D</span><span class="p">:</span>\<span class="n">dev</span>\<span class="n">_alembic</span>\<span class="n">USD_build</span>\<span class="n">lib</span><span class="w"></span>
</pre></div>

<p>ビルドできた。</p>
<h3>Boost.Pythonメモ</h3>
<p><code>boost_python-vc140-mt-1_61.dll</code> が <code>python36.dll</code> とか違うのにリンクしてしまう場合。
最悪PythonをすべてアンインストールしてPython27(64bit)だけをインストールすればいけるのだが、それでは負けた気がするのでBoost.Pythonに使うPythonを強制する方法。</p>
<div class="code"><pre class="code literal-block"><span class="nt">USD_BUILD</span><span class="o">/</span><span class="nt">user-conifg</span><span class="p">.</span><span class="nc">jam</span><span class="w"></span>
<span class="nt">using</span><span class="w"> </span><span class="nt">python</span><span class="w"></span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="nt">2</span><span class="p">.</span><span class="nc">7</span><span class="w">                   </span><span class="err">#</span><span class="w"> </span><span class="nt">Version</span><span class="w"></span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="nt">C</span><span class="o">:</span><span class="err">\\</span><span class="nt">Python27</span><span class="err">\\</span><span class="nt">python</span><span class="p">.</span><span class="nc">exe</span><span class="w">      </span><span class="err">#</span><span class="w"> </span><span class="nt">Python</span><span class="w"> </span><span class="nt">Path</span><span class="w"></span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="nt">C</span><span class="o">:</span><span class="err">\\</span><span class="nt">Python27</span><span class="err">\\</span><span class="nt">include</span><span class="w">         </span><span class="err">#</span><span class="w"> </span><span class="nt">include</span><span class="w"> </span><span class="nt">path</span><span class="w"></span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="nt">C</span><span class="o">:</span><span class="err">\\</span><span class="nt">Python27</span><span class="err">\\</span><span class="nt">libs</span><span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nt">lib</span><span class="w"> </span><span class="nt">path</span><span class="o">(</span><span class="nt">s</span><span class="o">)</span><span class="w"></span>
<span class="w">    </span><span class="o">;</span><span class="w"></span>
</pre></div>

<p>を作って環境変数 <code>BOOST_BUILD_PATH</code> を <code>user-config.jam</code> のあるディレクトリに指定する。
<code>%USERROFILE%\user-config.jam</code> に作って <code>BOOST_BUILD_PATH</code> 無しでもよいが、消し忘れるとあとではまる可能性が増えると思う。</p>
<p><a href="http://www.boost.org/build/doc/html/bbv2/overview/configuration.html">http://www.boost.org/build/doc/html/bbv2/overview/configuration.html</a></p>
<p>WindowsのBoost.Pythonは作るときも使うときもリンクではまる。</p>
<h3>usdviewを使ってみる</h3>
<p>USD_BUILD/bin/usdviewがある。</p>
<div class="code"><pre class="code literal-block"><span class="n">USD_BUILD</span>\<span class="nb">bin</span><span class="o">&gt;</span> <span class="n">D</span><span class="p">:</span>\<span class="n">python27</span>\<span class="n">python</span> <span class="n">usdview</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">"usdview"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">25</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="kn">import</span> <span class="nn">pxr.Usdviewq</span> <span class="k">as</span> <span class="nn">Usdviewq</span>
<span class="ne">ImportError</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="n">pxr</span><span class="o">.</span><span class="n">Usdviewq</span>

<span class="n">environ</span><span class="p">[</span><span class="err">‘</span><span class="n">PATH</span><span class="err">’</span><span class="p">]</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">"usdview"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">37</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">Usdviewq</span><span class="o">.</span><span class="n">Launcher</span><span class="p">()</span><span class="o">.</span><span class="n">Run</span><span class="p">()</span>
  <span class="n">File</span> <span class="s2">"D:\dev\_alembic\USD_build\lib\python\pxr\Usdviewq\__init__.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">54</span><span class="p">,</span> <span class="ow">in</span> <span class="n">Run</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidateOptions</span><span class="p">(</span><span class="n">arg_parse_result</span><span class="p">)</span>
  <span class="n">File</span> <span class="s2">"D:\dev\_alembic\USD_build\lib\python\pxr\Usdviewq\__init__.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">167</span><span class="p">,</span> <span class="ow">in</span> <span class="n">ValidateOptions</span>
    <span class="kn">from</span> <span class="nn">pxr</span> <span class="kn">import</span> <span class="n">Sdf</span>
  <span class="n">File</span> <span class="s2">"D:\dev\_alembic\USD_build\lib\python\pxr\Sdf\__init__.py"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">24</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="kn">import</span> <span class="nn">_sdf</span>
<span class="ne">ImportError</span><span class="p">:</span> <span class="n">DLL</span> <span class="n">load</span> <span class="n">failed</span><span class="p">:</span> <span class="n">指定されたモジュールが見つかりません</span><span class="err">。</span>
</pre></div>

<p>usdviewを改造してしまおう。
環境変数PATHとPYTHONPATHを追加。
usdview.cmd改造でもよいがpythonの方が書きやすいので。
usdviewの冒頭のimport前に下記を追加。</p>
<div class="code"><pre class="code literal-block"><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">basepath</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)))</span>
<span class="n">bin_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basepath</span><span class="p">,</span> <span class="s1">'bin'</span><span class="p">)</span>
<span class="n">lib_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basepath</span><span class="p">,</span> <span class="s1">'lib'</span><span class="p">)</span>
<span class="n">libpython_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lib_dir</span><span class="p">,</span> <span class="s1">'python'</span><span class="p">)</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">libpython_dir</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'PATH'</span><span class="p">]</span><span class="o">=</span><span class="s2">"</span><span class="si">%s</span><span class="s2">;</span><span class="si">%s</span><span class="s2">;"</span> <span class="o">%</span> <span class="p">(</span><span class="n">bin_dir</span><span class="p">,</span> <span class="n">lib_dir</span><span class="p">)</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">'PATH'</span><span class="p">]</span>


<span class="kn">import</span> <span class="nn">pxr.Usdviewq</span> <span class="k">as</span> <span class="nn">Usdviewq</span>
</pre></div>

<p>実行。</p>
<div class="code"><pre class="code literal-block"><span class="n">USD_BUILD</span>\<span class="n">bin</span><span class="o">&gt;</span><span class="w"> </span><span class="n">D</span><span class="p">:</span>\<span class="n">python27</span>\<span class="n">python</span><span class="w"> </span><span class="n">usdview</span><span class="w"></span>
<span class="n">usage</span><span class="p">:</span><span class="w"> </span><span class="n">usdview</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">--</span><span class="n">renderer</span><span class="w"> </span><span class="p">{</span><span class="n">opt</span><span class="p">,</span><span class="n">simple</span><span class="p">}]</span><span class="w"> </span><span class="p">[</span><span class="o">--</span><span class="n">select</span><span class="w"> </span><span class="n">PRIMPATH</span><span class="p">]</span><span class="w"></span>
<span class="w">               </span><span class="p">[</span><span class="o">--</span><span class="n">camera</span><span class="w"> </span><span class="n">CAMERA</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">--</span><span class="n">mask</span><span class="w"> </span><span class="n">PRIMPATH</span><span class="p">[,</span><span class="n">PRIMPATH</span><span class="o">...</span><span class="p">]]</span><span class="w"></span>
<span class="w">               </span><span class="p">[</span><span class="o">--</span><span class="n">clearsettings</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">--</span><span class="n">norender</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">--</span><span class="n">unloaded</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">--</span><span class="n">timing</span><span class="p">]</span><span class="w"></span>
<span class="w">               </span><span class="p">[</span><span class="o">--</span><span class="n">memstats</span><span class="w"> </span><span class="p">{</span><span class="n">none</span><span class="p">,</span><span class="n">stage</span><span class="p">,</span><span class="n">stageAndImaging</span><span class="p">}]</span><span class="w"></span>
<span class="w">               </span><span class="p">[</span><span class="o">--</span><span class="n">numThreads</span><span class="w"> </span><span class="n">NUMTHREADS</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">--</span><span class="n">ff</span><span class="w"> </span><span class="n">FIRSTFRAME</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">--</span><span class="n">lf</span><span class="w"> </span><span class="n">LASTFRAME</span><span class="p">]</span><span class="w"></span>
<span class="w">               </span><span class="p">[</span><span class="o">--</span><span class="n">complexity</span><span class="w"> </span><span class="n">COMPLEXITY</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="o">--</span><span class="n">quitAfterStartup</span><span class="p">]</span><span class="w"></span>
<span class="w">               </span><span class="n">usdFile</span><span class="w"></span>
<span class="n">usdview</span><span class="p">:</span><span class="w"> </span><span class="n">error</span><span class="p">:</span><span class="w"> </span><span class="n">too</span><span class="w"> </span><span class="n">few</span><span class="w"> </span><span class="n">arguments</span><span class="w"></span>
</pre></div>

<p>引数が必要と。</p>
<div class="code"><pre class="code literal-block">cube.usd
#usda 1.0

def Cube "Cube"
{
}
</pre></div>

<p>実行。</p>
<div class="code"><pre class="code literal-block"><span class="n">Warning</span><span class="o">:</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Link</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">180</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">D</span><span class="o">:\</span><span class="n">dev</span><span class="o">\</span><span class="n">_alembic</span><span class="o">\</span><span class="n">USD</span><span class="o">\</span><span class="n">pxr</span><span class="o">\</span><span class="n">imaging</span><span class="o">\</span><span class="n">lib</span><span class="o">\</span><span class="n">hd</span><span class="o">\</span><span class="n">glslProgram</span><span class="o">.</span><span class="na">cpp</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">shader</span><span class="o">:</span><span class="w"></span>
<span class="n">Geometry</span><span class="w"> </span><span class="n">shader</span><span class="o">(</span><span class="n">s</span><span class="o">)</span><span class="w"> </span><span class="n">failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">link</span><span class="o">.</span><span class="w"></span>
<span class="n">Geometry</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="n">error</span><span class="o">:</span><span class="w"> </span><span class="n">HW_UNSUPPORTED</span><span class="o">.</span><span class="w"></span>
<span class="n">ERROR</span><span class="o">:</span><span class="w"> </span><span class="n">Internal</span><span class="w"> </span><span class="n">compile</span><span class="w"> </span><span class="n">error</span><span class="o">,</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">code</span><span class="o">:</span><span class="w"> </span><span class="n">E_SC_LITERAL_NOT_DEFINED</span><span class="w"></span>
<span class="n">Shader</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">HW</span><span class="w"></span>
</pre></div>

<p>Windowは出た。しかしglslのエラーで3DViewの描画ができぬ。
Rx480がだめなのだろうか。
GTX買わねば・・・</p>
<p>Alembic追加する
ToDo</p>

<hr>
<ul class="pager hidden-print">
<li class="previous">
        <a href="../../boost_python3/" rel="prev" title="Boost.PythonのPython3でのstd::string、std::wstringのふるまい">
            Boost.PythonのPython3でのstd::string、std::wstringのふるまい 👈
        </a>
    </li>
    <li style="flex-grow: 1">
    <li class="next">
        <a href="../pybullet/" rel="next" title="PyBulletを使ってみる">
            👉 PyBulletを使ってみる
        </a>
    </li>
</ul></main><footer id="footer"><p>
            Powered by
            <a href="https://getnikola.com" rel="nofollow">Nikola</a>
        </p>
    </footer>
</body>
</html>
