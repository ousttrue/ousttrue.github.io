<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="generator" content="Nikola (getnikola.com)">
<meta name="viewport" content="width=device-width">
<script src="../../../assets/js/all-nocdn.js"></script><title>luaメモ | 三次元日誌</title>
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
</head>
<body>
    <h1 id="brand">
        <a href="../../../" title="三次元日誌" rel="home">
            <span id="blog-title">三次元日誌</span>
        </a>
    </h1>
    <hr>
<main id="content"><h1 class="p-name entry-title" itemprop="headline name">
    <a href="." class="u-url">luaメモ</a>
</h1>
<div>
<p><a href="https://www.lua.org/docs.html">https://www.lua.org/docs.html</a></p>
<h2>Interpreter</h2>
<p>とりあえず <code>luajit-2.1.0-beta3</code> 推し。</p>
<pre class="code literal-block"><span></span>+---+    +---+    +---+    +---+
|5.1| -&gt; |5.2| -&gt; |5.3| -&gt; |5.4|
+---+    +---+    +---+    +---+
  |        |        |
  |        |        +- ravi
  |        |
  |        +- moonsharp
  |
  +- luajit(5.1 base)
  |   +- moonjit
  +- luau(5.1 base)
</pre>

<p><code>lua-5.1</code> をベースに分岐したものが多い？</p>
<p><a href="https://www.lua.org/versions.html">https://www.lua.org/versions.html</a></p>
<table>
<thead><tr>
<th></th>
<th>url</th>
<th>memo</th>
</tr></thead>
<tbody>
<tr>
<td>Lua5.1</td>
<td></td>
<td>2012。これより古いものを使う理由は無さそう。</td>
</tr>
<tr>
<td>Lu15.2</td>
<td><a href="https://www.lua.org/manual/5.2/readme.html#changes">since Lua5.1</a></td>
<td>2015。finalizer. 関数の <code>_ENV</code> 仕様変更</td>
</tr>
<tr>
<td>Lua5.3</td>
<td><a href="https://www.lua.org/manual/5.3/readme.html#changes">since Lua5.2</a></td>
<td>2020。integers</td>
</tr>
<tr>
<td>Lua5.4</td>
<td><a href="https://www.lua.org/manual/5.4/readme.html#changes">since Lua5.3</a></td>
<td>2021。const, to-be-closed</td>
</tr>
<tr>
<td>LuaJIT</td>
<td><a href="https://luajit.org/">https://luajit.org/</a></td>
<td>Lua5.1base。最終版は <code>2.1.0-beta3</code>。neovimもこれ。<code>FFI</code> も強力。</td>
</tr>
<tr>
<td>Luau</td>
<td><a href="https://luau-lang.org/">https://luau-lang.org/</a></td>
<td>Lua5.1 の superset。Roblox専用。オープンソースではない。</td>
</tr>
<tr>
<td>Ravi</td>
<td><a href="http://ravilang.github.io/">http://ravilang.github.io/</a></td>
<td>Lua5.3base？。limited optional static typing and MIR based JIT compiler</td>
</tr>
</tbody>
</table>
<h3>変わり種</h3>
<p><code>headeronly</code>. include するだけで使える。</p>
<ul>
<li><a href="https://github.com/edubart/minilua">https://github.com/edubart/minilua</a></li>
</ul>
<p>LUA に更に埋め込む</p>
<ul>
<li><a href="https://terralang.org/">https://terralang.org/</a></li>
</ul>
<h2>Translator</h2>
<h3><a href="https://moonscript.org/">MoonScript</a></h3>
<h3><a href="https://typescripttolua.github.io/">TypescriptToLua</a></h3>
<ul>
<li>後で出てくる、<code>local-lua-debugger</code> はこれで実装されているぽい。</li>
</ul>
<h3><a href="https://ifritjp.github.io/documents/lunescript/">LuneScript/</a></h3>
<h3><a href="https://github.com/teal-language/tl">Teal</a></h3>
<h2>Language server</h2>
<h3><a href="https://github.com/EmmyLua/EmmyLua-LanguageServer">EmmyLua</a></h3>
<ul>
<li>Java製</li>
<li>
<a href="https://emmylua.github.io/annotation.html">EmmyLua Annotation</a> に対応。これにより、組み込み型のインテリセンスを動作させることができて使い勝手が向上する</li>
</ul>
<h3><a href="https://github.com/sumneko/lua-language-server">lua-language-server</a></h3>
<ul>
<li>⭐ <a href="https://emmylua.github.io/annotation.html">EmmyLua Annotation</a> に対応。これにより、組み込み型のインテリセンスを動作させることができて使い勝手が向上する</li>
</ul>
<p>設定例</p>
<pre class="code literal-block"><span></span>    <span class="s2">"Lua.runtime.version"</span><span class="err">:</span> <span class="s2">"LuaJIT"</span><span class="err">,</span>
    <span class="s2">"Lua.workspace.preloadFileSize"</span><span class="err">:</span> <span class="mi">10000</span><span class="err">,</span>
    <span class="s2">"Lua.runtime.path"</span><span class="err">:</span> <span class="p">[</span>
        <span class="s2">"?.lua"</span><span class="p">,</span>
        <span class="s2">"?/init.lua"</span><span class="p">,</span>
        <span class="s2">"?/?.lua"</span><span class="p">,</span>
    <span class="p">]</span><span class="err">,</span>
</pre>

<h3><a href="https://github.com/Alloyed/lua-lsp">lua-lsp</a></h3>
<h2>Debug adapter</h2>
<h3><a href="https://github.com/tomblind/local-lua-debugger-vscode">local-lua-debugger-vscode</a></h3>
<ul>
<li>Debugされるスクリプト側に仕込み不要</li>
<li>⭐ luajit 対応</li>
<li>__tostring でエラーが発生すると固まるので、__tostring の実装で例外が起きないように注意</li>
<li>起動時の引数に <code>\\</code> が含まれているとエラーになる =&gt; <code>0.2.2</code> で修正</li>
</ul>
<h3><a href="https://github.com/actboy168/lua-debug">lua-debug</a></h3>
<ul>
<li>Debugされるスクリプト側に仕込み不要</li>
<li>hook が拡張してある。途中で止めたりとかできるぽい</li>
<li>残念ながら luajit では動作しない</li>
</ul>
<h2>Formatter</h2>
<h3><a href="https://github.com/johnnymorganz/stylua">stylua</a></h3>
<ul>
<li>⭐ rust 製でインストールしやすい</li>
</ul>
<p>stylua.toml</p>
<pre class="code literal-block"><span></span>column_width = 120
line_endings = "Unix"
indent_type = "Spaces"
indent_width = 4
quote_style = "AutoPreferDouble"
no_call_parentheses = true
</pre>

<h2>ソース読み</h2>
<p><a href="https://ousttrue.github.io/lua/">https://ousttrue.github.io/lua/</a></p>
</div>
    </main><footer id="footer"><p>
            Powered by
            <a href="https://getnikola.com" rel="nofollow">Nikola</a>
        </p>
    </footer>
</body>
</html>
