"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1622],{4754:function(e,n,t){t.r(n),t.d(n,{default:function(){return c}});var l=t(1151),a=t(7294);function o(e){const n=Object.assign({p:"p",pre:"pre",code:"code",h2:"h2"},(0,l.ah)(),e.components);return a.createElement(a.Fragment,null,a.createElement(n.p,null,"hererocks が VS2019BuildTools を検知して動作するように改造してみた。"),"\n",a.createElement(n.p,null,"https://github.com/luarocks/hererocks/pull/15"),"\n",a.createElement(n.p,null,"通るかどうかは微妙。\n内容的に、通りづらそう。\n古い vc を使っていたり MinGW 使っていたりすると実験できないしね。\nとりあえず、既存の動いている部分が壊れないようには配慮した。"),"\n",a.createElement(n.p,null,"採用されれば、"),"\n",a.createElement(n.p,null,"https://github.com/wbthomason/packer.nvim/issues/302"),"\n",a.createElement(n.p,null,"も進展する。\nWindows 版の luarocks 呼び出しに改造が必要なのだが、\n先に hererocks が動いている必要があるという順番。"),"\n",a.createElement(n.p,null,"とりあえず単体で試すことができて"),"\n",a.createElement(n.pre,null,a.createElement(n.code,null,"# C:/Python38/Scripts/pip.exe\n$ pip install https://github.com/ousttrue/hererocks/archive/add_vswhere.zip\n")),"\n",a.createElement(n.p,null,"とする。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,null,"# C:/Python38/Scripts/hererocks.exe\n$ hererocks.exe --target vs -j 2.1.0-beta3 -r latest build_dir\nUsing cl.exe found in PATH.\nFetching LuaJIT 2.1.0-beta3 (target: vs) (cached)\nVerifying SHA256 checksum\nBuilding LuaJIT 2.1.0-beta3 (target: vs)\nInstalling LuaJIT 2.1.0-beta3 (target: vs)\nFetching LuaRocks 3.7.0 (cached)\nVerifying SHA256 checksum\nBuilding and installing LuaRocks 3.7.0\n")),"\n",a.createElement(n.p,null,"lua はシステムにインストールして全体でライブラリを共有するというよりは、\nプロジェクト単位でインストールしてローカルに必要なライブラリだけを追加するという運用になりそう。\nなので、 hererocks でプロジェクトローカルに lua をサクッとビルドできるのはなかなかよい。\npython の venv 的な運用。\n展開先は、 ",a.createElement(n.code,null,".gitignore")," する。"),"\n",a.createElement(n.p,null,"ただ、外部ライブラリのラッパーがさくっと動くかというと Windows だと厳しいものがありますな・・・。\nvcpkg と連携させるとか、更なる頑張りが必要かもしれない。\nなので、 luajit の ffi が面白いかもしれない。\nstandalone の lua インタプリタを使う場合は ",a.createElement(n.code,null,"hererocks")," がいいのではないか。"),"\n",a.createElement(n.h2,null,"vswhere メモ"),"\n",a.createElement(n.p,null,"https://github.com/Microsoft/vswhere"),"\n",a.createElement(n.p,null,a.createElement(n.code,null,"cl.exe"),", ",a.createElement(n.code,null,"msbuild.exe")," などの探索に使う。\n",a.createElement(n.code,null,"vs2017 version 15.2")," 以降に入っているらしい。"),"\n",a.createElement(n.p,null,"こんな感じに使う。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,null,"# %ProgramFiles(x86)%\\Microsoft Visual Studio\\Installer\\vswhere.exe\n> vswhere -nologo -products *\ninstanceId: 6762dfe1\ninstallDate: 2020/07/21 9:26:34\ninstallationName: VisualStudio/16.7.3+30503.244\ninstallationPath: C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\ninstallationVersion: 16.7.30503.244\nproductId: Microsoft.VisualStudio.Product.BuildTools\nproductPath: C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\\Common7\\Tools\\LaunchDevCmd.bat\nstate: 4294967295\nisComplete: 1\nisLaunchable: 1\nisPrerelease: 0\nisRebootRequired: 0\ndisplayName: Visual Studio Build Tools 2019\ndescription: Visual Studio Build Tools では、Visual Studio IDE を必要とせずに、MSBuild ベースのネイティブ マネージド アプリケーションをビルドできます。また、Visual C++ のコンパイラやライブラリ、MFC、ATL、および C++/CLI サポートをインストールするオプションも用意されています。\nchannelId: VisualStudio.16.Release\nchannelUri: https://aka.ms/vs/16/release/channel\nenginePath: C:\\Program Files (x86)\\Microsoft Visual Studio\\Installer\\resources\\app\\ServiceHub\\Services\\Microsoft.VisualStudio.Setup.Service\nreleaseNotes: https://go.microsoft.com/fwlink/?LinkId=660893#16.7.3\nthirdPartyNotices: https://go.microsoft.com/fwlink/?LinkId=660909\nupdateDate: 2020-09-13T06:19:26.0508205Z\ncatalog_buildBranch: d16.7\ncatalog_buildVersion: 16.7.30503.244\ncatalog_id: VisualStudio/16.7.3+30503.244\ncatalog_localBuild: build-lab\ncatalog_manifestName: VisualStudio\ncatalog_manifestType: installer\ncatalog_productDisplayVersion: 16.7.3\ncatalog_productLine: Dev16\ncatalog_productLineVersion: 2019\ncatalog_productMilestone: RTW\ncatalog_productMilestoneIsPreRelease: False\ncatalog_productName: Visual Studio\ncatalog_productPatchVersion: 3\ncatalog_productPreReleaseMilestoneSuffix: 1.0\ncatalog_productSemanticVersion: 16.7.3+30503.244\ncatalog_requiredEngineVersion: 2.7.3132.26759\nproperties_campaignId:\nproperties_channelManifestId: VisualStudio.16.Release/16.7.3+30503.244\nproperties_nickname:\nproperties_setupEngineFilePath: C:\\Program Files (x86)\\Microsoft Visual Studio\\Installer\\vs_installershell.exe\n")),"\n",a.createElement(n.p,null,"https://github.com/microsoft/vswhere/wiki/Find-VC"),"\n",a.createElement(n.p,null,"フィルタをかけられる。"),"\n",a.createElement(n.pre,null,a.createElement(n.code,null,"> vswhere -latest -products * -requires Microsoft.VisualStudio.Component.VC.Tools.x86.x64 -property installationPath\nC:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\BuildTools\n")),"\n",a.createElement(n.p,null,"見つかったパスから先は固定であるとみなして、 ",a.createElement(n.code,null,"vcvars64.bat")," などを見つける。"))}var r=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,l.ah)(),e.components);return n?a.createElement(n,e,a.createElement(o,e)):o(e)};t(8678);function i(e){let{data:n,children:t}=e;return a.createElement(a.Fragment,null,a.createElement("h1",null,n.mdx.frontmatter.title),a.createElement(l.Zo,null,t))}function c(e){return a.createElement(i,e,a.createElement(r,e))}},8678:function(e,n,t){t(7294)},1151:function(e,n,t){t.d(n,{Zo:function(){return i},ah:function(){return o}});var l=t(7294);const a=l.createContext({});function o(e){const n=l.useContext(a);return l.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const r={};function i({components:e,children:n,disableParentContext:t}){let i;return i=t?"function"==typeof e?e({}):e||r:o(e),l.createElement(a.Provider,{value:i},n)}}}]);
//# sourceMappingURL=component---src-templates-post-template-js-content-file-path-home-runner-work-ousttrue-github-io-ousttrue-github-io-content-posts-2021-fix-hererocks-md-f45f050113ae70062e35.js.map