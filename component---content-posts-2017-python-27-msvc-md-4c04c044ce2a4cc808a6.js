"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6663],{3558:function(n,e,t){t.r(e);var i=t(1151),l=t(7294);function o(n){const e=Object.assign({p:"p",pre:"pre",code:"code"},(0,i.ah)(),n.components);return l.createElement(l.Fragment,null,l.createElement(e.p,null,"python2.7のnativeモジュールをビルドするのにMSVC9(VisualStudio2008)ではなく、\nMSVC15(VisualStudio2017)とかを使うには。"),"\n",l.createElement(e.p,null,"本当はPythone.exeをビルドしたコンパイラにバージョンを合わせた方がいいのかもしれないが、古いC++でコンパイルできるようにコードを修正するのが嫌なので。\n例。"),"\n",l.createElement(e.pre,null,l.createElement(e.code,{className:"language-python"},"# setup.py\nfrom distutils.core import setup, Extension\n\niex = Extension('iex', sources = ['PyIex/iexmodule.cpp'])\n\nsetup (name = 'pyalembic',\n       version = '1.0',\n       description = 'python binding of Alembic',\n       ext_modules = [iex])\n")),"\n",l.createElement(e.pre,null,l.createElement(e.code,null,"> python.exe setup.py build\nrunning build\nrunning build_ext\nbuilding 'iex' extension\nerror: Unable to find vcvarsall.bat\n")),"\n",l.createElement(e.p,null,"vs2008をインストールしていないのでエラーになる。\n調べたところdistutils/mvsc9compiler.pyのfind_vcvarsallを置き換えればよさそう。"),"\n",l.createElement(e.pre,null,l.createElement(e.code,{className:"language-python"},"# monkey patch for msvccompiler\nimport distutils.msvc9compiler\ndef find_vcvarsall(version):\n    return \"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Auxiliary/Build/vcvarsall.bat\"\ndistutils.msvc9compiler.find_vcvarsall=find_vcvarsall\n\n\nfrom distutils.core import setup, Extension\nimport os\n\niex = Extension('iex', \n                sources = ['PyIex/iexmodule.cpp'],\n                include_dirs = [\n                    os.environ['VCPKG_DIR']+'/installed/x64-windows/include',\n                    os.environ['VCPKG_DIR']+'/installed/x64-windows/include/openexr'\n                    ],\n                library_dirs=[\n                    os.environ['VCPKG_DIR']+'/installed/x64-windows/lib'\n                    ],\n                libraries=[\n                    'Iex-2_2',\n                    ]\n                )\n\nsetup (name = 'pyalembic',\n       version = '1.0',\n       description = 'python binding of Alembic',\n       ext_modules = [iex])\n")),"\n",l.createElement(e.p,null,"VS2017のコンパイラでビルドできた。"))}e.default=function(n){void 0===n&&(n={});const{wrapper:e}=Object.assign({},(0,i.ah)(),n.components);return e?l.createElement(e,n,l.createElement(o,n)):o(n)}},1151:function(n,e,t){t.d(e,{ah:function(){return o}});var i=t(7294);const l=i.createContext({});function o(n){const e=i.useContext(l);return i.useMemo((()=>"function"==typeof n?n(e):{...e,...n}),[e,n])}}}]);
//# sourceMappingURL=component---content-posts-2017-python-27-msvc-md-4c04c044ce2a4cc808a6.js.map