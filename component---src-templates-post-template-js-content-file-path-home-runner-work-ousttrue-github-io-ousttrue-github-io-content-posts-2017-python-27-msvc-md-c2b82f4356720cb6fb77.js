"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9033],{4783:function(e,n,t){t.r(n),t.d(n,{default:function(){return s}});var i=t(1151),l=t(7294);function r(e){const n=Object.assign({p:"p",pre:"pre",code:"code"},(0,i.ah)(),e.components);return l.createElement(l.Fragment,null,l.createElement(n.p,null,"python2.7のnativeモジュールをビルドするのにMSVC9(VisualStudio2008)ではなく、\nMSVC15(VisualStudio2017)とかを使うには。"),"\n",l.createElement(n.p,null,"本当はPythone.exeをビルドしたコンパイラにバージョンを合わせた方がいいのかもしれないが、古いC++でコンパイルできるようにコードを修正するのが嫌なので。\n例。"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-python"},"# setup.py\nfrom distutils.core import setup, Extension\n\niex = Extension('iex', sources = ['PyIex/iexmodule.cpp'])\n\nsetup (name = 'pyalembic',\n       version = '1.0',\n       description = 'python binding of Alembic',\n       ext_modules = [iex])\n")),"\n",l.createElement(n.pre,null,l.createElement(n.code,null,"> python.exe setup.py build\nrunning build\nrunning build_ext\nbuilding 'iex' extension\nerror: Unable to find vcvarsall.bat\n")),"\n",l.createElement(n.p,null,"vs2008をインストールしていないのでエラーになる。\n調べたところdistutils/mvsc9compiler.pyのfind_vcvarsallを置き換えればよさそう。"),"\n",l.createElement(n.pre,null,l.createElement(n.code,{className:"language-python"},"# monkey patch for msvccompiler\nimport distutils.msvc9compiler\ndef find_vcvarsall(version):\n    return \"C:/Program Files (x86)/Microsoft Visual Studio/2017/Community/VC/Auxiliary/Build/vcvarsall.bat\"\ndistutils.msvc9compiler.find_vcvarsall=find_vcvarsall\n\n\nfrom distutils.core import setup, Extension\nimport os\n\niex = Extension('iex', \n                sources = ['PyIex/iexmodule.cpp'],\n                include_dirs = [\n                    os.environ['VCPKG_DIR']+'/installed/x64-windows/include',\n                    os.environ['VCPKG_DIR']+'/installed/x64-windows/include/openexr'\n                    ],\n                library_dirs=[\n                    os.environ['VCPKG_DIR']+'/installed/x64-windows/lib'\n                    ],\n                libraries=[\n                    'Iex-2_2',\n                    ]\n                )\n\nsetup (name = 'pyalembic',\n       version = '1.0',\n       description = 'python binding of Alembic',\n       ext_modules = [iex])\n")),"\n",l.createElement(n.p,null,"VS2017のコンパイラでビルドできた。"))}var o=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?l.createElement(n,e,l.createElement(r,e)):r(e)};t(8678);function c(e){let{data:n,children:t}=e;return l.createElement(l.Fragment,null,l.createElement("h1",null,n.mdx.frontmatter.title),l.createElement(i.Zo,null,t))}function s(e){return l.createElement(c,e,l.createElement(o,e))}},8678:function(e,n,t){t(7294)},1151:function(e,n,t){t.d(n,{Zo:function(){return c},ah:function(){return r}});var i=t(7294);const l=i.createContext({});function r(e){const n=i.useContext(l);return i.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const o={};function c({components:e,children:n,disableParentContext:t}){let c;return c=t?"function"==typeof e?e({}):e||o:r(e),i.createElement(l.Provider,{value:c},n)}}}]);
//# sourceMappingURL=component---src-templates-post-template-js-content-file-path-home-runner-work-ousttrue-github-io-ousttrue-github-io-content-posts-2017-python-27-msvc-md-c2b82f4356720cb6fb77.js.map