"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4253],{3082:function(e,t,n){n.r(t);var l=n(1151),c=n(7294);function a(e){const t=Object.assign({h1:"h1",p:"p",code:"code",ul:"ul",li:"li",a:"a",blockquote:"blockquote",h2:"h2",h3:"h3",pre:"pre",h4:"h4",h5:"h5"},(0,l.ah)(),e.components);return c.createElement(c.Fragment,null,c.createElement(t.h1,null,"最近の python ライブラリのパッケージング手法を調査"),"\n",c.createElement(t.p,null,"最近の python package の記述の仕方で、 ",c.createElement(t.code,null,"pyproject.toml")," なる作法があるのでメモ。"),"\n",c.createElement(t.p,null,"元々、 ",c.createElement(t.code,null,"setup.py")," や ",c.createElement(t.code,null,"setup.cfg")," で記述していたのだけどこれに変わるものらしい。\n",c.createElement(t.code,null,"setup.py")," はともかく ",c.createElement(t.code,null,"setup.cfg")," が大変分かりにくいと思っていました。\nというか、何か調べにくい。\n",c.createElement(t.code,null,"setup.py")," を宣言的に書けるよ、詳しくは ",c.createElement(t.code,null,"setup.py")," のリファンンスを見て。みたいになっているのだけど、\n書き方がよくわからんことが多かった。"),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"(2016)",c.createElement(t.a,{href:"https://www.yunabe.jp/docs/python_package_management.html"},"Python パッケージ管理技術まとめ (pip, setuptools, easy_install, etc)")),"\n"),"\n",c.createElement(t.blockquote,null,"\n",c.createElement(t.p,null,"2013年に distribute は setuptools にマージされた"),"\n"),"\n",c.createElement(t.h2,null,"pyproject.toml"),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"(2019)",c.createElement(t.a,{href:"https://tech.515hikaru.net/post/2019-11-23-pyproject/"},"pyproject.toml とは何か")),"\n"),"\n",c.createElement(t.blockquote,null,"\n",c.createElement(t.p,null,"pyproject.toml は Node.js の package.json などのように、そのプロジェクトに関する様々なことを定義できるファイルとして存在しています"),"\n"),"\n",c.createElement(t.p,null,"なるほど。"),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"(2019)",c.createElement(t.a,{href:"https://orolog.hatenablog.jp/entry/2019/03/24/223531"},"pip が 19.02 で pyproject.toml から pip install できるようになった")),"\n"),"\n",c.createElement(t.h2,null,"pyproject の build-system"),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"(2019)https://engineer.recruit-lifestyle.co.jp/techblog/2019-12-25-python-packaging-specs/"),"\n"),"\n",c.createElement(t.h3,null,"setuptools"),"\n",c.createElement(t.pre,null,c.createElement(t.code,{className:"language-toml"},'[build-system]\nrequires = [\n    "setuptools>=42",\n    "wheel"\n]\nbuild-backend = "setuptools.build_meta"\n')),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"https://packaging.python.org/tutorials/packaging-projects/#creating-pyproject-toml"),"\n",c.createElement(t.li,null,"(2021)",c.createElement(t.a,{href:"https://zenn.dev/detsu/articles/5d74bf72e96a0f"},"PyPIパッケージのリリースもバージョニングもGitHub単独で完結させる")),"\n"),"\n",c.createElement(t.pre,null,c.createElement(t.code,{className:"language-toml"},'[build-system]\nrequires = ["setuptools>=45", "wheel", "setuptools_scm>=6.2"]\n')),"\n",c.createElement(t.p,null,"なるほど。\n",c.createElement(t.code,null,"setup.cfg")," と ",c.createElement(t.code,null,"pyproject.toml")," の役割が被っていると思うのだが両方要るのだろうか。"),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"(2021)",c.createElement(t.a,{href:"https://hirayarn.hatenablog.com/entry/2021/11/08/214053"},"PyPIにパッケージを公開する手順の整理")),"\n"),"\n",c.createElement(t.p,null,c.createElement(t.code,null,"pyproject.toml")," には ",c.createElement(t.code,null,"build-backend")," の指定だけを記述して、 ",c.createElement(t.code,null,"setup.cfg")," と併用するということでよさそう。"),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"(2018)",c.createElement(t.a,{href:"https://astropengu.in/posts/23/"},"Python の setup.py の内容を setup.cfg で管理する")),"\n"),"\n",c.createElement(t.h4,null,"setup.py & setup.cfg"),"\n",c.createElement(t.p,null,"setup.py"),"\n",c.createElement(t.pre,null,c.createElement(t.code,{className:"language-python"},"from setuptools import setup\nsetup()\n")),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"https://packaging.python.org/guides/distributing-packages-using-setuptools/"),"\n",c.createElement(t.li,null,"https://github.com/dephell/dephell/blob/master/setup.py"),"\n"),"\n",c.createElement(t.h4,null,"setup.cfg: metadata"),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"https://packaging.python.org/specifications/core-metadata/"),"\n"),"\n",c.createElement(t.h4,null,"setup.cfg: options"),"\n",c.createElement(t.h5,null,"setup.cfg: options.entry_points"),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"https://setuptools.pypa.io/en/latest/userguide/entry_point.html"),"\n"),"\n",c.createElement(t.h4,null,"setup.cfg:"),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,c.createElement(t.a,{href:"https://setuptools.pypa.io/en/latest/userguide/package_discovery.html"},"Package Discovery and Namespace Package")),"\n"),"\n",c.createElement(t.h3,null,"poetry"),"\n",c.createElement(t.pre,null,c.createElement(t.code,null,'[build-system]\nrequires = ["poetry>=0.12"]\nbuild-backend = "poetry.masonry.api"\n')),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"(2019)https://rcmdnk.com/blog/2019/02/04/computer-python/"),"\n",c.createElement(t.li,null,"(2018)",c.createElement(t.a,{href:"https://kk6.hateblo.jp/entry/2018/12/20/124151"},"Poetryを使ったPythonパッケージ開発からPyPI公開まで")),"\n"),"\n",c.createElement(t.h2,null,"練習"),"\n",c.createElement(t.p,null,"https://github.com/ousttrue/glglue に使ってみる。\n結局、 ",c.createElement(t.code,null,"setup.cfg")," を使っているのとあまり変わらず。\n",c.createElement(t.code,null,"setuptools_scm")," による git tag を ",c.createElement(t.code,null,"version")," 化する技を覚えた。\nあと、",c.createElement(t.code,null,"github actions"),"。\nそのうち、 ",c.createElement(t.code,null,"setup.cfg")," の内容を ",c.createElement(t.code,null,"pyproject.toml")," に書けるようになりそうではある。"))}t.default=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,l.ah)(),e.components);return t?c.createElement(t,e,c.createElement(a,e)):a(e)}},1151:function(e,t,n){n.d(t,{ah:function(){return a}});var l=n(7294);const c=l.createContext({});function a(e){const t=l.useContext(c);return l.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}}}]);
//# sourceMappingURL=component---content-posts-2021-fall-pyproject-md-9564e28d7e1b164a6cec.js.map