"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6816],{9725:function(n,a,e){e.r(a),e.d(a,{default:function(){return i}});var s=e(1151),t=e(7294);function o(n){const a=Object.assign({p:"p",span:"span",h2:"h2",h3:"h3",blockquote:"blockquote",ul:"ul",li:"li",h4:"h4"},(0,s.ah)(),n.components);return t.createElement(t.Fragment,null,t.createElement(a.p,null,t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">omnicompletion</code>'}})," とかいろいろあるけどどう違うねん。ということで調べる。\n",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">help ins-completion</code>'}}),"\n",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">help complete-functions</code>'}})),"\n",t.createElement(a.h2,null,"いろいろな補完"),"\n",t.createElement(a.h2,null,"補完関数を定義"),"\n",t.createElement(a.p,null,t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">&lt;C-X>&lt;C-U></code>'}})," を ",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">set completefunc</code>'}})," で、\n",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">&lt;C-X>&lt;C-O></code>'}})," を ",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">set omnifunc</code>'}})," でユーザー定義できる。"),"\n",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="vim"><pre class="language-vim"><code class="language-vim"><span class="token keyword">function</span><span class="token operator">!</span> s<span class="token punctuation">:</span><span class="token function">my_omni_complete</span><span class="token punctuation">(</span>findstart<span class="token punctuation">,</span> base<span class="token punctuation">)</span>\n    <span class="token keyword">if</span> a<span class="token punctuation">:</span>findstart\n        <span class="token comment">" 補完の開始列を返す</span>\n        <span class="token keyword">return</span> <span class="token function">col</span><span class="token punctuation">(</span><span class="token string">\'.\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">endif</span>\n\n    <span class="token comment">" 補完候補を返す</span>\n    <span class="token keyword">let</span> <span class="token keyword">l</span><span class="token punctuation">:</span>matches <span class="token operator">=</span>  <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">]</span>\n    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string">\'words\'</span><span class="token punctuation">:</span> matches<span class="token punctuation">,</span> <span class="token string">\'refresh\'</span><span class="token punctuation">:</span> <span class="token string">\'always\'</span><span class="token punctuation">}</span>\n\n<span class="token keyword">endfunction</span>\n\n<span class="token comment">"setlocal complefunc = </span>\n<span class="token keyword">setlocal</span> <span class="token builtin">omnifunc</span> <span class="token operator">=</span> s<span class="token punctuation">:</span>my_omni_complete\n<span class="token comment">" menuone</span>\n<span class="token keyword">setlocal</span> <span class="token builtin">completeopt</span> <span class="token operator">=</span> menu<span class="token punctuation">,</span>preview<span class="token punctuation">,</span>longest\n<span class="token comment">" default</span>\n<span class="token keyword">setlocal</span> <span class="token builtin">previewheight</span> <span class="token operator">=</span> <span class="token number">3</span>\n<span class="token comment">"setlocal pumheight</span>\n<span class="token keyword">setlocal</span> pumwidth <span class="token operator">=</span> <span class="token number">15</span></code></pre></div>'}}),"\n",t.createElement(a.p,null,"のように定義する。"),"\n",t.createElement(a.h3,null,"最初の実行時"),"\n",t.createElement(a.blockquote,null,"\n",t.createElement(a.p,null,"On the first invocation the arguments are:\na:findstart  1\na:base\tempty"),"\n"),"\n",t.createElement(a.h3,null,"候補の取得"),"\n",t.createElement(a.blockquote,null,"\n",t.createElement(a.p,null,"On the second invocation the arguments are:\na:findstart  0\na:base\tthe text with which matches should match; the text that was\nlocated in the first call (can be empty)"),"\n"),"\n",t.createElement(a.h3,null,"補完候補"),"\n",t.createElement(a.p,null,"単なる文字列か以下のdictionary"),"\n",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">{\n\tword\t\tthe text that will be inserted, mandatory\n\tabbr\t\tabbreviation of "word"; when not empty it is used in\n\t\t\tthe menu instead of "word"\n\tmenu\t\textra text for the popup menu, displayed after "word"\n\t\t\tor "abbr"\n\tinfo\t\tmore information about the item, can be displayed in a\n\t\t\tpreview window\n\tkind\t\tsingle letter indicating the type of completion\n\n        v\tvariable\n        f\tfunction or method\n        m\tmember of a struct or class\n        t\ttypedef\n        d\t#define or macro\n\n\ticase\t\twhen non-zero case is to be ignored when comparing\n\t\t\titems to be equal; when omitted zero is used, thus\n\t\t\titems that only differ in case are added\n\tdup\t\twhen non-zero this match will be added even when an\n\t\t\titem with the same word is already present.\n\tempty\t\twhen non-zero this match will be added even when it is\n\t\t\tan empty string\n\tuser_data \tcustom data which is associated with the item and\n\t\t\tavailable in |v:completed_item|\n}</code></pre></div>'}}),"\n",t.createElement(a.h3,null,"非同期で更新"),"\n",t.createElement(a.h3,null,"自動的にsuggest"),"\n",t.createElement(a.ul,null,"\n",t.createElement(a.li,null,"deoplete"),"\n"),"\n",t.createElement(a.h3,null,"呼び出し例"),"\n",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="vim"><pre class="language-vim"><code class="language-vim">inoremap <span class="token operator">&lt;</span>expr<span class="token operator">></span> <span class="token operator">.</span> <span class="token function">MayComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\nfunc <span class="token function">MayComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>can <span class="token builtin">complete</span><span class="token punctuation">)</span>\n        <span class="token keyword">return</span> <span class="token string">".\\&lt;C-X>\\&lt;C-O>"</span>\n    <span class="token keyword">endif</span>\n    <span class="token keyword">return</span> <span class="token string">\'.\'</span>\nendfunc</code></pre></div>'}}),"\n",t.createElement(a.h3,null,"実装例"),"\n",t.createElement(a.h4,null,"vim-lsp"),"\n",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="vim"><pre class="language-vim"><code class="language-vim"><span class="token keyword">function</span><span class="token operator">!</span> <span class="token builtin">lsp</span>#omni#<span class="token function">complete</span><span class="token punctuation">(</span>findstart<span class="token punctuation">,</span> base<span class="token punctuation">)</span> abort\n    <span class="token keyword">if</span> a<span class="token punctuation">:</span>findstart\n        <span class="token keyword">return</span> <span class="token function">col</span><span class="token punctuation">(</span><span class="token string">\'.\'</span><span class="token punctuation">)</span>\n    <span class="token keyword">else</span>\n        <span class="token comment">" language serverに補完候補ををリクエスト</span>\n        <span class="token keyword">call</span> s<span class="token punctuation">:</span><span class="token function">send_completion_request</span><span class="token punctuation">(</span><span class="token keyword">l</span><span class="token punctuation">:</span>info<span class="token punctuation">)</span>\n\n        <span class="token comment">" 空で抜ける</span>\n        <span class="token keyword">redraw</span>\n        <span class="token keyword">return</span> v<span class="token punctuation">:</span>none\n    <span class="token keyword">endif</span>\nendfunc</code></pre></div>'}}),"\n",t.createElement(a.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="vim"><pre class="language-vim"><code class="language-vim"><span class="token comment">" call s:send_completion_request(l:info) のコールバック</span>\n<span class="token keyword">call</span> <span class="token function">complete</span><span class="token punctuation">(</span><span class="token function">col</span><span class="token punctuation">(</span><span class="token string">\'.\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">l</span><span class="token punctuation">:</span>matches<span class="token punctuation">)</span></code></pre></div>'}}))}var l=function(n){void 0===n&&(n={});const{wrapper:a}=Object.assign({},(0,s.ah)(),n.components);return a?t.createElement(a,n,t.createElement(o,n)):o(n)},p=e(8678),c=e(8838);const r={code:n=>{let{children:a,className:e}=n;return e?t.createElement(c.Z,{className:e},a):t.createElement("code",null,a)}};function u(n){let{data:a,children:e}=n;return t.createElement(p.Z,null,t.createElement("h1",null,a.mdx.frontmatter.title),t.createElement(s.Zo,{components:r},e))}function i(n){return t.createElement(u,n,t.createElement(l,n))}}}]);
//# sourceMappingURL=component---src-templates-post-template-js-content-file-path-home-runner-work-ousttrue-github-io-ousttrue-github-io-content-posts-2019-vim-completion-md-68640d7563ec99c04cd3.js.map