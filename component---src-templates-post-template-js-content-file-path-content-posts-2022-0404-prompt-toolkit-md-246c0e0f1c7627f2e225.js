"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8664],{8471:function(e,t,l){l.r(t),l.d(t,{default:function(){return i}});var n=l(1151),c=l(7294);function r(e){const t=Object.assign({h1:"h1",h2:"h2",p:"p",code:"code",ul:"ul",li:"li"},(0,n.ah)(),e.components);return c.createElement(c.Fragment,null,c.createElement(t.h1,null,"prompt-toolkit の fullscreen アプリケーション"),"\n",c.createElement(t.h2,null,"Buffer"),"\n",c.createElement(t.p,null,"しばらく試行錯誤していたのだがやっと使い方が分かってきた。\n",c.createElement(t.code,null,"Window")," + ",c.createElement(t.code,null,"BufferControl")," が基本形で edit する場合向け。\n",c.createElement(t.code,null,"Window")," + ",c.createElement(t.code,null,"FormatedTextControl")," が readonly の装飾済みのテキストに向いていそう。"),"\n",c.createElement(t.p,null,"Lexer で基本的な装飾を施して、Preprocess でフォーカスやホバーのUI的な装飾をするという使い分けがよさそう。\n",c.createElement(t.code,null,"FormattedTextControl")," の場合は初期化時にスタイル適用済みのテキストを渡してしまう。"),"\n",c.createElement(t.h2,null,"example"),"\n",c.createElement(t.p,null,"https://github.com/prompt-toolkit の、"),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"https://github.com/prompt-toolkit/pyvim"),"\n",c.createElement(t.li,null,"https://github.com/prompt-toolkit/pymux"),"\n",c.createElement(t.li,null,"https://github.com/prompt-toolkit/pyterm"),"\n"),"\n",c.createElement(t.p,null,"が ",c.createElement(t.code,null,"prompt-toolkit2")," のままになっているのだが、\nちょっと手直しすることで、 ",c.createElement(t.code,null,"prompt-toolkit3")," で動作させることができた。"),"\n",c.createElement(t.p,null,c.createElement(t.code,null,"ptterm")," の ",c.createElement(t.code,null,"prompt-toolkit3")," 化に PR を送ってみた。\n主に ",c.createElement(t.code,null,"pipe")," 周りの非同期入力を ",c.createElement(t.code,null,"asyncio")," に適合させてやることで動く。\nhttps://github.com/prompt-toolkit/ptterm/pull/9"),"\n",c.createElement(t.p,null,c.createElement(t.code,null,"pymux")," も ",c.createElement(t.code,null,"fork")," しない ",c.createElement(t.code,null,"standalone")," 引き数付きならば ",c.createElement(t.code,null,"Windows")," + ",c.createElement(t.code,null,"prompt-toolkit3")," でも動かすことができた。"),"\n",c.createElement(t.p,null,"prompt-toolkit3 では積極的に ",c.createElement(t.code,null,"asyncio")," を活用していくのがよさそう。"),"\n",c.createElement(t.h2,null,"prompt-toolkit で任意のエスケープシーケンスを入れる"),"\n",c.createElement(t.p,null,"prompt-toolkit で ",c.createElement(t.code,null,"sixel")," 画像を表示させたい。\nUIControl が UIContent を生成していて、このとき styled text のデータ構造に対して特殊なスタイル ",c.createElement(t.code,null,"[ZeroWidthEscape]")," を指定することでエスケープシーケンスを直接出力できることがわかった。諸々の調整が必要になるが、ここに ",c.createElement(t.code,null,"sixel")," のシーケンスを入れることで表示できる。\n処理順の癖に対応するために、\n画像の高さ分の改行を ",c.createElement(t.code,null,"sixel")," のエスケープシーケンスに先行させる必要があった。\n",c.createElement(t.code,null,"prompt-toolkit")," + ",c.createElement(t.code,null,"wezterm")," 固有の問題かもしれない。"),"\n",c.createElement(t.h2,null,"Windows/Linux 共用で console アプリを動かす"),"\n",c.createElement(t.p,null,c.createElement(t.code,null,"prompt-toolkit3")," でかなりできそう。\nフレームワークの構成を理解するまでとっつきが悪いのだが、\n",c.createElement(t.code,null,"pypager"),", ",c.createElement(t.code,null,"pyvim"),", ",c.createElement(t.code,null,"ptterm"),", ",c.createElement(t.code,null,"pymux")," を研究してやっとわかってきた。"),"\n",c.createElement(t.p,null,c.createElement(t.code,null,"nerdfont")," で賑やかしを入れて、 ",c.createElement(t.code,null,"sixel")," で画像表示ができるおもちゃを企画している。"),"\n",c.createElement(t.ul,null,"\n",c.createElement(t.li,null,"vim ぽい lsp/dap の実験アプリ"),"\n",c.createElement(t.li,null,"w3m ぽい ブラウザ"),"\n",c.createElement(t.li,null,"tmux ぽいやつ"),"\n",c.createElement(t.li,null,"ranger ぽいやつ"),"\n"))}var o=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,n.ah)(),e.components);return t?c.createElement(t,e,c.createElement(r,e)):r(e)},m=l(8678),a=l(4160),u=l(8736);const p={code:e=>{let{children:t,className:l}=e;return l?c.createElement(u.Z,{className:l},t):c.createElement("code",null,t)}};function E(e){let{data:t,children:l}=e;const r=t.mdx.frontmatter;return c.createElement(m.Z,null,c.createElement("h1",null,r.title),c.createElement("div",{className:"tags-index"},r.tags&&r.tags.length>0&&r.tags.map((e=>c.createElement(a.rU,{to:"/tags/"+e+"/",itemProp:"url"},c.createElement("button",null,e))))),c.createElement(n.Zo,{components:p},l))}function i(e){return c.createElement(E,e,c.createElement(o,e))}}}]);
//# sourceMappingURL=component---src-templates-post-template-js-content-file-path-content-posts-2022-0404-prompt-toolkit-md-246c0e0f1c7627f2e225.js.map