"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6617],{6072:function(n,e,a){a.r(e),a.d(e,{default:function(){return i}});var t=a(1151),s=a(7294);function l(n){const e=Object.assign({p:"p",a:"a",span:"span",h1:"h1",h2:"h2",ul:"ul",li:"li"},(0,t.ah)(),n.components);return s.createElement(s.Fragment,null,s.createElement(e.p,null,s.createElement(e.a,{href:"https://github.com/sumneko/lua-language-server"},"lua-language-server")," が luajit ffi のインテリセンスを出せるように emmylua annotation を生成するより、\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">ffi.cdef</code>'}})," を読めるようにすればよいのでは。\nということで、lua-language-server を探ってみる。"),"\n",s.createElement(e.h1,null,"構成"),"\n",s.createElement(e.p,null,"https://github.com/sumneko/lua-language-server/wiki/Command-line"),"\n",s.createElement(e.p,null,s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">BINRARY/lua-language-server LUA_LANGUAGE_SERVER/main.lua --logpath=D:/log --metapath=D:/meta --locale=en-us --configpath="config.json"</code>'}})),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:"<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">> .\\bin\\Windows\\lua-language-server.exe --help\nlua-language-server.exe:unrecognized option '--help'usage: C:\\Users\\oustt\\ghq\\github.com\\sumneko\\lua-language-server\\bin\\Windows\\lua-language-server.exe [options] [script [args]]\nAvailable options are:\n  -e stat  execute string 'stat'\n  -i       enter interactive mode after executing 'script'\n  -l name  require library 'name' into global 'name'\n  -v       show version information\n  -E       ignore environment variables\n  -W       turn warnings on\n  --       stop handling options\n  -        stop handling options and execute stdin\n> .\\bin\\Windows\\lua-language-server.exe -v    \nLua 5.4.4  Copyright (C) 1994-2021 Lua.org, PUC-Rio  </code></pre></div>"}}),"\n",s.createElement(e.p,null,"native モジュールを埋め込んだインタープリター ",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">lua-language-server.exe</code>'}})," で ",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">main.lua</code>'}})," を実行する。"),"\n",s.createElement(e.h2,null,"setting"),"\n",s.createElement(e.p,null,s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">.vscode/settings.json</code>'}})),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json">     <span class="token property">"Lua.runtime.version"</span><span class="token operator">:</span> <span class="token string">"LuaJIT"</span><span class="token punctuation">,</span>\n     <span class="token property">"Lua.workspace.preloadFileSize"</span><span class="token operator">:</span> <span class="token number">10000</span></code></pre></div>'}}),"\n",s.createElement(e.h1,null,"LSP"),"\n",s.createElement(e.p,null,"https://microsoft.github.io/language-server-protocol/"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,s.createElement(e.a,{href:"https://microsoft.github.io/language-server-protocol/specifications/specification-current/#textDocument_signatureHelp"},"signatureHelp")),"\n"),"\n",s.createElement(e.h1,null,"main.lua"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"main.lua","\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"script/service/service.lua"),"\n"),"\n"),"\n"),"\n",s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<div class="gatsby-highlight" data-language="lua"><pre class="language-lua"><code class="language-lua"><span class="token keyword">function</span> m<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    util<span class="token punctuation">.</span><span class="token function">enableCloseFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    await<span class="token punctuation">.</span><span class="token function">setErrorHandle</span><span class="token punctuation">(</span>log<span class="token punctuation">.</span>error<span class="token punctuation">)</span>\n    pub<span class="token punctuation">.</span><span class="token function">recruitBraves</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>\n\n    <span class="token comment">-- transport</span>\n    proto<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    m<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    m<span class="token punctuation">.</span><span class="token function">pulse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    m<span class="token punctuation">.</span><span class="token function">reportStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    m<span class="token punctuation">.</span><span class="token function">testVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n    require <span class="token string">\'provider\'</span>\n\n    m<span class="token punctuation">.</span><span class="token function">startTimer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token keyword">end</span></code></pre></div>'}}),"\n",s.createElement(e.h1,null,"script/parser"),"\n",s.createElement(e.p,null,"lua のコード解析"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"script/parser/parse.lua"),"\n"),"\n",s.createElement(e.p,null,s.createElement(e.span,{dangerouslySetInnerHTML:{__html:'<code class="language-text">ast.init(state)</code>'}})),"\n",s.createElement(e.h2,null,"LPeg"),"\n",s.createElement(e.ul,null,"\n",s.createElement(e.li,null,"\n",s.createElement(e.p,null,"script/parser/grammar.lua"),"\n"),"\n",s.createElement(e.li,null,"\n",s.createElement(e.p,null,s.createElement(e.a,{href:"http://www.inf.puc-rio.br/~roberto/lpeg/"},"LPeg")),"\n"),"\n",s.createElement(e.li,null,"\n",s.createElement(e.p,null,s.createElement(e.a,{href:"https://gist.github.com/tacigar/93b30931c879cd8a9b12380724b956aa"},"Lua製PEG「LPeg」を触ってみた")),"\n"),"\n",s.createElement(e.li,null,"\n",s.createElement(e.p,null,s.createElement(e.a,{href:"https://nymphium.github.io/2015/07/23/lpeg2.html"},"LPegの使い方 patternその2")),"\n"),"\n",s.createElement(e.li,null,"\n",s.createElement(e.p,null,s.createElement(e.a,{href:"https://sceneryandfish.withnotes.net/blog/2014/07/22-lua-lpeg-how-to-use/"},"LPeg – Parsing Expression Grammars For Luaの使い方")),"\n"),"\n"))}var c=function(n){void 0===n&&(n={});const{wrapper:e}=Object.assign({},(0,t.ah)(),n.components);return e?s.createElement(e,n,s.createElement(l,n)):l(n)},o=a(8678),u=a(8838);const p={code:n=>{let{children:e,className:a}=n;return a?s.createElement(u.Z,{className:a},e):s.createElement("code",null,e)}};function r(n){let{data:e,children:a}=n;return s.createElement(o.Z,null,s.createElement("h1",null,e.mdx.frontmatter.title),s.createElement(t.Zo,{components:p},a))}function i(n){return s.createElement(r,n,s.createElement(c,n))}}}]);
//# sourceMappingURL=component---src-templates-post-template-js-content-file-path-home-runner-work-ousttrue-github-io-ousttrue-github-io-content-posts-2021-summer-lua-language-server-md-8ebd6450d58818c8af5d.js.map